"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/session/route";
exports.ids = ["app/api/session/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("net");

/***/ }),

/***/ "string_decoder":
/*!*********************************!*\
  !*** external "string_decoder" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("string_decoder");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsession%2Froute&page=%2Fapi%2Fsession%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsession%2Froute.ts&appDir=%2FUsers%2Fnegishi%2FDocuments%2Fdevelop%2FHackathon%2FTokyoOpenDataHackathon%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fnegishi%2FDocuments%2Fdevelop%2FHackathon%2FTokyoOpenDataHackathon&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsession%2Froute&page=%2Fapi%2Fsession%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsession%2Froute.ts&appDir=%2FUsers%2Fnegishi%2FDocuments%2Fdevelop%2FHackathon%2FTokyoOpenDataHackathon%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fnegishi%2FDocuments%2Fdevelop%2FHackathon%2FTokyoOpenDataHackathon&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_negishi_Documents_develop_Hackathon_TokyoOpenDataHackathon_src_app_api_session_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/session/route.ts */ \"(rsc)/./src/app/api/session/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/session/route\",\n        pathname: \"/api/session\",\n        filename: \"route\",\n        bundlePath: \"app/api/session/route\"\n    },\n    resolvedPagePath: \"/Users/negishi/Documents/develop/Hackathon/TokyoOpenDataHackathon/src/app/api/session/route.ts\",\n    nextConfigOutput,\n    userland: _Users_negishi_Documents_develop_Hackathon_TokyoOpenDataHackathon_src_app_api_session_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/session/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZzZXNzaW9uJTJGcm91dGUmcGFnZT0lMkZhcGklMkZzZXNzaW9uJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGc2Vzc2lvbiUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRm5lZ2lzaGklMkZEb2N1bWVudHMlMkZkZXZlbG9wJTJGSGFja2F0aG9uJTJGVG9reW9PcGVuRGF0YUhhY2thdGhvbiUyRnNyYyUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZuZWdpc2hpJTJGRG9jdW1lbnRzJTJGZGV2ZWxvcCUyRkhhY2thdGhvbiUyRlRva3lvT3BlbkRhdGFIYWNrYXRob24maXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQzhDO0FBQzNIO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdG9reW8tb3BlbmRhdGEtaGFja2F0aG9uLz84ZTdkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy9uZWdpc2hpL0RvY3VtZW50cy9kZXZlbG9wL0hhY2thdGhvbi9Ub2t5b09wZW5EYXRhSGFja2F0aG9uL3NyYy9hcHAvYXBpL3Nlc3Npb24vcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3Nlc3Npb24vcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9zZXNzaW9uXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9zZXNzaW9uL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL25lZ2lzaGkvRG9jdW1lbnRzL2RldmVsb3AvSGFja2F0aG9uL1Rva3lvT3BlbkRhdGFIYWNrYXRob24vc3JjL2FwcC9hcGkvc2Vzc2lvbi9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvc2Vzc2lvbi9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsession%2Froute&page=%2Fapi%2Fsession%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsession%2Froute.ts&appDir=%2FUsers%2Fnegishi%2FDocuments%2Fdevelop%2FHackathon%2FTokyoOpenDataHackathon%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fnegishi%2FDocuments%2Fdevelop%2FHackathon%2FTokyoOpenDataHackathon&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/session/route.ts":
/*!**************************************!*\
  !*** ./src/app/api/session/route.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DELETE: () => (/* binding */ DELETE),\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_services_SessionManager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/services/SessionManager */ \"(rsc)/./src/lib/services/SessionManager.ts\");\n/* harmony import */ var _lib_validation__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/validation */ \"(rsc)/./src/lib/validation.ts\");\n/* harmony import */ var _lib_errors__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/errors */ \"(rsc)/./src/lib/errors.ts\");\n/* harmony import */ var _lib_logger__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/logger */ \"(rsc)/./src/lib/logger.ts\");\n\n\n\n\n\n// Create new session\nasync function POST(request) {\n    const requestId = (0,_lib_logger__WEBPACK_IMPORTED_MODULE_4__.generateRequestId)();\n    const timer = _lib_logger__WEBPACK_IMPORTED_MODULE_4__.log.performance(\"Create Session API\", requestId);\n    try {\n        const sessionManager = _lib_services_SessionManager__WEBPACK_IMPORTED_MODULE_1__.SessionManager.getInstance();\n        const body = await request.json().catch(()=>({}));\n        // Get client metadata\n        const clientIP = request.headers.get(\"x-forwarded-for\") || request.headers.get(\"x-real-ip\") || \"unknown\";\n        const userAgent = request.headers.get(\"user-agent\") || \"unknown\";\n        // Determine device type from user agent\n        const deviceType = /Mobile|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(userAgent) ? \"mobile\" : /Tablet|iPad/i.test(userAgent) ? \"tablet\" : \"desktop\";\n        // Validate language\n        let language = \"ja\";\n        if (body.language) {\n            const langValidation = (0,_lib_validation__WEBPACK_IMPORTED_MODULE_2__.validateLanguage)(body.language);\n            if (langValidation.isValid) {\n                language = langValidation.sanitized;\n            } else {\n                _lib_logger__WEBPACK_IMPORTED_MODULE_4__.log.warn(\"Invalid language provided, using default\", {\n                    providedLanguage: body.language,\n                    errors: langValidation.errors\n                }, requestId);\n            }\n        }\n        const sessionId = await sessionManager.createSession(language, {\n            userAgent,\n            ipAddress: clientIP,\n            deviceType\n        });\n        _lib_logger__WEBPACK_IMPORTED_MODULE_4__.log.business(\"Session created\", {\n            sessionId: sessionId.substring(0, 8) + \"...\",\n            language,\n            deviceType,\n            clientIP\n        }, requestId);\n        const response = {\n            success: true,\n            data: {\n                sessionId,\n                language\n            }\n        };\n        const duration = timer.end();\n        _lib_logger__WEBPACK_IMPORTED_MODULE_4__.log.api(\"POST\", \"/api/session\", 201, duration, requestId);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(response, {\n            status: 201\n        });\n    } catch (error) {\n        const appError = error instanceof _lib_errors__WEBPACK_IMPORTED_MODULE_3__.AppError ? error : _lib_errors__WEBPACK_IMPORTED_MODULE_3__.ErrorFactory.internalError(error);\n        const response = (0,_lib_errors__WEBPACK_IMPORTED_MODULE_3__.handleApiError)(appError, \"ja\");\n        const duration = timer.end({\n            error: true\n        });\n        _lib_logger__WEBPACK_IMPORTED_MODULE_4__.log.error(\"Session creation failed\", error, {\n            code: appError.code,\n            statusCode: appError.statusCode\n        }, requestId);\n        _lib_logger__WEBPACK_IMPORTED_MODULE_4__.log.api(\"POST\", \"/api/session\", appError.statusCode, duration, requestId);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(response, {\n            status: appError.statusCode\n        });\n    }\n}\n// Get session information\nasync function GET(request) {\n    const requestId = (0,_lib_logger__WEBPACK_IMPORTED_MODULE_4__.generateRequestId)();\n    const timer = _lib_logger__WEBPACK_IMPORTED_MODULE_4__.log.performance(\"Get Session API\", requestId);\n    try {\n        const sessionManager = _lib_services_SessionManager__WEBPACK_IMPORTED_MODULE_1__.SessionManager.getInstance();\n        const url = new URL(request.url);\n        const sessionId = url.searchParams.get(\"sessionId\");\n        if (!sessionId) {\n            const error = _lib_errors__WEBPACK_IMPORTED_MODULE_3__.ErrorFactory.validationFailed(\"Session ID is required\");\n            const response = (0,_lib_errors__WEBPACK_IMPORTED_MODULE_3__.handleApiError)(error, \"ja\");\n            const duration = timer.end();\n            _lib_logger__WEBPACK_IMPORTED_MODULE_4__.log.api(\"GET\", \"/api/session\", error.statusCode, duration, requestId);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(response, {\n                status: error.statusCode\n            });\n        }\n        const session = await sessionManager.getSession(sessionId);\n        if (!session) {\n            const error = _lib_errors__WEBPACK_IMPORTED_MODULE_3__.ErrorFactory.sessionNotFound();\n            const response = (0,_lib_errors__WEBPACK_IMPORTED_MODULE_3__.handleApiError)(error, \"ja\");\n            _lib_logger__WEBPACK_IMPORTED_MODULE_4__.log.warn(\"Session not found in GET request\", {\n                sessionId: sessionId.substring(0, 8) + \"...\"\n            }, requestId);\n            const duration = timer.end();\n            _lib_logger__WEBPACK_IMPORTED_MODULE_4__.log.api(\"GET\", \"/api/session\", error.statusCode, duration, requestId);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(response, {\n                status: error.statusCode\n            });\n        }\n        const response = {\n            success: true,\n            data: session\n        };\n        const duration = timer.end();\n        _lib_logger__WEBPACK_IMPORTED_MODULE_4__.log.api(\"GET\", \"/api/session\", 200, duration, requestId);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(response, {\n            status: 200\n        });\n    } catch (error) {\n        const appError = error instanceof _lib_errors__WEBPACK_IMPORTED_MODULE_3__.AppError ? error : _lib_errors__WEBPACK_IMPORTED_MODULE_3__.ErrorFactory.internalError(error);\n        const response = (0,_lib_errors__WEBPACK_IMPORTED_MODULE_3__.handleApiError)(appError, \"ja\");\n        const duration = timer.end({\n            error: true\n        });\n        _lib_logger__WEBPACK_IMPORTED_MODULE_4__.log.error(\"Session retrieval failed\", error, {\n            code: appError.code,\n            statusCode: appError.statusCode\n        }, requestId);\n        _lib_logger__WEBPACK_IMPORTED_MODULE_4__.log.api(\"GET\", \"/api/session\", appError.statusCode, duration, requestId);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(response, {\n            status: appError.statusCode\n        });\n    }\n}\n// Delete session\nasync function DELETE(request) {\n    const requestId = (0,_lib_logger__WEBPACK_IMPORTED_MODULE_4__.generateRequestId)();\n    const timer = _lib_logger__WEBPACK_IMPORTED_MODULE_4__.log.performance(\"Delete Session API\", requestId);\n    try {\n        const sessionManager = _lib_services_SessionManager__WEBPACK_IMPORTED_MODULE_1__.SessionManager.getInstance();\n        const url = new URL(request.url);\n        const sessionId = url.searchParams.get(\"sessionId\");\n        if (!sessionId) {\n            const error = _lib_errors__WEBPACK_IMPORTED_MODULE_3__.ErrorFactory.validationFailed(\"Session ID is required\");\n            const response = (0,_lib_errors__WEBPACK_IMPORTED_MODULE_3__.handleApiError)(error, \"ja\");\n            const duration = timer.end();\n            _lib_logger__WEBPACK_IMPORTED_MODULE_4__.log.api(\"DELETE\", \"/api/session\", error.statusCode, duration, requestId);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(response, {\n                status: error.statusCode\n            });\n        }\n        const deleted = await sessionManager.deleteSession(sessionId);\n        if (!deleted) {\n            const error = _lib_errors__WEBPACK_IMPORTED_MODULE_3__.ErrorFactory.sessionNotFound();\n            const response = (0,_lib_errors__WEBPACK_IMPORTED_MODULE_3__.handleApiError)(error, \"ja\");\n            _lib_logger__WEBPACK_IMPORTED_MODULE_4__.log.warn(\"Session not found for deletion\", {\n                sessionId: sessionId.substring(0, 8) + \"...\"\n            }, requestId);\n            const duration = timer.end();\n            _lib_logger__WEBPACK_IMPORTED_MODULE_4__.log.api(\"DELETE\", \"/api/session\", error.statusCode, duration, requestId);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(response, {\n                status: error.statusCode\n            });\n        }\n        _lib_logger__WEBPACK_IMPORTED_MODULE_4__.log.business(\"Session deleted\", {\n            sessionId: sessionId.substring(0, 8) + \"...\"\n        }, requestId);\n        const response = {\n            success: true,\n            data: {\n                deleted: true\n            }\n        };\n        const duration = timer.end();\n        _lib_logger__WEBPACK_IMPORTED_MODULE_4__.log.api(\"DELETE\", \"/api/session\", 200, duration, requestId);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(response, {\n            status: 200\n        });\n    } catch (error) {\n        const appError = error instanceof _lib_errors__WEBPACK_IMPORTED_MODULE_3__.AppError ? error : _lib_errors__WEBPACK_IMPORTED_MODULE_3__.ErrorFactory.internalError(error);\n        const response = (0,_lib_errors__WEBPACK_IMPORTED_MODULE_3__.handleApiError)(appError, \"ja\");\n        const duration = timer.end({\n            error: true\n        });\n        _lib_logger__WEBPACK_IMPORTED_MODULE_4__.log.error(\"Session deletion failed\", error, {\n            code: appError.code,\n            statusCode: appError.statusCode\n        }, requestId);\n        _lib_logger__WEBPACK_IMPORTED_MODULE_4__.log.api(\"DELETE\", \"/api/session\", appError.statusCode, duration, requestId);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(response, {\n            status: appError.statusCode\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UUFBUTtRQUFJO0lBRW5ELEVBQUUsT0FBT0MsT0FBTztRQUNkLE1BQU1DLFdBQVdELGlCQUFpQnRDLGlEQUFRQSxHQUFHc0MsUUFBUXhDLHFEQUFZQSxDQUFDMEMsYUFBYSxDQUFDRjtRQUNoRixNQUFNUCxXQUFXaEMsMkRBQWNBLENBQUN3QyxVQUFVO1FBRTFDLE1BQU1MLFdBQVc1QixNQUFNNkIsR0FBRyxDQUFDO1lBQUVHLE9BQU87UUFBSztRQUV6Q3JDLDRDQUFHQSxDQUFDcUMsS0FBSyxDQUFDLDJCQUEyQkEsT0FBZ0I7WUFDbkRHLE1BQU1GLFNBQVNFLElBQUk7WUFDbkJDLFlBQVlILFNBQVNHLFVBQVU7UUFDakMsR0FBR3JDO1FBRUhKLDRDQUFHQSxDQUFDbUMsR0FBRyxDQUFDLFVBQVUsZ0JBQWdCRyxTQUFTRyxVQUFVLEVBQUVSLFVBQVU3QjtRQUVqRSxPQUFPVixxREFBWUEsQ0FBQ2dCLElBQUksQ0FBQ29CLFVBQVU7WUFBRU0sUUFBUUUsU0FBU0csVUFBVTtRQUFDO0lBQ25FO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90b2t5by1vcGVuZGF0YS1oYWNrYXRob24vLi9zcmMvYXBwL2FwaS9zZXNzaW9uL3JvdXRlLnRzPzhjZjAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcbmltcG9ydCB7IFNlc3Npb25NYW5hZ2VyIH0gZnJvbSAnQC9saWIvc2VydmljZXMvU2Vzc2lvbk1hbmFnZXInO1xuaW1wb3J0IHsgdmFsaWRhdGVMYW5ndWFnZSB9IGZyb20gJ0AvbGliL3ZhbGlkYXRpb24nO1xuaW1wb3J0IHsgRXJyb3JGYWN0b3J5LCBoYW5kbGVBcGlFcnJvciwgQXBwRXJyb3IgfSBmcm9tICdAL2xpYi9lcnJvcnMnO1xuaW1wb3J0IHsgbG9nLCBnZW5lcmF0ZVJlcXVlc3RJZCB9IGZyb20gJ0AvbGliL2xvZ2dlcic7XG5pbXBvcnQgeyBBcGlSZXNwb25zZSwgU3VwcG9ydGVkTGFuZ3VhZ2UgfSBmcm9tICdAL3R5cGVzJztcblxuLy8gQ3JlYXRlIG5ldyBzZXNzaW9uXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICBjb25zdCByZXF1ZXN0SWQgPSBnZW5lcmF0ZVJlcXVlc3RJZCgpO1xuICBjb25zdCB0aW1lciA9IGxvZy5wZXJmb3JtYW5jZSgnQ3JlYXRlIFNlc3Npb24gQVBJJywgcmVxdWVzdElkKTtcblxuICB0cnkge1xuICAgIGNvbnN0IHNlc3Npb25NYW5hZ2VyID0gU2Vzc2lvbk1hbmFnZXIuZ2V0SW5zdGFuY2UoKTtcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKCkuY2F0Y2goKCkgPT4gKHt9KSk7XG5cbiAgICAvLyBHZXQgY2xpZW50IG1ldGFkYXRhXG4gICAgY29uc3QgY2xpZW50SVAgPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KCd4LWZvcndhcmRlZC1mb3InKSB8fCBcbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdC5oZWFkZXJzLmdldCgneC1yZWFsLWlwJykgfHwgXG4gICAgICAgICAgICAgICAgICAgICd1bmtub3duJztcbiAgICBjb25zdCB1c2VyQWdlbnQgPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KCd1c2VyLWFnZW50JykgfHwgJ3Vua25vd24nO1xuICAgIFxuICAgIC8vIERldGVybWluZSBkZXZpY2UgdHlwZSBmcm9tIHVzZXIgYWdlbnRcbiAgICBjb25zdCBkZXZpY2VUeXBlID0gL01vYmlsZXxBbmRyb2lkfGlQaG9uZXxpUGFkfGlQb2R8QmxhY2tCZXJyeXxJRU1vYmlsZXxPcGVyYSBNaW5pL2kudGVzdCh1c2VyQWdlbnQpIFxuICAgICAgPyAnbW9iaWxlJyBhcyBjb25zdCBcbiAgICAgIDogL1RhYmxldHxpUGFkL2kudGVzdCh1c2VyQWdlbnQpIFxuICAgICAgICA/ICd0YWJsZXQnIGFzIGNvbnN0IFxuICAgICAgICA6ICdkZXNrdG9wJyBhcyBjb25zdDtcblxuICAgIC8vIFZhbGlkYXRlIGxhbmd1YWdlXG4gICAgbGV0IGxhbmd1YWdlOiBTdXBwb3J0ZWRMYW5ndWFnZSA9ICdqYSc7XG4gICAgaWYgKGJvZHkubGFuZ3VhZ2UpIHtcbiAgICAgIGNvbnN0IGxhbmdWYWxpZGF0aW9uID0gdmFsaWRhdGVMYW5ndWFnZShib2R5Lmxhbmd1YWdlKTtcbiAgICAgIGlmIChsYW5nVmFsaWRhdGlvbi5pc1ZhbGlkKSB7XG4gICAgICAgIGxhbmd1YWdlID0gbGFuZ1ZhbGlkYXRpb24uc2FuaXRpemVkIGFzIFN1cHBvcnRlZExhbmd1YWdlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbG9nLndhcm4oJ0ludmFsaWQgbGFuZ3VhZ2UgcHJvdmlkZWQsIHVzaW5nIGRlZmF1bHQnLCB7XG4gICAgICAgICAgcHJvdmlkZWRMYW5ndWFnZTogYm9keS5sYW5ndWFnZSxcbiAgICAgICAgICBlcnJvcnM6IGxhbmdWYWxpZGF0aW9uLmVycm9ycyxcbiAgICAgICAgfSwgcmVxdWVzdElkKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBzZXNzaW9uSWQgPSBhd2FpdCBzZXNzaW9uTWFuYWdlci5jcmVhdGVTZXNzaW9uKGxhbmd1YWdlLCB7XG4gICAgICB1c2VyQWdlbnQsXG4gICAgICBpcEFkZHJlc3M6IGNsaWVudElQLFxuICAgICAgZGV2aWNlVHlwZSxcbiAgICB9KTtcblxuICAgIGxvZy5idXNpbmVzcygnU2Vzc2lvbiBjcmVhdGVkJywge1xuICAgICAgc2Vzc2lvbklkOiBzZXNzaW9uSWQuc3Vic3RyaW5nKDAsIDgpICsgJy4uLicsXG4gICAgICBsYW5ndWFnZSxcbiAgICAgIGRldmljZVR5cGUsXG4gICAgICBjbGllbnRJUCxcbiAgICB9LCByZXF1ZXN0SWQpO1xuXG4gICAgY29uc3QgcmVzcG9uc2U6IEFwaVJlc3BvbnNlPHsgc2Vzc2lvbklkOiBzdHJpbmc7IGxhbmd1YWdlOiBTdXBwb3J0ZWRMYW5ndWFnZSB9PiA9IHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIHNlc3Npb25JZCxcbiAgICAgICAgbGFuZ3VhZ2UsXG4gICAgICB9LFxuICAgIH07XG5cbiAgICBjb25zdCBkdXJhdGlvbiA9IHRpbWVyLmVuZCgpO1xuICAgIGxvZy5hcGkoJ1BPU1QnLCAnL2FwaS9zZXNzaW9uJywgMjAxLCBkdXJhdGlvbiwgcmVxdWVzdElkKTtcblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihyZXNwb25zZSwgeyBzdGF0dXM6IDIwMSB9KTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnN0IGFwcEVycm9yID0gZXJyb3IgaW5zdGFuY2VvZiBBcHBFcnJvciA/IGVycm9yIDogRXJyb3JGYWN0b3J5LmludGVybmFsRXJyb3IoZXJyb3IpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gaGFuZGxlQXBpRXJyb3IoYXBwRXJyb3IsICdqYScpO1xuICAgIFxuICAgIGNvbnN0IGR1cmF0aW9uID0gdGltZXIuZW5kKHsgZXJyb3I6IHRydWUgfSk7XG4gICAgXG4gICAgbG9nLmVycm9yKCdTZXNzaW9uIGNyZWF0aW9uIGZhaWxlZCcsIGVycm9yIGFzIEVycm9yLCB7XG4gICAgICBjb2RlOiBhcHBFcnJvci5jb2RlLFxuICAgICAgc3RhdHVzQ29kZTogYXBwRXJyb3Iuc3RhdHVzQ29kZSxcbiAgICB9LCByZXF1ZXN0SWQpO1xuICAgIFxuICAgIGxvZy5hcGkoJ1BPU1QnLCAnL2FwaS9zZXNzaW9uJywgYXBwRXJyb3Iuc3RhdHVzQ29kZSwgZHVyYXRpb24sIHJlcXVlc3RJZCk7XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24ocmVzcG9uc2UsIHsgc3RhdHVzOiBhcHBFcnJvci5zdGF0dXNDb2RlIH0pO1xuICB9XG59XG5cbi8vIEdldCBzZXNzaW9uIGluZm9ybWF0aW9uXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIGNvbnN0IHJlcXVlc3RJZCA9IGdlbmVyYXRlUmVxdWVzdElkKCk7XG4gIGNvbnN0IHRpbWVyID0gbG9nLnBlcmZvcm1hbmNlKCdHZXQgU2Vzc2lvbiBBUEknLCByZXF1ZXN0SWQpO1xuXG4gIHRyeSB7XG4gICAgY29uc3Qgc2Vzc2lvbk1hbmFnZXIgPSBTZXNzaW9uTWFuYWdlci5nZXRJbnN0YW5jZSgpO1xuICAgIGNvbnN0IHVybCA9IG5ldyBVUkwocmVxdWVzdC51cmwpO1xuICAgIGNvbnN0IHNlc3Npb25JZCA9IHVybC5zZWFyY2hQYXJhbXMuZ2V0KCdzZXNzaW9uSWQnKTtcblxuICAgIGlmICghc2Vzc2lvbklkKSB7XG4gICAgICBjb25zdCBlcnJvciA9IEVycm9yRmFjdG9yeS52YWxpZGF0aW9uRmFpbGVkKCdTZXNzaW9uIElEIGlzIHJlcXVpcmVkJyk7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGhhbmRsZUFwaUVycm9yKGVycm9yLCAnamEnKTtcbiAgICAgIFxuICAgICAgY29uc3QgZHVyYXRpb24gPSB0aW1lci5lbmQoKTtcbiAgICAgIGxvZy5hcGkoJ0dFVCcsICcvYXBpL3Nlc3Npb24nLCBlcnJvci5zdGF0dXNDb2RlLCBkdXJhdGlvbiwgcmVxdWVzdElkKTtcbiAgICAgIFxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHJlc3BvbnNlLCB7IHN0YXR1czogZXJyb3Iuc3RhdHVzQ29kZSB9KTtcbiAgICB9XG5cbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgc2Vzc2lvbk1hbmFnZXIuZ2V0U2Vzc2lvbihzZXNzaW9uSWQpO1xuICAgIGlmICghc2Vzc2lvbikge1xuICAgICAgY29uc3QgZXJyb3IgPSBFcnJvckZhY3Rvcnkuc2Vzc2lvbk5vdEZvdW5kKCk7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGhhbmRsZUFwaUVycm9yKGVycm9yLCAnamEnKTtcbiAgICAgIFxuICAgICAgbG9nLndhcm4oJ1Nlc3Npb24gbm90IGZvdW5kIGluIEdFVCByZXF1ZXN0JywgeyBcbiAgICAgICAgc2Vzc2lvbklkOiBzZXNzaW9uSWQuc3Vic3RyaW5nKDAsIDgpICsgJy4uLicgXG4gICAgICB9LCByZXF1ZXN0SWQpO1xuICAgICAgXG4gICAgICBjb25zdCBkdXJhdGlvbiA9IHRpbWVyLmVuZCgpO1xuICAgICAgbG9nLmFwaSgnR0VUJywgJy9hcGkvc2Vzc2lvbicsIGVycm9yLnN0YXR1c0NvZGUsIGR1cmF0aW9uLCByZXF1ZXN0SWQpO1xuICAgICAgXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24ocmVzcG9uc2UsIHsgc3RhdHVzOiBlcnJvci5zdGF0dXNDb2RlIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IHJlc3BvbnNlOiBBcGlSZXNwb25zZTx0eXBlb2Ygc2Vzc2lvbj4gPSB7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgZGF0YTogc2Vzc2lvbixcbiAgICB9O1xuXG4gICAgY29uc3QgZHVyYXRpb24gPSB0aW1lci5lbmQoKTtcbiAgICBsb2cuYXBpKCdHRVQnLCAnL2FwaS9zZXNzaW9uJywgMjAwLCBkdXJhdGlvbiwgcmVxdWVzdElkKTtcblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihyZXNwb25zZSwgeyBzdGF0dXM6IDIwMCB9KTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnN0IGFwcEVycm9yID0gZXJyb3IgaW5zdGFuY2VvZiBBcHBFcnJvciA/IGVycm9yIDogRXJyb3JGYWN0b3J5LmludGVybmFsRXJyb3IoZXJyb3IpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gaGFuZGxlQXBpRXJyb3IoYXBwRXJyb3IsICdqYScpO1xuICAgIFxuICAgIGNvbnN0IGR1cmF0aW9uID0gdGltZXIuZW5kKHsgZXJyb3I6IHRydWUgfSk7XG4gICAgXG4gICAgbG9nLmVycm9yKCdTZXNzaW9uIHJldHJpZXZhbCBmYWlsZWQnLCBlcnJvciBhcyBFcnJvciwge1xuICAgICAgY29kZTogYXBwRXJyb3IuY29kZSxcbiAgICAgIHN0YXR1c0NvZGU6IGFwcEVycm9yLnN0YXR1c0NvZGUsXG4gICAgfSwgcmVxdWVzdElkKTtcbiAgICBcbiAgICBsb2cuYXBpKCdHRVQnLCAnL2FwaS9zZXNzaW9uJywgYXBwRXJyb3Iuc3RhdHVzQ29kZSwgZHVyYXRpb24sIHJlcXVlc3RJZCk7XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24ocmVzcG9uc2UsIHsgc3RhdHVzOiBhcHBFcnJvci5zdGF0dXNDb2RlIH0pO1xuICB9XG59XG5cbi8vIERlbGV0ZSBzZXNzaW9uXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gREVMRVRFKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIGNvbnN0IHJlcXVlc3RJZCA9IGdlbmVyYXRlUmVxdWVzdElkKCk7XG4gIGNvbnN0IHRpbWVyID0gbG9nLnBlcmZvcm1hbmNlKCdEZWxldGUgU2Vzc2lvbiBBUEknLCByZXF1ZXN0SWQpO1xuXG4gIHRyeSB7XG4gICAgY29uc3Qgc2Vzc2lvbk1hbmFnZXIgPSBTZXNzaW9uTWFuYWdlci5nZXRJbnN0YW5jZSgpO1xuICAgIGNvbnN0IHVybCA9IG5ldyBVUkwocmVxdWVzdC51cmwpO1xuICAgIGNvbnN0IHNlc3Npb25JZCA9IHVybC5zZWFyY2hQYXJhbXMuZ2V0KCdzZXNzaW9uSWQnKTtcblxuICAgIGlmICghc2Vzc2lvbklkKSB7XG4gICAgICBjb25zdCBlcnJvciA9IEVycm9yRmFjdG9yeS52YWxpZGF0aW9uRmFpbGVkKCdTZXNzaW9uIElEIGlzIHJlcXVpcmVkJyk7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGhhbmRsZUFwaUVycm9yKGVycm9yLCAnamEnKTtcbiAgICAgIFxuICAgICAgY29uc3QgZHVyYXRpb24gPSB0aW1lci5lbmQoKTtcbiAgICAgIGxvZy5hcGkoJ0RFTEVURScsICcvYXBpL3Nlc3Npb24nLCBlcnJvci5zdGF0dXNDb2RlLCBkdXJhdGlvbiwgcmVxdWVzdElkKTtcbiAgICAgIFxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHJlc3BvbnNlLCB7IHN0YXR1czogZXJyb3Iuc3RhdHVzQ29kZSB9KTtcbiAgICB9XG5cbiAgICBjb25zdCBkZWxldGVkID0gYXdhaXQgc2Vzc2lvbk1hbmFnZXIuZGVsZXRlU2Vzc2lvbihzZXNzaW9uSWQpO1xuICAgIGlmICghZGVsZXRlZCkge1xuICAgICAgY29uc3QgZXJyb3IgPSBFcnJvckZhY3Rvcnkuc2Vzc2lvbk5vdEZvdW5kKCk7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGhhbmRsZUFwaUVycm9yKGVycm9yLCAnamEnKTtcbiAgICAgIFxuICAgICAgbG9nLndhcm4oJ1Nlc3Npb24gbm90IGZvdW5kIGZvciBkZWxldGlvbicsIHsgXG4gICAgICAgIHNlc3Npb25JZDogc2Vzc2lvbklkLnN1YnN0cmluZygwLCA4KSArICcuLi4nIFxuICAgICAgfSwgcmVxdWVzdElkKTtcbiAgICAgIFxuICAgICAgY29uc3QgZHVyYXRpb24gPSB0aW1lci5lbmQoKTtcbiAgICAgIGxvZy5hcGkoJ0RFTEVURScsICcvYXBpL3Nlc3Npb24nLCBlcnJvci5zdGF0dXNDb2RlLCBkdXJhdGlvbiwgcmVxdWVzdElkKTtcbiAgICAgIFxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHJlc3BvbnNlLCB7IHN0YXR1czogZXJyb3Iuc3RhdHVzQ29kZSB9KTtcbiAgICB9XG5cbiAgICBsb2cuYnVzaW5lc3MoJ1Nlc3Npb24gZGVsZXRlZCcsIHtcbiAgICAgIHNlc3Npb25JZDogc2Vzc2lvbklkLnN1YnN0cmluZygwLCA4KSArICcuLi4nLFxuICAgIH0sIHJlcXVlc3RJZCk7XG5cbiAgICBjb25zdCByZXNwb25zZTogQXBpUmVzcG9uc2U8eyBkZWxldGVkOiBib29sZWFuIH0+ID0ge1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIGRhdGE6IHsgZGVsZXRlZDogdHJ1ZSB9LFxuICAgIH07XG5cbiAgICBjb25zdCBkdXJhdGlvbiA9IHRpbWVyLmVuZCgpO1xuICAgIGxvZy5hcGkoJ0RFTEVURScsICcvYXBpL3Nlc3Npb24nLCAyMDAsIGR1cmF0aW9uLCByZXF1ZXN0SWQpO1xuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHJlc3BvbnNlLCB7IHN0YXR1czogMjAwIH0pO1xuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc3QgYXBwRXJyb3IgPSBlcnJvciBpbnN0YW5jZW9mIEFwcEVycm9yID8gZXJyb3IgOiBFcnJvckZhY3RvcnkuaW50ZXJuYWxFcnJvcihlcnJvcik7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBoYW5kbGVBcGlFcnJvcihhcHBFcnJvciwgJ2phJyk7XG4gICAgXG4gICAgY29uc3QgZHVyYXRpb24gPSB0aW1lci5lbmQoeyBlcnJvcjogdHJ1ZSB9KTtcbiAgICBcbiAgICBsb2cuZXJyb3IoJ1Nlc3Npb24gZGVsZXRpb24gZmFpbGVkJywgZXJyb3IgYXMgRXJyb3IsIHtcbiAgICAgIGNvZGU6IGFwcEVycm9yLmNvZGUsXG4gICAgICBzdGF0dXNDb2RlOiBhcHBFcnJvci5zdGF0dXNDb2RlLFxuICAgIH0sIHJlcXVlc3RJZCk7XG4gICAgXG4gICAgbG9nLmFwaSgnREVMRVRFJywgJy9hcGkvc2Vzc2lvbicsIGFwcEVycm9yLnN0YXR1c0NvZGUsIGR1cmF0aW9uLCByZXF1ZXN0SWQpO1xuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHJlc3BvbnNlLCB7IHN0YXR1czogYXBwRXJyb3Iuc3RhdHVzQ29kZSB9KTtcbiAgfVxufSJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJTZXNzaW9uTWFuYWdlciIsInZhbGlkYXRlTGFuZ3VhZ2UiLCJFcnJvckZhY3RvcnkiLCJoYW5kbGVBcGlFcnJvciIsIkFwcEVycm9yIiwibG9nIiwiZ2VuZXJhdGVSZXF1ZXN0SWQiLCJQT1NUIiwicmVxdWVzdCIsInJlcXVlc3RJZCIsInRpbWVyIiwicGVyZm9ybWFuY2UiLCJzZXNzaW9uTWFuYWdlciIsImdldEluc3RhbmNlIiwiYm9keSIsImpzb24iLCJjYXRjaCIsImNsaWVudElQIiwiaGVhZGVycyIsImdldCIsInVzZXJBZ2VudCIsImRldmljZVR5cGUiLCJ0ZXN0IiwibGFuZ3VhZ2UiLCJsYW5nVmFsaWRhdGlvbiIsImlzVmFsaWQiLCJzYW5pdGl6ZWQiLCJ3YXJuIiwicHJvdmlkZWRMYW5ndWFnZSIsImVycm9ycyIsInNlc3Npb25JZCIsImNyZWF0ZVNlc3Npb24iLCJpcEFkZHJlc3MiLCJidXNpbmVzcyIsInN1YnN0cmluZyIsInJlc3BvbnNlIiwic3VjY2VzcyIsImRhdGEiLCJkdXJhdGlvbiIsImVuZCIsImFwaSIsInN0YXR1cyIsImVycm9yIiwiYXBwRXJyb3IiLCJpbnRlcm5hbEVycm9yIiwiY29kZSIsInN0YXR1c0NvZGUiLCJHRVQiLCJ1cmwiLCJVUkwiLCJzZWFyY2hQYXJhbXMiLCJ2YWxpZGF0aW9uRmFpbGVkIiwic2Vzc2lvbiIsImdldFNlc3Npb24iLCJzZXNzaW9uTm90Rm91bmQiLCJERUxFVEUiLCJkZWxldGVkIiwiZGVsZXRlU2Vzc2lvbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/session/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/config.ts":
/*!***************************!*\
  !*** ./src/lib/config.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   getApiBaseUrl: () => (/* binding */ getApiBaseUrl),\n/* harmony export */   getSecureConfig: () => (/* binding */ getSecureConfig),\n/* harmony export */   isDevelopment: () => (/* binding */ isDevelopment),\n/* harmony export */   isProduction: () => (/* binding */ isProduction),\n/* harmony export */   securityConfig: () => (/* binding */ securityConfig),\n/* harmony export */   validateConfig: () => (/* binding */ validateConfig)\n/* harmony export */ });\n// API Key validation utility\nconst validateApiKey = (key, keyName)=>{\n    if (!key || key.length === 0) {\n        throw new Error(`${keyName} is required but not provided`);\n    }\n    // Check for dummy/placeholder values (更に厳格に)\n    const invalidPatterns = [\n        \"your_key_here\",\n        \"placeholder\",\n        \"dummy\",\n        \"test_key\",\n        \"example\",\n        \"sample\",\n        \"fake\",\n        \"mock\",\n        \"development\",\n        \"dev\",\n        \"localhost\"\n    ];\n    if (invalidPatterns.some((pattern)=>key.toLowerCase().includes(pattern))) {\n        throw new Error(`${keyName} appears to be a placeholder value`);\n    }\n    // Enhanced format validation for Gemini API key\n    if (keyName === \"GEMINI_API_KEY\") {\n        if (!key.startsWith(\"AIza\")) {\n            throw new Error(`${keyName} format is invalid (must start with 'AIza')`);\n        }\n        // Length validation (Gemini API keys are typically 39 characters)\n        if (key.length < 30 || key.length > 50) {\n            throw new Error(`${keyName} length is invalid (expected 30-50 characters)`);\n        }\n        // Character validation (should contain only alphanumeric and specific symbols)\n        if (!/^[A-Za-z0-9_-]+$/.test(key)) {\n            throw new Error(`${keyName} contains invalid characters`);\n        }\n    }\n    // Environment-specific validation\n    if (false) {}\n    return key;\n};\n// Safe configuration loading with validation\nconst loadConfig = ()=>{\n    try {\n        const geminiApiKey = validateApiKey(process.env.GEMINI_API_KEY, \"GEMINI_API_KEY\");\n        return {\n            geminiApiKey,\n            redisUrl: process.env.REDIS_URL,\n            gcpProjectId: process.env.GOOGLE_CLOUD_PROJECT_ID,\n            gcpRegion: process.env.GOOGLE_CLOUD_REGION || \"us-central1\",\n            enableVoice: \"true\" === \"true\",\n            enableMultiLanguage: \"true\" === \"true\",\n            maxSessionDuration: Math.max(60000, parseInt(\"3600000\" || 0)),\n            maxMessagesPerSession: Math.max(1, parseInt(\"50\" || 0)),\n            enableDynamicSearch: process.env.NEXT_PUBLIC_ENABLE_DYNAMIC_SEARCH !== \"false\",\n            tokyoOpenDataCatalogUrl: process.env.TOKYO_OPEN_DATA_CATALOG_URL || \"https://catalog.data.metro.tokyo.lg.jp\",\n            maxConcurrentDatasetRequests: Math.max(1, parseInt(process.env.MAX_CONCURRENT_DATASET_REQUESTS || \"5\"))\n        };\n    } catch (error) {\n        console.error(\"Configuration validation failed:\", error);\n        throw error;\n    }\n};\nconst config = loadConfig();\nconst validateConfig = ()=>{\n    const requiredKeys = [\n        \"geminiApiKey\"\n    ];\n    const missingKeys = requiredKeys.filter((key)=>!config[key]);\n    if (missingKeys.length > 0) {\n        throw new Error(`Missing required configuration: ${missingKeys.join(\", \")}`);\n    }\n    // Additional runtime validation\n    if (config.maxSessionDuration < 60000) {\n        throw new Error(\"maxSessionDuration must be at least 60 seconds\");\n    }\n    if (config.maxMessagesPerSession < 1) {\n        throw new Error(\"maxMessagesPerSession must be at least 1\");\n    }\n    // Security validation\n    if (false) {}\n    console.log(\"✅ Configuration validation passed\");\n};\n// Secure configuration getter - never logs sensitive values\nconst getSecureConfig = ()=>{\n    return {\n        ...config,\n        geminiApiKey: config.geminiApiKey ? \"[REDACTED]\" : \"NOT_SET\",\n        redisUrl: config.redisUrl ? \"[REDACTED]\" : \"NOT_SET\"\n    };\n};\nconst getApiBaseUrl = ()=>{\n    const baseUrl = \"http://localhost:3000\" || 0;\n    // Validate URL format\n    try {\n        new URL(baseUrl);\n        return baseUrl;\n    } catch  {\n        console.warn(`Invalid API base URL: ${baseUrl}, falling back to localhost`);\n        return \"http://localhost:3000\";\n    }\n};\nconst isProduction = ()=>{\n    return \"development\" === \"production\";\n};\nconst isDevelopment = ()=>{\n    return \"development\" === \"development\";\n};\n// Security configuration\nconst securityConfig = {\n    // Rate limiting\n    rateLimiting: {\n        windowMs: 15 * 60 * 1000,\n        maxRequests: isProduction() ? 100 : 1000,\n        skipSuccessfulRequests: false,\n        skipFailedRequests: false\n    },\n    // Input validation\n    validation: {\n        maxMessageLength: 2000,\n        maxFileSize: 10 * 1024 * 1024,\n        allowedAudioTypes: [\n            \"audio/webm\",\n            \"audio/mp3\",\n            \"audio/wav\",\n            \"audio/m4a\"\n        ]\n    },\n    // Session security\n    session: {\n        maxAge: config.maxSessionDuration,\n        httpOnly: true,\n        secure: isProduction(),\n        sameSite: \"strict\"\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VUFBVTtRQUNWQyxRQUFRZjtRQUNSZ0IsVUFBVTtJQUNaO0FBQ0YsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL3Rva3lvLW9wZW5kYXRhLWhhY2thdGhvbi8uL3NyYy9saWIvY29uZmlnLnRzP2EzZWYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwQ29uZmlnIH0gZnJvbSAnQC90eXBlcyc7XG5cbi8vIEFQSSBLZXkgdmFsaWRhdGlvbiB1dGlsaXR5XG5jb25zdCB2YWxpZGF0ZUFwaUtleSA9IChrZXk6IHN0cmluZyB8IHVuZGVmaW5lZCwga2V5TmFtZTogc3RyaW5nKTogc3RyaW5nID0+IHtcbiAgaWYgKCFrZXkgfHwga2V5Lmxlbmd0aCA9PT0gMCkge1xuICAgIHRocm93IG5ldyBFcnJvcihgJHtrZXlOYW1lfSBpcyByZXF1aXJlZCBidXQgbm90IHByb3ZpZGVkYCk7XG4gIH1cbiAgXG4gIC8vIENoZWNrIGZvciBkdW1teS9wbGFjZWhvbGRlciB2YWx1ZXMgKOabtOOBq+WOs+agvOOBqylcbiAgY29uc3QgaW52YWxpZFBhdHRlcm5zID0gW1xuICAgICd5b3VyX2tleV9oZXJlJywgJ3BsYWNlaG9sZGVyJywgJ2R1bW15JywgJ3Rlc3Rfa2V5JywgJ2V4YW1wbGUnLFxuICAgICdzYW1wbGUnLCAnZmFrZScsICdtb2NrJywgJ2RldmVsb3BtZW50JywgJ2RldicsICdsb2NhbGhvc3QnXG4gIF07XG4gIGlmIChpbnZhbGlkUGF0dGVybnMuc29tZShwYXR0ZXJuID0+IGtleS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHBhdHRlcm4pKSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgJHtrZXlOYW1lfSBhcHBlYXJzIHRvIGJlIGEgcGxhY2Vob2xkZXIgdmFsdWVgKTtcbiAgfVxuICBcbiAgLy8gRW5oYW5jZWQgZm9ybWF0IHZhbGlkYXRpb24gZm9yIEdlbWluaSBBUEkga2V5XG4gIGlmIChrZXlOYW1lID09PSAnR0VNSU5JX0FQSV9LRVknKSB7XG4gICAgaWYgKCFrZXkuc3RhcnRzV2l0aCgnQUl6YScpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7a2V5TmFtZX0gZm9ybWF0IGlzIGludmFsaWQgKG11c3Qgc3RhcnQgd2l0aCAnQUl6YScpYCk7XG4gICAgfVxuICAgIFxuICAgIC8vIExlbmd0aCB2YWxpZGF0aW9uIChHZW1pbmkgQVBJIGtleXMgYXJlIHR5cGljYWxseSAzOSBjaGFyYWN0ZXJzKVxuICAgIGlmIChrZXkubGVuZ3RoIDwgMzAgfHwga2V5Lmxlbmd0aCA+IDUwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7a2V5TmFtZX0gbGVuZ3RoIGlzIGludmFsaWQgKGV4cGVjdGVkIDMwLTUwIGNoYXJhY3RlcnMpYCk7XG4gICAgfVxuICAgIFxuICAgIC8vIENoYXJhY3RlciB2YWxpZGF0aW9uIChzaG91bGQgY29udGFpbiBvbmx5IGFscGhhbnVtZXJpYyBhbmQgc3BlY2lmaWMgc3ltYm9scylcbiAgICBpZiAoIS9eW0EtWmEtejAtOV8tXSskLy50ZXN0KGtleSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgJHtrZXlOYW1lfSBjb250YWlucyBpbnZhbGlkIGNoYXJhY3RlcnNgKTtcbiAgICB9XG4gIH1cbiAgXG4gIC8vIEVudmlyb25tZW50LXNwZWNpZmljIHZhbGlkYXRpb25cbiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicpIHtcbiAgICAvLyBJbiBwcm9kdWN0aW9uLCBlbnN1cmUga2V5IGRvZXNuJ3QgY29udGFpbiBkZXZlbG9wbWVudCBpbmRpY2F0b3JzXG4gICAgY29uc3QgZGV2SW5kaWNhdG9ycyA9IFsnZGV2JywgJ3Rlc3QnLCAnbG9jYWwnLCAnc3RhZ2luZyddO1xuICAgIGlmIChkZXZJbmRpY2F0b3JzLnNvbWUoaW5kaWNhdG9yID0+IGtleS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGluZGljYXRvcikpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7a2V5TmFtZX0gYXBwZWFycyB0byBiZSBhIGRldmVsb3BtZW50IGtleSBpbiBwcm9kdWN0aW9uIGVudmlyb25tZW50YCk7XG4gICAgfVxuICB9XG4gIFxuICByZXR1cm4ga2V5O1xufTtcblxuLy8gU2FmZSBjb25maWd1cmF0aW9uIGxvYWRpbmcgd2l0aCB2YWxpZGF0aW9uXG5jb25zdCBsb2FkQ29uZmlnID0gKCk6IEFwcENvbmZpZyA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgZ2VtaW5pQXBpS2V5ID0gdmFsaWRhdGVBcGlLZXkocHJvY2Vzcy5lbnYuR0VNSU5JX0FQSV9LRVksICdHRU1JTklfQVBJX0tFWScpO1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBnZW1pbmlBcGlLZXksXG4gICAgICByZWRpc1VybDogcHJvY2Vzcy5lbnYuUkVESVNfVVJMLFxuICAgICAgZ2NwUHJvamVjdElkOiBwcm9jZXNzLmVudi5HT09HTEVfQ0xPVURfUFJPSkVDVF9JRCxcbiAgICAgIGdjcFJlZ2lvbjogcHJvY2Vzcy5lbnYuR09PR0xFX0NMT1VEX1JFR0lPTiB8fCAndXMtY2VudHJhbDEnLFxuICAgICAgZW5hYmxlVm9pY2U6IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0VOQUJMRV9WT0lDRSA9PT0gJ3RydWUnLFxuICAgICAgZW5hYmxlTXVsdGlMYW5ndWFnZTogcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfRU5BQkxFX01VTFRJTEFORyA9PT0gJ3RydWUnLFxuICAgICAgbWF4U2Vzc2lvbkR1cmF0aW9uOiBNYXRoLm1heCg2MDAwMCwgcGFyc2VJbnQocHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfTUFYX1NFU1NJT05fRFVSQVRJT04gfHwgJzM2MDAwMDAnKSksIC8vIG1pbiAxIG1pbnV0ZVxuICAgICAgbWF4TWVzc2FnZXNQZXJTZXNzaW9uOiBNYXRoLm1heCgxLCBwYXJzZUludChwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19NQVhfTUVTU0FHRVNfUEVSX1NFU1NJT04gfHwgJzUwJykpLCAvLyBtaW4gMSBtZXNzYWdlXG4gICAgICBlbmFibGVEeW5hbWljU2VhcmNoOiBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19FTkFCTEVfRFlOQU1JQ19TRUFSQ0ggIT09ICdmYWxzZScsIC8vIOODh+ODleOCqeODq+ODiOacieWKuVxuICAgICAgdG9reW9PcGVuRGF0YUNhdGFsb2dVcmw6IHByb2Nlc3MuZW52LlRPS1lPX09QRU5fREFUQV9DQVRBTE9HX1VSTCB8fCAnaHR0cHM6Ly9jYXRhbG9nLmRhdGEubWV0cm8udG9reW8ubGcuanAnLFxuICAgICAgbWF4Q29uY3VycmVudERhdGFzZXRSZXF1ZXN0czogTWF0aC5tYXgoMSwgcGFyc2VJbnQocHJvY2Vzcy5lbnYuTUFYX0NPTkNVUlJFTlRfREFUQVNFVF9SRVFVRVNUUyB8fCAnNScpKSxcbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0NvbmZpZ3VyYXRpb24gdmFsaWRhdGlvbiBmYWlsZWQ6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59O1xuXG5leHBvcnQgY29uc3QgY29uZmlnOiBBcHBDb25maWcgPSBsb2FkQ29uZmlnKCk7XG5cbmV4cG9ydCBjb25zdCB2YWxpZGF0ZUNvbmZpZyA9ICgpOiB2b2lkID0+IHtcbiAgY29uc3QgcmVxdWlyZWRLZXlzID0gWydnZW1pbmlBcGlLZXknXTtcbiAgY29uc3QgbWlzc2luZ0tleXMgPSByZXF1aXJlZEtleXMuZmlsdGVyKGtleSA9PiAhY29uZmlnW2tleSBhcyBrZXlvZiBBcHBDb25maWddKTtcbiAgXG4gIGlmIChtaXNzaW5nS2V5cy5sZW5ndGggPiAwKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBNaXNzaW5nIHJlcXVpcmVkIGNvbmZpZ3VyYXRpb246ICR7bWlzc2luZ0tleXMuam9pbignLCAnKX1gKTtcbiAgfVxuICBcbiAgLy8gQWRkaXRpb25hbCBydW50aW1lIHZhbGlkYXRpb25cbiAgaWYgKGNvbmZpZy5tYXhTZXNzaW9uRHVyYXRpb24gPCA2MDAwMCkge1xuICAgIHRocm93IG5ldyBFcnJvcignbWF4U2Vzc2lvbkR1cmF0aW9uIG11c3QgYmUgYXQgbGVhc3QgNjAgc2Vjb25kcycpO1xuICB9XG4gIFxuICBpZiAoY29uZmlnLm1heE1lc3NhZ2VzUGVyU2Vzc2lvbiA8IDEpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ21heE1lc3NhZ2VzUGVyU2Vzc2lvbiBtdXN0IGJlIGF0IGxlYXN0IDEnKTtcbiAgfVxuICBcbiAgLy8gU2VjdXJpdHkgdmFsaWRhdGlvblxuICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJykge1xuICAgIC8vIEVuc3VyZSBzZW5zaXRpdmUgY29uZmlnIGlzIG5vdCBsb2dnZWQgaW4gcHJvZHVjdGlvblxuICAgIGlmIChjb25maWcuZ2VtaW5pQXBpS2V5Lmxlbmd0aCA8IDMwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0FQSSBrZXkgYXBwZWFycyB0byBiZSB0b28gc2hvcnQgZm9yIHByb2R1Y3Rpb24gdXNlJyk7XG4gICAgfVxuICAgIFxuICAgIC8vIFZhbGlkYXRlIFJlZGlzIFVSTCBpbiBwcm9kdWN0aW9uIGlmIHByb3ZpZGVkXG4gICAgaWYgKGNvbmZpZy5yZWRpc1VybCAmJiAhY29uZmlnLnJlZGlzVXJsLnN0YXJ0c1dpdGgoJ3JlZGlzOi8vJykgJiYgIWNvbmZpZy5yZWRpc1VybC5zdGFydHNXaXRoKCdyZWRpc3M6Ly8nKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIFJlZGlzIFVSTCBmb3JtYXQgaW4gcHJvZHVjdGlvbicpO1xuICAgIH1cbiAgfVxuICBcbiAgY29uc29sZS5sb2coJ+KchSBDb25maWd1cmF0aW9uIHZhbGlkYXRpb24gcGFzc2VkJyk7XG59O1xuXG4vLyBTZWN1cmUgY29uZmlndXJhdGlvbiBnZXR0ZXIgLSBuZXZlciBsb2dzIHNlbnNpdGl2ZSB2YWx1ZXNcbmV4cG9ydCBjb25zdCBnZXRTZWN1cmVDb25maWcgPSAoKSA9PiB7XG4gIHJldHVybiB7XG4gICAgLi4uY29uZmlnLFxuICAgIGdlbWluaUFwaUtleTogY29uZmlnLmdlbWluaUFwaUtleSA/ICdbUkVEQUNURURdJyA6ICdOT1RfU0VUJyxcbiAgICByZWRpc1VybDogY29uZmlnLnJlZGlzVXJsID8gJ1tSRURBQ1RFRF0nIDogJ05PVF9TRVQnLFxuICB9O1xufTtcblxuZXhwb3J0IGNvbnN0IGdldEFwaUJhc2VVcmwgPSAoKTogc3RyaW5nID0+IHtcbiAgY29uc3QgYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0FQSV9CQVNFX1VSTCB8fCAnaHR0cDovL2xvY2FsaG9zdDozMDAwJztcbiAgXG4gIC8vIFZhbGlkYXRlIFVSTCBmb3JtYXRcbiAgdHJ5IHtcbiAgICBuZXcgVVJMKGJhc2VVcmwpO1xuICAgIHJldHVybiBiYXNlVXJsO1xuICB9IGNhdGNoIHtcbiAgICBjb25zb2xlLndhcm4oYEludmFsaWQgQVBJIGJhc2UgVVJMOiAke2Jhc2VVcmx9LCBmYWxsaW5nIGJhY2sgdG8gbG9jYWxob3N0YCk7XG4gICAgcmV0dXJuICdodHRwOi8vbG9jYWxob3N0OjMwMDAnO1xuICB9XG59O1xuXG5leHBvcnQgY29uc3QgaXNQcm9kdWN0aW9uID0gKCk6IGJvb2xlYW4gPT4ge1xuICByZXR1cm4gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJztcbn07XG5cbmV4cG9ydCBjb25zdCBpc0RldmVsb3BtZW50ID0gKCk6IGJvb2xlYW4gPT4ge1xuICByZXR1cm4gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCc7XG59O1xuXG4vLyBTZWN1cml0eSBjb25maWd1cmF0aW9uXG5leHBvcnQgY29uc3Qgc2VjdXJpdHlDb25maWcgPSB7XG4gIC8vIFJhdGUgbGltaXRpbmdcbiAgcmF0ZUxpbWl0aW5nOiB7XG4gICAgd2luZG93TXM6IDE1ICogNjAgKiAxMDAwLCAvLyAxNSBtaW51dGVzXG4gICAgbWF4UmVxdWVzdHM6IGlzUHJvZHVjdGlvbigpID8gMTAwIDogMTAwMCwgLy8gUHJvZHVjdGlvbjogMTAwLzE1bWluLCBEZXY6IDEwMDAvMTVtaW5cbiAgICBza2lwU3VjY2Vzc2Z1bFJlcXVlc3RzOiBmYWxzZSxcbiAgICBza2lwRmFpbGVkUmVxdWVzdHM6IGZhbHNlLFxuICB9LFxuICBcbiAgLy8gSW5wdXQgdmFsaWRhdGlvblxuICB2YWxpZGF0aW9uOiB7XG4gICAgbWF4TWVzc2FnZUxlbmd0aDogMjAwMCxcbiAgICBtYXhGaWxlU2l6ZTogMTAgKiAxMDI0ICogMTAyNCwgLy8gMTBNQlxuICAgIGFsbG93ZWRBdWRpb1R5cGVzOiBbJ2F1ZGlvL3dlYm0nLCAnYXVkaW8vbXAzJywgJ2F1ZGlvL3dhdicsICdhdWRpby9tNGEnXSxcbiAgfSxcbiAgXG4gIC8vIFNlc3Npb24gc2VjdXJpdHlcbiAgc2Vzc2lvbjoge1xuICAgIG1heEFnZTogY29uZmlnLm1heFNlc3Npb25EdXJhdGlvbixcbiAgICBodHRwT25seTogdHJ1ZSxcbiAgICBzZWN1cmU6IGlzUHJvZHVjdGlvbigpLFxuICAgIHNhbWVTaXRlOiAnc3RyaWN0JyBhcyBjb25zdCxcbiAgfSxcbn07Il0sIm5hbWVzIjpbInZhbGlkYXRlQXBpS2V5Iiwia2V5Iiwia2V5TmFtZSIsImxlbmd0aCIsIkVycm9yIiwiaW52YWxpZFBhdHRlcm5zIiwic29tZSIsInBhdHRlcm4iLCJ0b0xvd2VyQ2FzZSIsImluY2x1ZGVzIiwic3RhcnRzV2l0aCIsInRlc3QiLCJwcm9jZXNzIiwiZGV2SW5kaWNhdG9ycyIsImluZGljYXRvciIsImxvYWRDb25maWciLCJnZW1pbmlBcGlLZXkiLCJlbnYiLCJHRU1JTklfQVBJX0tFWSIsInJlZGlzVXJsIiwiUkVESVNfVVJMIiwiZ2NwUHJvamVjdElkIiwiR09PR0xFX0NMT1VEX1BST0pFQ1RfSUQiLCJnY3BSZWdpb24iLCJHT09HTEVfQ0xPVURfUkVHSU9OIiwiZW5hYmxlVm9pY2UiLCJORVhUX1BVQkxJQ19FTkFCTEVfVk9JQ0UiLCJlbmFibGVNdWx0aUxhbmd1YWdlIiwiTkVYVF9QVUJMSUNfRU5BQkxFX01VTFRJTEFORyIsIm1heFNlc3Npb25EdXJhdGlvbiIsIk1hdGgiLCJtYXgiLCJwYXJzZUludCIsIk5FWFRfUFVCTElDX01BWF9TRVNTSU9OX0RVUkFUSU9OIiwibWF4TWVzc2FnZXNQZXJTZXNzaW9uIiwiTkVYVF9QVUJMSUNfTUFYX01FU1NBR0VTX1BFUl9TRVNTSU9OIiwiZW5hYmxlRHluYW1pY1NlYXJjaCIsIk5FWFRfUFVCTElDX0VOQUJMRV9EWU5BTUlDX1NFQVJDSCIsInRva3lvT3BlbkRhdGFDYXRhbG9nVXJsIiwiVE9LWU9fT1BFTl9EQVRBX0NBVEFMT0dfVVJMIiwibWF4Q29uY3VycmVudERhdGFzZXRSZXF1ZXN0cyIsIk1BWF9DT05DVVJSRU5UX0RBVEFTRVRfUkVRVUVTVFMiLCJlcnJvciIsImNvbnNvbGUiLCJjb25maWciLCJ2YWxpZGF0ZUNvbmZpZyIsInJlcXVpcmVkS2V5cyIsIm1pc3NpbmdLZXlzIiwiZmlsdGVyIiwiam9pbiIsImxvZyIsImdldFNlY3VyZUNvbmZpZyIsImdldEFwaUJhc2VVcmwiLCJiYXNlVXJsIiwiTkVYVF9QVUJMSUNfQVBJX0JBU0VfVVJMIiwiVVJMIiwid2FybiIsImlzUHJvZHVjdGlvbiIsImlzRGV2ZWxvcG1lbnQiLCJzZWN1cml0eUNvbmZpZyIsInJhdGVMaW1pdGluZyIsIndpbmRvd01zIiwibWF4UmVxdWVzdHMiLCJza2lwU3VjY2Vzc2Z1bFJlcXVlc3RzIiwic2tpcEZhaWxlZFJlcXVlc3RzIiwidmFsaWRhdGlvbiIsIm1heE1lc3NhZ2VMZW5ndGgiLCJtYXhGaWxlU2l6ZSIsImFsbG93ZWRBdWRpb1R5cGVzIiwic2Vzc2lvbiIsIm1heEFnZSIsImh0dHBPbmx5Iiwic2VjdXJlIiwic2FtZVNpdGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/config.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/errors.ts":
/*!***************************!*\
  !*** ./src/lib/errors.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AppError: () => (/* binding */ AppError),\n/* harmony export */   ErrorCode: () => (/* binding */ ErrorCode),\n/* harmony export */   ErrorFactory: () => (/* binding */ ErrorFactory),\n/* harmony export */   extractErrorInfo: () => (/* binding */ extractErrorInfo),\n/* harmony export */   handleApiError: () => (/* binding */ handleApiError)\n/* harmony export */ });\n// Standardized error handling system\nvar ErrorCode;\n(function(ErrorCode) {\n    // Authentication & Authorization\n    ErrorCode[\"INVALID_API_KEY\"] = \"INVALID_API_KEY\";\n    ErrorCode[\"RATE_LIMIT_EXCEEDED\"] = \"RATE_LIMIT_EXCEEDED\";\n    // Validation\n    ErrorCode[\"VALIDATION_FAILED\"] = \"VALIDATION_FAILED\";\n    ErrorCode[\"INVALID_INPUT\"] = \"INVALID_INPUT\";\n    ErrorCode[\"INVALID_SESSION\"] = \"INVALID_SESSION\";\n    ErrorCode[\"SESSION_NOT_FOUND\"] = \"SESSION_NOT_FOUND\";\n    // External Services\n    ErrorCode[\"GEMINI_API_ERROR\"] = \"GEMINI_API_ERROR\";\n    ErrorCode[\"GEMINI_QUOTA_EXCEEDED\"] = \"GEMINI_QUOTA_EXCEEDED\";\n    ErrorCode[\"GEMINI_UNAVAILABLE\"] = \"GEMINI_UNAVAILABLE\";\n    // Data & Search\n    ErrorCode[\"SEARCH_FAILED\"] = \"SEARCH_FAILED\";\n    ErrorCode[\"DATA_FETCH_FAILED\"] = \"DATA_FETCH_FAILED\";\n    ErrorCode[\"INDEX_INITIALIZATION_FAILED\"] = \"INDEX_INITIALIZATION_FAILED\";\n    // Audio Processing\n    ErrorCode[\"AUDIO_PROCESSING_FAILED\"] = \"AUDIO_PROCESSING_FAILED\";\n    ErrorCode[\"UNSUPPORTED_AUDIO_FORMAT\"] = \"UNSUPPORTED_AUDIO_FORMAT\";\n    ErrorCode[\"AUDIO_TOO_LARGE\"] = \"AUDIO_TOO_LARGE\";\n    // System\n    ErrorCode[\"INTERNAL_ERROR\"] = \"INTERNAL_ERROR\";\n    ErrorCode[\"SERVICE_UNAVAILABLE\"] = \"SERVICE_UNAVAILABLE\";\n    ErrorCode[\"CONFIGURATION_ERROR\"] = \"CONFIGURATION_ERROR\";\n})(ErrorCode || (ErrorCode = {}));\nclass AppError extends Error {\n    constructor(errorDetails){\n        super(errorDetails.message);\n        this.name = \"AppError\";\n        this.code = errorDetails.code;\n        this.statusCode = errorDetails.statusCode;\n        this.isRetryable = errorDetails.isRetryable;\n        this.details = errorDetails.details;\n        this.userMessage = errorDetails.userMessage;\n        // Maintains proper stack trace for where our error was thrown\n        Error.captureStackTrace(this, AppError);\n    }\n    toJSON() {\n        return {\n            name: this.name,\n            code: this.code,\n            message: this.message,\n            statusCode: this.statusCode,\n            isRetryable: this.isRetryable,\n            details: this.details,\n            stack: this.stack\n        };\n    }\n    getUserMessage(language = \"ja\") {\n        return this.userMessage[language] || this.userMessage.ja || this.message;\n    }\n}\n// Predefined error factories\nconst ErrorFactory = {\n    validationFailed: (details, validationErrors)=>{\n        return new AppError({\n            code: \"VALIDATION_FAILED\",\n            message: `Validation failed: ${details}`,\n            details: validationErrors,\n            statusCode: 400,\n            isRetryable: false,\n            userMessage: {\n                ja: \"入力内容に問題があります。正しい形式で入力してください。\",\n                en: \"There is an issue with your input. Please enter in the correct format.\",\n                zh: \"输入内容有问题。请以正确格式输入。\",\n                ko: \"입력 내용에 문제가 있습니다. 올바른 형식으로 입력해주세요.\"\n            }\n        });\n    },\n    rateLimitExceeded: (retryAfter = 60)=>{\n        return new AppError({\n            code: \"RATE_LIMIT_EXCEEDED\",\n            message: \"Rate limit exceeded\",\n            details: {\n                retryAfter\n            },\n            statusCode: 429,\n            isRetryable: true,\n            userMessage: {\n                ja: \"リクエストが多すぎます。しばらくお待ちください。\",\n                en: \"Too many requests. Please wait a moment.\",\n                zh: \"请求过多。请稍等。\",\n                ko: \"요청이 너무 많습니다. 잠시 기다려 주세요.\"\n            }\n        });\n    },\n    sessionNotFound: ()=>{\n        return new AppError({\n            code: \"SESSION_NOT_FOUND\",\n            message: \"Session not found or expired\",\n            statusCode: 404,\n            isRetryable: false,\n            userMessage: {\n                ja: \"セッションが見つからないか期限切れです。新しいセッションを作成してください。\",\n                en: \"Session not found or expired. Please create a new session.\",\n                zh: \"会话未找到或已过期。请创建新会话。\",\n                ko: \"세션을 찾을 수 없거나 만료되었습니다. 새 세션을 만들어주세요.\"\n            }\n        });\n    },\n    geminiApiError: (originalError)=>{\n        const isQuotaError = originalError?.message?.toLowerCase().includes(\"quota\");\n        const isUnavailable = originalError?.message?.toLowerCase().includes(\"unavailable\");\n        if (isQuotaError) {\n            return new AppError({\n                code: \"GEMINI_QUOTA_EXCEEDED\",\n                message: \"Gemini API quota exceeded\",\n                details: originalError,\n                statusCode: 503,\n                isRetryable: true,\n                userMessage: {\n                    ja: \"AIサービスの利用制限に達しました。しばらく後にお試しください。\",\n                    en: \"AI service usage limit reached. Please try again later.\",\n                    zh: \"AI服务使用限制已达到。请稍后再试。\",\n                    ko: \"AI 서비스 사용 한도에 도달했습니다. 나중에 다시 시도해주세요.\"\n                }\n            });\n        }\n        if (isUnavailable) {\n            return new AppError({\n                code: \"GEMINI_UNAVAILABLE\",\n                message: \"Gemini API temporarily unavailable\",\n                details: originalError,\n                statusCode: 503,\n                isRetryable: true,\n                userMessage: {\n                    ja: \"AIサービスが一時的に利用できません。しばらく後にお試しください。\",\n                    en: \"AI service is temporarily unavailable. Please try again later.\",\n                    zh: \"AI服务暂时不可用。请稍后再试。\",\n                    ko: \"AI 서비스가 일시적으로 사용할 수 없습니다. 나중에 다시 시도해주세요.\"\n                }\n            });\n        }\n        return new AppError({\n            code: \"GEMINI_API_ERROR\",\n            message: \"Gemini API error\",\n            details: originalError,\n            statusCode: 500,\n            isRetryable: false,\n            userMessage: {\n                ja: \"AIサービスでエラーが発生しました。\",\n                en: \"An error occurred with the AI service.\",\n                zh: \"AI服务发生错误。\",\n                ko: \"AI 서비스에서 오류가 발생했습니다.\"\n            }\n        });\n    },\n    searchFailed: (originalError)=>{\n        return new AppError({\n            code: \"SEARCH_FAILED\",\n            message: \"Search operation failed\",\n            details: originalError,\n            statusCode: 500,\n            isRetryable: true,\n            userMessage: {\n                ja: \"検索処理でエラーが発生しました。\",\n                en: \"An error occurred during search.\",\n                zh: \"搜索处理中发生错误。\",\n                ko: \"검색 처리 중 오류가 발생했습니다.\"\n            }\n        });\n    },\n    audioProcessingFailed: (originalError)=>{\n        return new AppError({\n            code: \"AUDIO_PROCESSING_FAILED\",\n            message: \"Audio processing failed\",\n            details: originalError,\n            statusCode: 500,\n            isRetryable: true,\n            userMessage: {\n                ja: \"音声処理でエラーが発生しました。\",\n                en: \"An error occurred during audio processing.\",\n                zh: \"音频处理中发生错误。\",\n                ko: \"음성 처리 중 오류가 발생했습니다.\"\n            }\n        });\n    },\n    internalError: (originalError)=>{\n        return new AppError({\n            code: \"INTERNAL_ERROR\",\n            message: \"Internal server error\",\n            details:  true ? originalError : 0,\n            statusCode: 500,\n            isRetryable: false,\n            userMessage: {\n                ja: \"システムエラーが発生しました。しばらく後にお試しください。\",\n                en: \"A system error occurred. Please try again later.\",\n                zh: \"系统错误。请稍后再试。\",\n                ko: \"시스템 오류가 발생했습니다. 나중에 다시 시도해주세요.\"\n            }\n        });\n    }\n};\n// Error handler for API responses\nconst handleApiError = (error, language = \"ja\")=>{\n    if (error instanceof AppError) {\n        return {\n            success: false,\n            error: error.getUserMessage(language),\n            code: error.code,\n            retryable: error.isRetryable\n        };\n    }\n    // Handle unknown errors\n    const internalError = ErrorFactory.internalError(error);\n    return {\n        success: false,\n        error: internalError.getUserMessage(language),\n        code: internalError.code,\n        retryable: internalError.isRetryable\n    };\n};\n// Utility to safely extract error information\nconst extractErrorInfo = (error)=>{\n    if (error instanceof Error) {\n        return {\n            message: error.message,\n            stack: error.stack,\n            details: error instanceof AppError ? error.details : undefined\n        };\n    }\n    if (typeof error === \"string\") {\n        return {\n            message: error\n        };\n    }\n    if (typeof error === \"object\" && error !== null) {\n        return {\n            message: error.message || \"Unknown error\",\n            details: error\n        };\n    }\n    return {\n        message: \"Unknown error occurred\"\n    };\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVl2QixXQUFtQixJQUFJO0lBQ2hFLElBQUl1QixpQkFBaUJ0QyxVQUFVO1FBQzdCLE9BQU87WUFDTHVDLFNBQVM7WUFDVEQsT0FBT0EsTUFBTXhCLGNBQWMsQ0FBQ0M7WUFDNUJULE1BQU1nQyxNQUFNaEMsSUFBSTtZQUNoQmtDLFdBQVdGLE1BQU05QixXQUFXO1FBQzlCO0lBQ0Y7SUFFQSx3QkFBd0I7SUFDeEIsTUFBTTBCLGdCQUFnQmpCLGFBQWFpQixhQUFhLENBQUNJO0lBQ2pELE9BQU87UUFDTEMsU0FBUztRQUNURCxPQUFPSixjQUFjcEIsY0FBYyxDQUFDQztRQUNwQ1QsTUFBTTRCLGNBQWM1QixJQUFJO1FBQ3hCa0MsV0FBV04sY0FBYzFCLFdBQVc7SUFDdEM7QUFDRixFQUFFO0FBRUYsOENBQThDO0FBQ3ZDLE1BQU1pQyxtQkFBbUIsQ0FBQ0g7SUFDL0IsSUFBSUEsaUJBQWlCckMsT0FBTztRQUMxQixPQUFPO1lBQ0xHLFNBQVNrQyxNQUFNbEMsT0FBTztZQUN0QlMsT0FBT3lCLE1BQU16QixLQUFLO1lBQ2xCSixTQUFTNkIsaUJBQWlCdEMsV0FBV3NDLE1BQU03QixPQUFPLEdBQUcyQjtRQUN2RDtJQUNGO0lBRUEsSUFBSSxPQUFPRSxVQUFVLFVBQVU7UUFDN0IsT0FBTztZQUFFbEMsU0FBU2tDO1FBQU07SUFDMUI7SUFFQSxJQUFJLE9BQU9BLFVBQVUsWUFBWUEsVUFBVSxNQUFNO1FBQy9DLE9BQU87WUFDTGxDLFNBQVNrQyxNQUFNbEMsT0FBTyxJQUFJO1lBQzFCSyxTQUFTNkI7UUFDWDtJQUNGO0lBRUEsT0FBTztRQUFFbEMsU0FBUztJQUF5QjtBQUM3QyxFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdG9reW8tb3BlbmRhdGEtaGFja2F0aG9uLy4vc3JjL2xpYi9lcnJvcnMudHM/NDUxYSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTdGFuZGFyZGl6ZWQgZXJyb3IgaGFuZGxpbmcgc3lzdGVtXG5cbmV4cG9ydCBlbnVtIEVycm9yQ29kZSB7XG4gIC8vIEF1dGhlbnRpY2F0aW9uICYgQXV0aG9yaXphdGlvblxuICBJTlZBTElEX0FQSV9LRVkgPSAnSU5WQUxJRF9BUElfS0VZJyxcbiAgUkFURV9MSU1JVF9FWENFRURFRCA9ICdSQVRFX0xJTUlUX0VYQ0VFREVEJyxcbiAgXG4gIC8vIFZhbGlkYXRpb25cbiAgVkFMSURBVElPTl9GQUlMRUQgPSAnVkFMSURBVElPTl9GQUlMRUQnLFxuICBJTlZBTElEX0lOUFVUID0gJ0lOVkFMSURfSU5QVVQnLFxuICBJTlZBTElEX1NFU1NJT04gPSAnSU5WQUxJRF9TRVNTSU9OJyxcbiAgU0VTU0lPTl9OT1RfRk9VTkQgPSAnU0VTU0lPTl9OT1RfRk9VTkQnLFxuICBcbiAgLy8gRXh0ZXJuYWwgU2VydmljZXNcbiAgR0VNSU5JX0FQSV9FUlJPUiA9ICdHRU1JTklfQVBJX0VSUk9SJyxcbiAgR0VNSU5JX1FVT1RBX0VYQ0VFREVEID0gJ0dFTUlOSV9RVU9UQV9FWENFRURFRCcsXG4gIEdFTUlOSV9VTkFWQUlMQUJMRSA9ICdHRU1JTklfVU5BVkFJTEFCTEUnLFxuICBcbiAgLy8gRGF0YSAmIFNlYXJjaFxuICBTRUFSQ0hfRkFJTEVEID0gJ1NFQVJDSF9GQUlMRUQnLFxuICBEQVRBX0ZFVENIX0ZBSUxFRCA9ICdEQVRBX0ZFVENIX0ZBSUxFRCcsXG4gIElOREVYX0lOSVRJQUxJWkFUSU9OX0ZBSUxFRCA9ICdJTkRFWF9JTklUSUFMSVpBVElPTl9GQUlMRUQnLFxuICBcbiAgLy8gQXVkaW8gUHJvY2Vzc2luZ1xuICBBVURJT19QUk9DRVNTSU5HX0ZBSUxFRCA9ICdBVURJT19QUk9DRVNTSU5HX0ZBSUxFRCcsXG4gIFVOU1VQUE9SVEVEX0FVRElPX0ZPUk1BVCA9ICdVTlNVUFBPUlRFRF9BVURJT19GT1JNQVQnLFxuICBBVURJT19UT09fTEFSR0UgPSAnQVVESU9fVE9PX0xBUkdFJyxcbiAgXG4gIC8vIFN5c3RlbVxuICBJTlRFUk5BTF9FUlJPUiA9ICdJTlRFUk5BTF9FUlJPUicsXG4gIFNFUlZJQ0VfVU5BVkFJTEFCTEUgPSAnU0VSVklDRV9VTkFWQUlMQUJMRScsXG4gIENPTkZJR1VSQVRJT05fRVJST1IgPSAnQ09ORklHVVJBVElPTl9FUlJPUicsXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRXJyb3JEZXRhaWxzIHtcbiAgY29kZTogRXJyb3JDb2RlO1xuICBtZXNzYWdlOiBzdHJpbmc7XG4gIGRldGFpbHM/OiBhbnk7XG4gIHN0YXR1c0NvZGU6IG51bWJlcjtcbiAgaXNSZXRyeWFibGU6IGJvb2xlYW47XG4gIHVzZXJNZXNzYWdlOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+OyAvLyBNdWx0aS1sYW5ndWFnZSB1c2VyIG1lc3NhZ2VzXG59XG5cbmV4cG9ydCBjbGFzcyBBcHBFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgcHVibGljIHJlYWRvbmx5IGNvZGU6IEVycm9yQ29kZTtcbiAgcHVibGljIHJlYWRvbmx5IHN0YXR1c0NvZGU6IG51bWJlcjtcbiAgcHVibGljIHJlYWRvbmx5IGlzUmV0cnlhYmxlOiBib29sZWFuO1xuICBwdWJsaWMgcmVhZG9ubHkgZGV0YWlscz86IGFueTtcbiAgcHVibGljIHJlYWRvbmx5IHVzZXJNZXNzYWdlOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xuXG4gIGNvbnN0cnVjdG9yKGVycm9yRGV0YWlsczogRXJyb3JEZXRhaWxzKSB7XG4gICAgc3VwZXIoZXJyb3JEZXRhaWxzLm1lc3NhZ2UpO1xuICAgIHRoaXMubmFtZSA9ICdBcHBFcnJvcic7XG4gICAgdGhpcy5jb2RlID0gZXJyb3JEZXRhaWxzLmNvZGU7XG4gICAgdGhpcy5zdGF0dXNDb2RlID0gZXJyb3JEZXRhaWxzLnN0YXR1c0NvZGU7XG4gICAgdGhpcy5pc1JldHJ5YWJsZSA9IGVycm9yRGV0YWlscy5pc1JldHJ5YWJsZTtcbiAgICB0aGlzLmRldGFpbHMgPSBlcnJvckRldGFpbHMuZGV0YWlscztcbiAgICB0aGlzLnVzZXJNZXNzYWdlID0gZXJyb3JEZXRhaWxzLnVzZXJNZXNzYWdlO1xuICAgIFxuICAgIC8vIE1haW50YWlucyBwcm9wZXIgc3RhY2sgdHJhY2UgZm9yIHdoZXJlIG91ciBlcnJvciB3YXMgdGhyb3duXG4gICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UodGhpcywgQXBwRXJyb3IpO1xuICB9XG5cbiAgdG9KU09OKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0aGlzLm5hbWUsXG4gICAgICBjb2RlOiB0aGlzLmNvZGUsXG4gICAgICBtZXNzYWdlOiB0aGlzLm1lc3NhZ2UsXG4gICAgICBzdGF0dXNDb2RlOiB0aGlzLnN0YXR1c0NvZGUsXG4gICAgICBpc1JldHJ5YWJsZTogdGhpcy5pc1JldHJ5YWJsZSxcbiAgICAgIGRldGFpbHM6IHRoaXMuZGV0YWlscyxcbiAgICAgIHN0YWNrOiB0aGlzLnN0YWNrLFxuICAgIH07XG4gIH1cblxuICBnZXRVc2VyTWVzc2FnZShsYW5ndWFnZTogc3RyaW5nID0gJ2phJyk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMudXNlck1lc3NhZ2VbbGFuZ3VhZ2VdIHx8IHRoaXMudXNlck1lc3NhZ2UuamEgfHwgdGhpcy5tZXNzYWdlO1xuICB9XG59XG5cbi8vIFByZWRlZmluZWQgZXJyb3IgZmFjdG9yaWVzXG5leHBvcnQgY29uc3QgRXJyb3JGYWN0b3J5ID0ge1xuICB2YWxpZGF0aW9uRmFpbGVkOiAoZGV0YWlsczogc3RyaW5nLCB2YWxpZGF0aW9uRXJyb3JzPzogc3RyaW5nW10pOiBBcHBFcnJvciA9PiB7XG4gICAgcmV0dXJuIG5ldyBBcHBFcnJvcih7XG4gICAgICBjb2RlOiBFcnJvckNvZGUuVkFMSURBVElPTl9GQUlMRUQsXG4gICAgICBtZXNzYWdlOiBgVmFsaWRhdGlvbiBmYWlsZWQ6ICR7ZGV0YWlsc31gLFxuICAgICAgZGV0YWlsczogdmFsaWRhdGlvbkVycm9ycyxcbiAgICAgIHN0YXR1c0NvZGU6IDQwMCxcbiAgICAgIGlzUmV0cnlhYmxlOiBmYWxzZSxcbiAgICAgIHVzZXJNZXNzYWdlOiB7XG4gICAgICAgIGphOiAn5YWl5Yqb5YaF5a6544Gr5ZWP6aGM44GM44GC44KK44G+44GZ44CC5q2j44GX44GE5b2i5byP44Gn5YWl5Yqb44GX44Gm44GP44Gg44GV44GE44CCJyxcbiAgICAgICAgZW46ICdUaGVyZSBpcyBhbiBpc3N1ZSB3aXRoIHlvdXIgaW5wdXQuIFBsZWFzZSBlbnRlciBpbiB0aGUgY29ycmVjdCBmb3JtYXQuJyxcbiAgICAgICAgemg6ICfovpPlhaXlhoXlrrnmnInpl67popjjgILor7fku6XmraPnoa7moLzlvI/ovpPlhaXjgIInLFxuICAgICAgICBrbzogJ+yeheugpSDrgrTsmqnsl5Ag66y47KCc6rCAIOyeiOyKteuLiOuLpC4g7Jis67CU66W4IO2YleyLneycvOuhnCDsnoXroKXtlbTso7zshLjsmpQuJyxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0sXG5cbiAgcmF0ZUxpbWl0RXhjZWVkZWQ6IChyZXRyeUFmdGVyOiBudW1iZXIgPSA2MCk6IEFwcEVycm9yID0+IHtcbiAgICByZXR1cm4gbmV3IEFwcEVycm9yKHtcbiAgICAgIGNvZGU6IEVycm9yQ29kZS5SQVRFX0xJTUlUX0VYQ0VFREVELFxuICAgICAgbWVzc2FnZTogJ1JhdGUgbGltaXQgZXhjZWVkZWQnLFxuICAgICAgZGV0YWlsczogeyByZXRyeUFmdGVyIH0sXG4gICAgICBzdGF0dXNDb2RlOiA0MjksXG4gICAgICBpc1JldHJ5YWJsZTogdHJ1ZSxcbiAgICAgIHVzZXJNZXNzYWdlOiB7XG4gICAgICAgIGphOiAn44Oq44Kv44Ko44K544OI44GM5aSa44GZ44GO44G+44GZ44CC44GX44Gw44KJ44GP44GK5b6F44Gh44GP44Gg44GV44GE44CCJyxcbiAgICAgICAgZW46ICdUb28gbWFueSByZXF1ZXN0cy4gUGxlYXNlIHdhaXQgYSBtb21lbnQuJyxcbiAgICAgICAgemg6ICfor7fmsYLov4flpJrjgILor7fnqI3nrYnjgIInLFxuICAgICAgICBrbzogJ+yalOyyreydtCDrhIjrrLQg66eO7Iq164uI64ukLiDsnqDsi5wg6riw64uk66CkIOyjvOyEuOyalC4nLFxuICAgICAgfSxcbiAgICB9KTtcbiAgfSxcblxuICBzZXNzaW9uTm90Rm91bmQ6ICgpOiBBcHBFcnJvciA9PiB7XG4gICAgcmV0dXJuIG5ldyBBcHBFcnJvcih7XG4gICAgICBjb2RlOiBFcnJvckNvZGUuU0VTU0lPTl9OT1RfRk9VTkQsXG4gICAgICBtZXNzYWdlOiAnU2Vzc2lvbiBub3QgZm91bmQgb3IgZXhwaXJlZCcsXG4gICAgICBzdGF0dXNDb2RlOiA0MDQsXG4gICAgICBpc1JldHJ5YWJsZTogZmFsc2UsXG4gICAgICB1c2VyTWVzc2FnZToge1xuICAgICAgICBqYTogJ+OCu+ODg+OCt+ODp+ODs+OBjOimi+OBpOOBi+OCieOBquOBhOOBi+acn+mZkOWIh+OCjOOBp+OBmeOAguaWsOOBl+OBhOOCu+ODg+OCt+ODp+ODs+OCkuS9nOaIkOOBl+OBpuOBj+OBoOOBleOBhOOAgicsXG4gICAgICAgIGVuOiAnU2Vzc2lvbiBub3QgZm91bmQgb3IgZXhwaXJlZC4gUGxlYXNlIGNyZWF0ZSBhIG5ldyBzZXNzaW9uLicsXG4gICAgICAgIHpoOiAn5Lya6K+d5pyq5om+5Yiw5oiW5bey6L+H5pyf44CC6K+35Yib5bu65paw5Lya6K+d44CCJyxcbiAgICAgICAga286ICfshLjshZjsnYQg7LC+7J2EIOyImCDsl4bqsbDrgpgg66eM66OM65CY7JeI7Iq164uI64ukLiDsg4gg7IS47IWY7J2EIOunjOuTpOyWtOyjvOyEuOyalC4nLFxuICAgICAgfSxcbiAgICB9KTtcbiAgfSxcblxuICBnZW1pbmlBcGlFcnJvcjogKG9yaWdpbmFsRXJyb3I6IGFueSk6IEFwcEVycm9yID0+IHtcbiAgICBjb25zdCBpc1F1b3RhRXJyb3IgPSBvcmlnaW5hbEVycm9yPy5tZXNzYWdlPy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdxdW90YScpO1xuICAgIGNvbnN0IGlzVW5hdmFpbGFibGUgPSBvcmlnaW5hbEVycm9yPy5tZXNzYWdlPy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCd1bmF2YWlsYWJsZScpO1xuICAgIFxuICAgIGlmIChpc1F1b3RhRXJyb3IpIHtcbiAgICAgIHJldHVybiBuZXcgQXBwRXJyb3Ioe1xuICAgICAgICBjb2RlOiBFcnJvckNvZGUuR0VNSU5JX1FVT1RBX0VYQ0VFREVELFxuICAgICAgICBtZXNzYWdlOiAnR2VtaW5pIEFQSSBxdW90YSBleGNlZWRlZCcsXG4gICAgICAgIGRldGFpbHM6IG9yaWdpbmFsRXJyb3IsXG4gICAgICAgIHN0YXR1c0NvZGU6IDUwMyxcbiAgICAgICAgaXNSZXRyeWFibGU6IHRydWUsXG4gICAgICAgIHVzZXJNZXNzYWdlOiB7XG4gICAgICAgICAgamE6ICdBSeOCteODvOODk+OCueOBruWIqeeUqOWItumZkOOBq+mBlOOBl+OBvuOBl+OBn+OAguOBl+OBsOOCieOBj+W+jOOBq+OBiuippuOBl+OBj+OBoOOBleOBhOOAgicsXG4gICAgICAgICAgZW46ICdBSSBzZXJ2aWNlIHVzYWdlIGxpbWl0IHJlYWNoZWQuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuJyxcbiAgICAgICAgICB6aDogJ0FJ5pyN5Yqh5L2/55So6ZmQ5Yi25bey6L6+5Yiw44CC6K+356iN5ZCO5YaN6K+V44CCJyxcbiAgICAgICAgICBrbzogJ0FJIOyEnOu5hOyKpCDsgqzsmqkg7ZWc64+E7JeQIOuPhOuLrO2WiOyKteuLiOuLpC4g64KY7KSR7JeQIOuLpOyLnCDsi5zrj4TtlbTso7zshLjsmpQuJyxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICBpZiAoaXNVbmF2YWlsYWJsZSkge1xuICAgICAgcmV0dXJuIG5ldyBBcHBFcnJvcih7XG4gICAgICAgIGNvZGU6IEVycm9yQ29kZS5HRU1JTklfVU5BVkFJTEFCTEUsXG4gICAgICAgIG1lc3NhZ2U6ICdHZW1pbmkgQVBJIHRlbXBvcmFyaWx5IHVuYXZhaWxhYmxlJyxcbiAgICAgICAgZGV0YWlsczogb3JpZ2luYWxFcnJvcixcbiAgICAgICAgc3RhdHVzQ29kZTogNTAzLFxuICAgICAgICBpc1JldHJ5YWJsZTogdHJ1ZSxcbiAgICAgICAgdXNlck1lc3NhZ2U6IHtcbiAgICAgICAgICBqYTogJ0FJ44K144O844OT44K544GM5LiA5pmC55qE44Gr5Yip55So44Gn44GN44G+44Gb44KT44CC44GX44Gw44KJ44GP5b6M44Gr44GK6Kmm44GX44GP44Gg44GV44GE44CCJyxcbiAgICAgICAgICBlbjogJ0FJIHNlcnZpY2UgaXMgdGVtcG9yYXJpbHkgdW5hdmFpbGFibGUuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuJyxcbiAgICAgICAgICB6aDogJ0FJ5pyN5Yqh5pqC5pe25LiN5Y+v55So44CC6K+356iN5ZCO5YaN6K+V44CCJyxcbiAgICAgICAgICBrbzogJ0FJIOyEnOu5hOyKpOqwgCDsnbzsi5zsoIHsnLzroZwg7IKs7Jqp7ZWgIOyImCDsl4bsirXri4jri6QuIOuCmOykkeyXkCDri6Tsi5wg7Iuc64+E7ZW07KO87IS47JqULicsXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIG5ldyBBcHBFcnJvcih7XG4gICAgICBjb2RlOiBFcnJvckNvZGUuR0VNSU5JX0FQSV9FUlJPUixcbiAgICAgIG1lc3NhZ2U6ICdHZW1pbmkgQVBJIGVycm9yJyxcbiAgICAgIGRldGFpbHM6IG9yaWdpbmFsRXJyb3IsXG4gICAgICBzdGF0dXNDb2RlOiA1MDAsXG4gICAgICBpc1JldHJ5YWJsZTogZmFsc2UsXG4gICAgICB1c2VyTWVzc2FnZToge1xuICAgICAgICBqYTogJ0FJ44K144O844OT44K544Gn44Ko44Op44O844GM55m655Sf44GX44G+44GX44Gf44CCJyxcbiAgICAgICAgZW46ICdBbiBlcnJvciBvY2N1cnJlZCB3aXRoIHRoZSBBSSBzZXJ2aWNlLicsXG4gICAgICAgIHpoOiAnQUnmnI3liqHlj5HnlJ/plJnor6/jgIInLFxuICAgICAgICBrbzogJ0FJIOyEnOu5hOyKpOyXkOyEnCDsmKTrpZjqsIAg67Cc7IOd7ZaI7Iq164uI64ukLicsXG4gICAgICB9LFxuICAgIH0pO1xuICB9LFxuXG4gIHNlYXJjaEZhaWxlZDogKG9yaWdpbmFsRXJyb3I6IGFueSk6IEFwcEVycm9yID0+IHtcbiAgICByZXR1cm4gbmV3IEFwcEVycm9yKHtcbiAgICAgIGNvZGU6IEVycm9yQ29kZS5TRUFSQ0hfRkFJTEVELFxuICAgICAgbWVzc2FnZTogJ1NlYXJjaCBvcGVyYXRpb24gZmFpbGVkJyxcbiAgICAgIGRldGFpbHM6IG9yaWdpbmFsRXJyb3IsXG4gICAgICBzdGF0dXNDb2RlOiA1MDAsXG4gICAgICBpc1JldHJ5YWJsZTogdHJ1ZSxcbiAgICAgIHVzZXJNZXNzYWdlOiB7XG4gICAgICAgIGphOiAn5qSc57Si5Yem55CG44Gn44Ko44Op44O844GM55m655Sf44GX44G+44GX44Gf44CCJyxcbiAgICAgICAgZW46ICdBbiBlcnJvciBvY2N1cnJlZCBkdXJpbmcgc2VhcmNoLicsXG4gICAgICAgIHpoOiAn5pCc57Si5aSE55CG5Lit5Y+R55Sf6ZSZ6K+v44CCJyxcbiAgICAgICAga286ICfqsoDsg4kg7LKY66asIOykkSDsmKTrpZjqsIAg67Cc7IOd7ZaI7Iq164uI64ukLicsXG4gICAgICB9LFxuICAgIH0pO1xuICB9LFxuXG4gIGF1ZGlvUHJvY2Vzc2luZ0ZhaWxlZDogKG9yaWdpbmFsRXJyb3I6IGFueSk6IEFwcEVycm9yID0+IHtcbiAgICByZXR1cm4gbmV3IEFwcEVycm9yKHtcbiAgICAgIGNvZGU6IEVycm9yQ29kZS5BVURJT19QUk9DRVNTSU5HX0ZBSUxFRCxcbiAgICAgIG1lc3NhZ2U6ICdBdWRpbyBwcm9jZXNzaW5nIGZhaWxlZCcsXG4gICAgICBkZXRhaWxzOiBvcmlnaW5hbEVycm9yLFxuICAgICAgc3RhdHVzQ29kZTogNTAwLFxuICAgICAgaXNSZXRyeWFibGU6IHRydWUsXG4gICAgICB1c2VyTWVzc2FnZToge1xuICAgICAgICBqYTogJ+mfs+WjsOWHpueQhuOBp+OCqOODqeODvOOBjOeZuueUn+OBl+OBvuOBl+OBn+OAgicsXG4gICAgICAgIGVuOiAnQW4gZXJyb3Igb2NjdXJyZWQgZHVyaW5nIGF1ZGlvIHByb2Nlc3NpbmcuJyxcbiAgICAgICAgemg6ICfpn7PpopHlpITnkIbkuK3lj5HnlJ/plJnor6/jgIInLFxuICAgICAgICBrbzogJ+ydjOyEsSDsspjrpqwg7KSRIOyYpOulmOqwgCDrsJzsg53tlojsirXri4jri6QuJyxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0sXG5cbiAgaW50ZXJuYWxFcnJvcjogKG9yaWdpbmFsRXJyb3I6IGFueSk6IEFwcEVycm9yID0+IHtcbiAgICByZXR1cm4gbmV3IEFwcEVycm9yKHtcbiAgICAgIGNvZGU6IEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUixcbiAgICAgIG1lc3NhZ2U6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InLFxuICAgICAgZGV0YWlsczogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgPyBvcmlnaW5hbEVycm9yIDogdW5kZWZpbmVkLFxuICAgICAgc3RhdHVzQ29kZTogNTAwLFxuICAgICAgaXNSZXRyeWFibGU6IGZhbHNlLFxuICAgICAgdXNlck1lc3NhZ2U6IHtcbiAgICAgICAgamE6ICfjgrfjgrnjg4bjg6Djgqjjg6njg7zjgYznmbrnlJ/jgZfjgb7jgZfjgZ/jgILjgZfjgbDjgonjgY/lvozjgavjgYroqabjgZfjgY/jgaDjgZXjgYTjgIInLFxuICAgICAgICBlbjogJ0Egc3lzdGVtIGVycm9yIG9jY3VycmVkLiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyLicsXG4gICAgICAgIHpoOiAn57O757uf6ZSZ6K+v44CC6K+356iN5ZCO5YaN6K+V44CCJyxcbiAgICAgICAga286ICfsi5zsiqTthZwg7Jik66WY6rCAIOuwnOyDne2WiOyKteuLiOuLpC4g64KY7KSR7JeQIOuLpOyLnCDsi5zrj4TtlbTso7zshLjsmpQuJyxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0sXG59O1xuXG4vLyBFcnJvciBoYW5kbGVyIGZvciBBUEkgcmVzcG9uc2VzXG5leHBvcnQgY29uc3QgaGFuZGxlQXBpRXJyb3IgPSAoZXJyb3I6IGFueSwgbGFuZ3VhZ2U6IHN0cmluZyA9ICdqYScpID0+IHtcbiAgaWYgKGVycm9yIGluc3RhbmNlb2YgQXBwRXJyb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjogZXJyb3IuZ2V0VXNlck1lc3NhZ2UobGFuZ3VhZ2UpLFxuICAgICAgY29kZTogZXJyb3IuY29kZSxcbiAgICAgIHJldHJ5YWJsZTogZXJyb3IuaXNSZXRyeWFibGUsXG4gICAgfTtcbiAgfVxuICBcbiAgLy8gSGFuZGxlIHVua25vd24gZXJyb3JzXG4gIGNvbnN0IGludGVybmFsRXJyb3IgPSBFcnJvckZhY3RvcnkuaW50ZXJuYWxFcnJvcihlcnJvcik7XG4gIHJldHVybiB7XG4gICAgc3VjY2VzczogZmFsc2UsXG4gICAgZXJyb3I6IGludGVybmFsRXJyb3IuZ2V0VXNlck1lc3NhZ2UobGFuZ3VhZ2UpLFxuICAgIGNvZGU6IGludGVybmFsRXJyb3IuY29kZSxcbiAgICByZXRyeWFibGU6IGludGVybmFsRXJyb3IuaXNSZXRyeWFibGUsXG4gIH07XG59O1xuXG4vLyBVdGlsaXR5IHRvIHNhZmVseSBleHRyYWN0IGVycm9yIGluZm9ybWF0aW9uXG5leHBvcnQgY29uc3QgZXh0cmFjdEVycm9ySW5mbyA9IChlcnJvcjogYW55KTogeyBtZXNzYWdlOiBzdHJpbmc7IHN0YWNrPzogc3RyaW5nOyBkZXRhaWxzPzogYW55IH0gPT4ge1xuICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgIHJldHVybiB7XG4gICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxuICAgICAgc3RhY2s6IGVycm9yLnN0YWNrLFxuICAgICAgZGV0YWlsczogZXJyb3IgaW5zdGFuY2VvZiBBcHBFcnJvciA/IGVycm9yLmRldGFpbHMgOiB1bmRlZmluZWQsXG4gICAgfTtcbiAgfVxuICBcbiAgaWYgKHR5cGVvZiBlcnJvciA9PT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4geyBtZXNzYWdlOiBlcnJvciB9O1xuICB9XG4gIFxuICBpZiAodHlwZW9mIGVycm9yID09PSAnb2JqZWN0JyAmJiBlcnJvciAhPT0gbnVsbCkge1xuICAgIHJldHVybiB7XG4gICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlIHx8ICdVbmtub3duIGVycm9yJyxcbiAgICAgIGRldGFpbHM6IGVycm9yLFxuICAgIH07XG4gIH1cbiAgXG4gIHJldHVybiB7IG1lc3NhZ2U6ICdVbmtub3duIGVycm9yIG9jY3VycmVkJyB9O1xufTsiXSwibmFtZXMiOlsiRXJyb3JDb2RlIiwiQXBwRXJyb3IiLCJFcnJvciIsImNvbnN0cnVjdG9yIiwiZXJyb3JEZXRhaWxzIiwibWVzc2FnZSIsIm5hbWUiLCJjb2RlIiwic3RhdHVzQ29kZSIsImlzUmV0cnlhYmxlIiwiZGV0YWlscyIsInVzZXJNZXNzYWdlIiwiY2FwdHVyZVN0YWNrVHJhY2UiLCJ0b0pTT04iLCJzdGFjayIsImdldFVzZXJNZXNzYWdlIiwibGFuZ3VhZ2UiLCJqYSIsIkVycm9yRmFjdG9yeSIsInZhbGlkYXRpb25GYWlsZWQiLCJ2YWxpZGF0aW9uRXJyb3JzIiwiZW4iLCJ6aCIsImtvIiwicmF0ZUxpbWl0RXhjZWVkZWQiLCJyZXRyeUFmdGVyIiwic2Vzc2lvbk5vdEZvdW5kIiwiZ2VtaW5pQXBpRXJyb3IiLCJvcmlnaW5hbEVycm9yIiwiaXNRdW90YUVycm9yIiwidG9Mb3dlckNhc2UiLCJpbmNsdWRlcyIsImlzVW5hdmFpbGFibGUiLCJzZWFyY2hGYWlsZWQiLCJhdWRpb1Byb2Nlc3NpbmdGYWlsZWQiLCJpbnRlcm5hbEVycm9yIiwicHJvY2VzcyIsInVuZGVmaW5lZCIsImhhbmRsZUFwaUVycm9yIiwiZXJyb3IiLCJzdWNjZXNzIiwicmV0cnlhYmxlIiwiZXh0cmFjdEVycm9ySW5mbyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/errors.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/logger.ts":
/*!***************************!*\
  !*** ./src/lib/logger.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   LogLevel: () => (/* binding */ LogLevel),\n/* harmony export */   PerformanceTimer: () => (/* binding */ PerformanceTimer),\n/* harmony export */   generateRequestId: () => (/* binding */ generateRequestId),\n/* harmony export */   log: () => (/* binding */ log),\n/* harmony export */   logger: () => (/* binding */ logger)\n/* harmony export */ });\n// Enhanced logging system with multiple levels and structured logging\nvar LogLevel;\n(function(LogLevel) {\n    LogLevel[LogLevel[\"DEBUG\"] = 0] = \"DEBUG\";\n    LogLevel[LogLevel[\"INFO\"] = 1] = \"INFO\";\n    LogLevel[LogLevel[\"WARN\"] = 2] = \"WARN\";\n    LogLevel[LogLevel[\"ERROR\"] = 3] = \"ERROR\";\n    LogLevel[LogLevel[\"FATAL\"] = 4] = \"FATAL\";\n})(LogLevel || (LogLevel = {}));\nclass Logger {\n    constructor(){\n        this.logs = [];\n        this.maxLogHistory = 1000;\n        this.minLevel = this.getLogLevel();\n    }\n    getLogLevel() {\n        const level = process.env.LOG_LEVEL?.toUpperCase() || \"INFO\";\n        switch(level){\n            case \"DEBUG\":\n                return 0;\n            case \"INFO\":\n                return 1;\n            case \"WARN\":\n                return 2;\n            case \"ERROR\":\n                return 3;\n            case \"FATAL\":\n                return 4;\n            default:\n                return 1;\n        }\n    }\n    shouldLog(level) {\n        return level >= this.minLevel;\n    }\n    formatMessage(entry) {\n        const timestamp = entry.timestamp.toISOString();\n        const level = LogLevel[entry.level].padEnd(5);\n        const context = entry.context ? ` | Context: ${JSON.stringify(entry.context)}` : \"\";\n        const requestId = entry.requestId ? ` | RequestID: ${entry.requestId}` : \"\";\n        const performance = entry.performance?.duration ? ` | Duration: ${entry.performance.duration}ms` : \"\";\n        return `[${timestamp}] ${level} | ${entry.message}${context}${requestId}${performance}`;\n    }\n    writeLog(entry) {\n        if (!this.shouldLog(entry.level)) {\n            return;\n        }\n        const formattedMessage = this.formatMessage(entry);\n        // Console output\n        switch(entry.level){\n            case 0:\n                console.debug(formattedMessage);\n                break;\n            case 1:\n                console.info(formattedMessage);\n                break;\n            case 2:\n                console.warn(formattedMessage);\n                break;\n            case 3:\n            case 4:\n                console.error(formattedMessage);\n                if (entry.error) {\n                    console.error(\"Stack trace:\", entry.error.stack);\n                }\n                break;\n        }\n        // Store in memory (for debugging and monitoring)\n        this.logs.push(entry);\n        if (this.logs.length > this.maxLogHistory) {\n            this.logs = this.logs.slice(-this.maxLogHistory);\n        }\n    }\n    debug(message, context, requestId) {\n        this.writeLog({\n            level: 0,\n            message,\n            timestamp: new Date(),\n            context,\n            requestId\n        });\n    }\n    info(message, context, requestId) {\n        this.writeLog({\n            level: 1,\n            message,\n            timestamp: new Date(),\n            context,\n            requestId\n        });\n    }\n    warn(message, context, requestId) {\n        this.writeLog({\n            level: 2,\n            message,\n            timestamp: new Date(),\n            context,\n            requestId\n        });\n    }\n    error(message, error, context, requestId) {\n        this.writeLog({\n            level: 3,\n            message,\n            timestamp: new Date(),\n            error,\n            context,\n            requestId\n        });\n    }\n    fatal(message, error, context, requestId) {\n        this.writeLog({\n            level: 4,\n            message,\n            timestamp: new Date(),\n            error,\n            context,\n            requestId\n        });\n    }\n    // Performance logging\n    performance(message, duration, context, requestId) {\n        this.writeLog({\n            level: 1,\n            message,\n            timestamp: new Date(),\n            context,\n            requestId,\n            performance: {\n                duration,\n                memory: process.memoryUsage()\n            }\n        });\n    }\n    // API request logging\n    apiRequest(method, path, statusCode, duration, requestId) {\n        const level = statusCode >= 400 ? 3 : 1;\n        this.writeLog({\n            level,\n            message: `API ${method} ${path} - ${statusCode}`,\n            timestamp: new Date(),\n            context: {\n                method,\n                path,\n                statusCode,\n                type: \"api_request\"\n            },\n            requestId,\n            performance: {\n                duration\n            }\n        });\n    }\n    // Security logging\n    security(event, details, requestId) {\n        this.writeLog({\n            level: 2,\n            message: `Security Event: ${event}`,\n            timestamp: new Date(),\n            context: {\n                ...details,\n                type: \"security_event\"\n            },\n            requestId\n        });\n    }\n    // Business logic logging\n    business(event, details, requestId) {\n        this.writeLog({\n            level: 1,\n            message: `Business Event: ${event}`,\n            timestamp: new Date(),\n            context: {\n                ...details,\n                type: \"business_event\"\n            },\n            requestId\n        });\n    }\n    // Get recent logs for debugging\n    getRecentLogs(count = 100) {\n        return this.logs.slice(-count);\n    }\n    // Get logs by level\n    getLogsByLevel(level, count = 100) {\n        return this.logs.filter((log)=>log.level === level).slice(-count);\n    }\n    // Get logs by time range\n    getLogsByTimeRange(from, to) {\n        return this.logs.filter((log)=>log.timestamp >= from && log.timestamp <= to);\n    }\n    // Clear logs\n    clearLogs() {\n        this.logs = [];\n        this.info(\"Log history cleared\");\n    }\n    // Get statistics\n    getStats() {\n        const logCounts = {};\n        for (const log of this.logs){\n            const levelName = LogLevel[log.level];\n            logCounts[levelName] = (logCounts[levelName] || 0) + 1;\n        }\n        return {\n            totalLogs: this.logs.length,\n            logCounts,\n            oldestLog: this.logs.length > 0 ? this.logs[0].timestamp : undefined,\n            newestLog: this.logs.length > 0 ? this.logs[this.logs.length - 1].timestamp : undefined\n        };\n    }\n}\n// Create singleton logger instance\nconst logger = new Logger();\n// Performance measurement utility\nclass PerformanceTimer {\n    constructor(name, requestId){\n        this.name = name;\n        this.requestId = requestId;\n        this.startTime = Date.now();\n    }\n    end(context) {\n        const duration = Date.now() - this.startTime;\n        logger.performance(`${this.name} completed`, duration, context, this.requestId);\n        return duration;\n    }\n}\n// Request ID generator\nconst generateRequestId = ()=>{\n    return `req_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n};\n// Export singleton logger\n\n// Convenience functions\nconst log = {\n    debug: (message, context, requestId)=>logger.debug(message, context, requestId),\n    info: (message, context, requestId)=>logger.info(message, context, requestId),\n    warn: (message, context, requestId)=>logger.warn(message, context, requestId),\n    error: (message, error, context, requestId)=>logger.error(message, error, context, requestId),\n    fatal: (message, error, context, requestId)=>logger.fatal(message, error, context, requestId),\n    performance: (name, requestId)=>new PerformanceTimer(name, requestId),\n    api: (method, path, statusCode, duration, requestId)=>logger.apiRequest(method, path, statusCode, duration, requestId),\n    security: (event, details, requestId)=>logger.security(event, details, requestId),\n    business: (event, details, requestId)=>logger.business(event, details, requestId)\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFFeER3QixVQUFVLENBQUNDLE9BQWVDLFNBQWtDMUIsWUFDMUQ0QyxPQUFPcEIsUUFBUSxDQUFDQyxPQUFPQyxTQUFTMUI7SUFFbEMyQixVQUFVLENBQUNGLE9BQWVDLFNBQWtDMUIsWUFDMUQ0QyxPQUFPakIsUUFBUSxDQUFDRixPQUFPQyxTQUFTMUI7QUFDcEMsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL3Rva3lvLW9wZW5kYXRhLWhhY2thdGhvbi8uL3NyYy9saWIvbG9nZ2VyLnRzP2I0OWUiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gRW5oYW5jZWQgbG9nZ2luZyBzeXN0ZW0gd2l0aCBtdWx0aXBsZSBsZXZlbHMgYW5kIHN0cnVjdHVyZWQgbG9nZ2luZ1xuXG5leHBvcnQgZW51bSBMb2dMZXZlbCB7XG4gIERFQlVHID0gMCxcbiAgSU5GTyA9IDEsXG4gIFdBUk4gPSAyLFxuICBFUlJPUiA9IDMsXG4gIEZBVEFMID0gNCxcbn1cblxuZXhwb3J0IGludGVyZmFjZSBMb2dFbnRyeSB7XG4gIGxldmVsOiBMb2dMZXZlbDtcbiAgbWVzc2FnZTogc3RyaW5nO1xuICB0aW1lc3RhbXA6IERhdGU7XG4gIGNvbnRleHQ/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcbiAgZXJyb3I/OiBFcnJvcjtcbiAgcmVxdWVzdElkPzogc3RyaW5nO1xuICB1c2VySWQ/OiBzdHJpbmc7XG4gIHBlcmZvcm1hbmNlPzoge1xuICAgIGR1cmF0aW9uPzogbnVtYmVyO1xuICAgIG1lbW9yeT86IE5vZGVKUy5NZW1vcnlVc2FnZTtcbiAgfTtcbn1cblxuY2xhc3MgTG9nZ2VyIHtcbiAgcHJpdmF0ZSBtaW5MZXZlbDogTG9nTGV2ZWw7XG4gIHByaXZhdGUgbG9nczogTG9nRW50cnlbXSA9IFtdO1xuICBwcml2YXRlIG1heExvZ0hpc3Rvcnk6IG51bWJlciA9IDEwMDA7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5taW5MZXZlbCA9IHRoaXMuZ2V0TG9nTGV2ZWwoKTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0TG9nTGV2ZWwoKTogTG9nTGV2ZWwge1xuICAgIGNvbnN0IGxldmVsID0gcHJvY2Vzcy5lbnYuTE9HX0xFVkVMPy50b1VwcGVyQ2FzZSgpIHx8ICdJTkZPJztcbiAgICBzd2l0Y2ggKGxldmVsKSB7XG4gICAgICBjYXNlICdERUJVRyc6IHJldHVybiBMb2dMZXZlbC5ERUJVRztcbiAgICAgIGNhc2UgJ0lORk8nOiByZXR1cm4gTG9nTGV2ZWwuSU5GTztcbiAgICAgIGNhc2UgJ1dBUk4nOiByZXR1cm4gTG9nTGV2ZWwuV0FSTjtcbiAgICAgIGNhc2UgJ0VSUk9SJzogcmV0dXJuIExvZ0xldmVsLkVSUk9SO1xuICAgICAgY2FzZSAnRkFUQUwnOiByZXR1cm4gTG9nTGV2ZWwuRkFUQUw7XG4gICAgICBkZWZhdWx0OiByZXR1cm4gTG9nTGV2ZWwuSU5GTztcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHNob3VsZExvZyhsZXZlbDogTG9nTGV2ZWwpOiBib29sZWFuIHtcbiAgICByZXR1cm4gbGV2ZWwgPj0gdGhpcy5taW5MZXZlbDtcbiAgfVxuXG4gIHByaXZhdGUgZm9ybWF0TWVzc2FnZShlbnRyeTogTG9nRW50cnkpOiBzdHJpbmcge1xuICAgIGNvbnN0IHRpbWVzdGFtcCA9IGVudHJ5LnRpbWVzdGFtcC50b0lTT1N0cmluZygpO1xuICAgIGNvbnN0IGxldmVsID0gTG9nTGV2ZWxbZW50cnkubGV2ZWxdLnBhZEVuZCg1KTtcbiAgICBjb25zdCBjb250ZXh0ID0gZW50cnkuY29udGV4dCA/IGAgfCBDb250ZXh0OiAke0pTT04uc3RyaW5naWZ5KGVudHJ5LmNvbnRleHQpfWAgOiAnJztcbiAgICBjb25zdCByZXF1ZXN0SWQgPSBlbnRyeS5yZXF1ZXN0SWQgPyBgIHwgUmVxdWVzdElEOiAke2VudHJ5LnJlcXVlc3RJZH1gIDogJyc7XG4gICAgY29uc3QgcGVyZm9ybWFuY2UgPSBlbnRyeS5wZXJmb3JtYW5jZT8uZHVyYXRpb24gXG4gICAgICA/IGAgfCBEdXJhdGlvbjogJHtlbnRyeS5wZXJmb3JtYW5jZS5kdXJhdGlvbn1tc2AgXG4gICAgICA6ICcnO1xuICAgIFxuICAgIHJldHVybiBgWyR7dGltZXN0YW1wfV0gJHtsZXZlbH0gfCAke2VudHJ5Lm1lc3NhZ2V9JHtjb250ZXh0fSR7cmVxdWVzdElkfSR7cGVyZm9ybWFuY2V9YDtcbiAgfVxuXG4gIHByaXZhdGUgd3JpdGVMb2coZW50cnk6IExvZ0VudHJ5KTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLnNob3VsZExvZyhlbnRyeS5sZXZlbCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBmb3JtYXR0ZWRNZXNzYWdlID0gdGhpcy5mb3JtYXRNZXNzYWdlKGVudHJ5KTtcblxuICAgIC8vIENvbnNvbGUgb3V0cHV0XG4gICAgc3dpdGNoIChlbnRyeS5sZXZlbCkge1xuICAgICAgY2FzZSBMb2dMZXZlbC5ERUJVRzpcbiAgICAgICAgY29uc29sZS5kZWJ1Zyhmb3JtYXR0ZWRNZXNzYWdlKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIExvZ0xldmVsLklORk86XG4gICAgICAgIGNvbnNvbGUuaW5mbyhmb3JtYXR0ZWRNZXNzYWdlKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIExvZ0xldmVsLldBUk46XG4gICAgICAgIGNvbnNvbGUud2Fybihmb3JtYXR0ZWRNZXNzYWdlKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIExvZ0xldmVsLkVSUk9SOlxuICAgICAgY2FzZSBMb2dMZXZlbC5GQVRBTDpcbiAgICAgICAgY29uc29sZS5lcnJvcihmb3JtYXR0ZWRNZXNzYWdlKTtcbiAgICAgICAgaWYgKGVudHJ5LmVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignU3RhY2sgdHJhY2U6JywgZW50cnkuZXJyb3Iuc3RhY2spO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIC8vIFN0b3JlIGluIG1lbW9yeSAoZm9yIGRlYnVnZ2luZyBhbmQgbW9uaXRvcmluZylcbiAgICB0aGlzLmxvZ3MucHVzaChlbnRyeSk7XG4gICAgaWYgKHRoaXMubG9ncy5sZW5ndGggPiB0aGlzLm1heExvZ0hpc3RvcnkpIHtcbiAgICAgIHRoaXMubG9ncyA9IHRoaXMubG9ncy5zbGljZSgtdGhpcy5tYXhMb2dIaXN0b3J5KTtcbiAgICB9XG4gIH1cblxuICBkZWJ1ZyhtZXNzYWdlOiBzdHJpbmcsIGNvbnRleHQ/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiwgcmVxdWVzdElkPzogc3RyaW5nKTogdm9pZCB7XG4gICAgdGhpcy53cml0ZUxvZyh7XG4gICAgICBsZXZlbDogTG9nTGV2ZWwuREVCVUcsXG4gICAgICBtZXNzYWdlLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgY29udGV4dCxcbiAgICAgIHJlcXVlc3RJZCxcbiAgICB9KTtcbiAgfVxuXG4gIGluZm8obWVzc2FnZTogc3RyaW5nLCBjb250ZXh0PzogUmVjb3JkPHN0cmluZywgdW5rbm93bj4sIHJlcXVlc3RJZD86IHN0cmluZyk6IHZvaWQge1xuICAgIHRoaXMud3JpdGVMb2coe1xuICAgICAgbGV2ZWw6IExvZ0xldmVsLklORk8sXG4gICAgICBtZXNzYWdlLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgY29udGV4dCxcbiAgICAgIHJlcXVlc3RJZCxcbiAgICB9KTtcbiAgfVxuXG4gIHdhcm4obWVzc2FnZTogc3RyaW5nLCBjb250ZXh0PzogUmVjb3JkPHN0cmluZywgdW5rbm93bj4sIHJlcXVlc3RJZD86IHN0cmluZyk6IHZvaWQge1xuICAgIHRoaXMud3JpdGVMb2coe1xuICAgICAgbGV2ZWw6IExvZ0xldmVsLldBUk4sXG4gICAgICBtZXNzYWdlLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgY29udGV4dCxcbiAgICAgIHJlcXVlc3RJZCxcbiAgICB9KTtcbiAgfVxuXG4gIGVycm9yKG1lc3NhZ2U6IHN0cmluZywgZXJyb3I/OiBFcnJvciwgY29udGV4dD86IFJlY29yZDxzdHJpbmcsIHVua25vd24+LCByZXF1ZXN0SWQ/OiBzdHJpbmcpOiB2b2lkIHtcbiAgICB0aGlzLndyaXRlTG9nKHtcbiAgICAgIGxldmVsOiBMb2dMZXZlbC5FUlJPUixcbiAgICAgIG1lc3NhZ2UsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICBlcnJvcixcbiAgICAgIGNvbnRleHQsXG4gICAgICByZXF1ZXN0SWQsXG4gICAgfSk7XG4gIH1cblxuICBmYXRhbChtZXNzYWdlOiBzdHJpbmcsIGVycm9yPzogRXJyb3IsIGNvbnRleHQ/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiwgcmVxdWVzdElkPzogc3RyaW5nKTogdm9pZCB7XG4gICAgdGhpcy53cml0ZUxvZyh7XG4gICAgICBsZXZlbDogTG9nTGV2ZWwuRkFUQUwsXG4gICAgICBtZXNzYWdlLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgZXJyb3IsXG4gICAgICBjb250ZXh0LFxuICAgICAgcmVxdWVzdElkLFxuICAgIH0pO1xuICB9XG5cbiAgLy8gUGVyZm9ybWFuY2UgbG9nZ2luZ1xuICBwZXJmb3JtYW5jZShtZXNzYWdlOiBzdHJpbmcsIGR1cmF0aW9uOiBudW1iZXIsIGNvbnRleHQ/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiwgcmVxdWVzdElkPzogc3RyaW5nKTogdm9pZCB7XG4gICAgdGhpcy53cml0ZUxvZyh7XG4gICAgICBsZXZlbDogTG9nTGV2ZWwuSU5GTyxcbiAgICAgIG1lc3NhZ2UsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICBjb250ZXh0LFxuICAgICAgcmVxdWVzdElkLFxuICAgICAgcGVyZm9ybWFuY2U6IHtcbiAgICAgICAgZHVyYXRpb24sXG4gICAgICAgIG1lbW9yeTogcHJvY2Vzcy5tZW1vcnlVc2FnZSgpLFxuICAgICAgfSxcbiAgICB9KTtcbiAgfVxuXG4gIC8vIEFQSSByZXF1ZXN0IGxvZ2dpbmdcbiAgYXBpUmVxdWVzdChtZXRob2Q6IHN0cmluZywgcGF0aDogc3RyaW5nLCBzdGF0dXNDb2RlOiBudW1iZXIsIGR1cmF0aW9uOiBudW1iZXIsIHJlcXVlc3RJZD86IHN0cmluZyk6IHZvaWQge1xuICAgIGNvbnN0IGxldmVsID0gc3RhdHVzQ29kZSA+PSA0MDAgPyBMb2dMZXZlbC5FUlJPUiA6IExvZ0xldmVsLklORk87XG4gICAgdGhpcy53cml0ZUxvZyh7XG4gICAgICBsZXZlbCxcbiAgICAgIG1lc3NhZ2U6IGBBUEkgJHttZXRob2R9ICR7cGF0aH0gLSAke3N0YXR1c0NvZGV9YCxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgIGNvbnRleHQ6IHtcbiAgICAgICAgbWV0aG9kLFxuICAgICAgICBwYXRoLFxuICAgICAgICBzdGF0dXNDb2RlLFxuICAgICAgICB0eXBlOiAnYXBpX3JlcXVlc3QnLFxuICAgICAgfSxcbiAgICAgIHJlcXVlc3RJZCxcbiAgICAgIHBlcmZvcm1hbmNlOiB7XG4gICAgICAgIGR1cmF0aW9uLFxuICAgICAgfSxcbiAgICB9KTtcbiAgfVxuXG4gIC8vIFNlY3VyaXR5IGxvZ2dpbmdcbiAgc2VjdXJpdHkoZXZlbnQ6IHN0cmluZywgZGV0YWlsczogUmVjb3JkPHN0cmluZywgdW5rbm93bj4sIHJlcXVlc3RJZD86IHN0cmluZyk6IHZvaWQge1xuICAgIHRoaXMud3JpdGVMb2coe1xuICAgICAgbGV2ZWw6IExvZ0xldmVsLldBUk4sXG4gICAgICBtZXNzYWdlOiBgU2VjdXJpdHkgRXZlbnQ6ICR7ZXZlbnR9YCxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgIGNvbnRleHQ6IHtcbiAgICAgICAgLi4uZGV0YWlscyxcbiAgICAgICAgdHlwZTogJ3NlY3VyaXR5X2V2ZW50JyxcbiAgICAgIH0sXG4gICAgICByZXF1ZXN0SWQsXG4gICAgfSk7XG4gIH1cblxuICAvLyBCdXNpbmVzcyBsb2dpYyBsb2dnaW5nXG4gIGJ1c2luZXNzKGV2ZW50OiBzdHJpbmcsIGRldGFpbHM6IFJlY29yZDxzdHJpbmcsIHVua25vd24+LCByZXF1ZXN0SWQ/OiBzdHJpbmcpOiB2b2lkIHtcbiAgICB0aGlzLndyaXRlTG9nKHtcbiAgICAgIGxldmVsOiBMb2dMZXZlbC5JTkZPLFxuICAgICAgbWVzc2FnZTogYEJ1c2luZXNzIEV2ZW50OiAke2V2ZW50fWAsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICBjb250ZXh0OiB7XG4gICAgICAgIC4uLmRldGFpbHMsXG4gICAgICAgIHR5cGU6ICdidXNpbmVzc19ldmVudCcsXG4gICAgICB9LFxuICAgICAgcmVxdWVzdElkLFxuICAgIH0pO1xuICB9XG5cbiAgLy8gR2V0IHJlY2VudCBsb2dzIGZvciBkZWJ1Z2dpbmdcbiAgZ2V0UmVjZW50TG9ncyhjb3VudDogbnVtYmVyID0gMTAwKTogTG9nRW50cnlbXSB7XG4gICAgcmV0dXJuIHRoaXMubG9ncy5zbGljZSgtY291bnQpO1xuICB9XG5cbiAgLy8gR2V0IGxvZ3MgYnkgbGV2ZWxcbiAgZ2V0TG9nc0J5TGV2ZWwobGV2ZWw6IExvZ0xldmVsLCBjb3VudDogbnVtYmVyID0gMTAwKTogTG9nRW50cnlbXSB7XG4gICAgcmV0dXJuIHRoaXMubG9nc1xuICAgICAgLmZpbHRlcihsb2cgPT4gbG9nLmxldmVsID09PSBsZXZlbClcbiAgICAgIC5zbGljZSgtY291bnQpO1xuICB9XG5cbiAgLy8gR2V0IGxvZ3MgYnkgdGltZSByYW5nZVxuICBnZXRMb2dzQnlUaW1lUmFuZ2UoZnJvbTogRGF0ZSwgdG86IERhdGUpOiBMb2dFbnRyeVtdIHtcbiAgICByZXR1cm4gdGhpcy5sb2dzLmZpbHRlcihsb2cgPT4gXG4gICAgICBsb2cudGltZXN0YW1wID49IGZyb20gJiYgbG9nLnRpbWVzdGFtcCA8PSB0b1xuICAgICk7XG4gIH1cblxuICAvLyBDbGVhciBsb2dzXG4gIGNsZWFyTG9ncygpOiB2b2lkIHtcbiAgICB0aGlzLmxvZ3MgPSBbXTtcbiAgICB0aGlzLmluZm8oJ0xvZyBoaXN0b3J5IGNsZWFyZWQnKTtcbiAgfVxuXG4gIC8vIEdldCBzdGF0aXN0aWNzXG4gIGdldFN0YXRzKCk6IHtcbiAgICB0b3RhbExvZ3M6IG51bWJlcjtcbiAgICBsb2dDb3VudHM6IFJlY29yZDxzdHJpbmcsIG51bWJlcj47XG4gICAgb2xkZXN0TG9nPzogRGF0ZTtcbiAgICBuZXdlc3RMb2c/OiBEYXRlO1xuICB9IHtcbiAgICBjb25zdCBsb2dDb3VudHM6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7fTtcbiAgICBcbiAgICBmb3IgKGNvbnN0IGxvZyBvZiB0aGlzLmxvZ3MpIHtcbiAgICAgIGNvbnN0IGxldmVsTmFtZSA9IExvZ0xldmVsW2xvZy5sZXZlbF07XG4gICAgICBsb2dDb3VudHNbbGV2ZWxOYW1lXSA9IChsb2dDb3VudHNbbGV2ZWxOYW1lXSB8fCAwKSArIDE7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHRvdGFsTG9nczogdGhpcy5sb2dzLmxlbmd0aCxcbiAgICAgIGxvZ0NvdW50cyxcbiAgICAgIG9sZGVzdExvZzogdGhpcy5sb2dzLmxlbmd0aCA+IDAgPyB0aGlzLmxvZ3NbMF0udGltZXN0YW1wIDogdW5kZWZpbmVkLFxuICAgICAgbmV3ZXN0TG9nOiB0aGlzLmxvZ3MubGVuZ3RoID4gMCA/IHRoaXMubG9nc1t0aGlzLmxvZ3MubGVuZ3RoIC0gMV0udGltZXN0YW1wIDogdW5kZWZpbmVkLFxuICAgIH07XG4gIH1cbn1cblxuLy8gQ3JlYXRlIHNpbmdsZXRvbiBsb2dnZXIgaW5zdGFuY2VcbmNvbnN0IGxvZ2dlciA9IG5ldyBMb2dnZXIoKTtcblxuLy8gUGVyZm9ybWFuY2UgbWVhc3VyZW1lbnQgdXRpbGl0eVxuZXhwb3J0IGNsYXNzIFBlcmZvcm1hbmNlVGltZXIge1xuICBwcml2YXRlIHN0YXJ0VGltZTogbnVtYmVyO1xuICBwcml2YXRlIG5hbWU6IHN0cmluZztcbiAgcHJpdmF0ZSByZXF1ZXN0SWQ/OiBzdHJpbmc7XG5cbiAgY29uc3RydWN0b3IobmFtZTogc3RyaW5nLCByZXF1ZXN0SWQ/OiBzdHJpbmcpIHtcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgIHRoaXMucmVxdWVzdElkID0gcmVxdWVzdElkO1xuICAgIHRoaXMuc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgfVxuXG4gIGVuZChjb250ZXh0PzogUmVjb3JkPHN0cmluZywgdW5rbm93bj4pOiBudW1iZXIge1xuICAgIGNvbnN0IGR1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHRoaXMuc3RhcnRUaW1lO1xuICAgIGxvZ2dlci5wZXJmb3JtYW5jZShgJHt0aGlzLm5hbWV9IGNvbXBsZXRlZGAsIGR1cmF0aW9uLCBjb250ZXh0LCB0aGlzLnJlcXVlc3RJZCk7XG4gICAgcmV0dXJuIGR1cmF0aW9uO1xuICB9XG59XG5cbi8vIFJlcXVlc3QgSUQgZ2VuZXJhdG9yXG5leHBvcnQgY29uc3QgZ2VuZXJhdGVSZXF1ZXN0SWQgPSAoKTogc3RyaW5nID0+IHtcbiAgcmV0dXJuIGByZXFfJHtEYXRlLm5vdygpfV8ke01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA5KX1gO1xufTtcblxuLy8gRXhwb3J0IHNpbmdsZXRvbiBsb2dnZXJcbmV4cG9ydCB7IGxvZ2dlciB9O1xuXG4vLyBDb252ZW5pZW5jZSBmdW5jdGlvbnNcbmV4cG9ydCBjb25zdCBsb2cgPSB7XG4gIGRlYnVnOiAobWVzc2FnZTogc3RyaW5nLCBjb250ZXh0PzogUmVjb3JkPHN0cmluZywgdW5rbm93bj4sIHJlcXVlc3RJZD86IHN0cmluZykgPT4gXG4gICAgbG9nZ2VyLmRlYnVnKG1lc3NhZ2UsIGNvbnRleHQsIHJlcXVlc3RJZCksXG4gIFxuICBpbmZvOiAobWVzc2FnZTogc3RyaW5nLCBjb250ZXh0PzogUmVjb3JkPHN0cmluZywgdW5rbm93bj4sIHJlcXVlc3RJZD86IHN0cmluZykgPT4gXG4gICAgbG9nZ2VyLmluZm8obWVzc2FnZSwgY29udGV4dCwgcmVxdWVzdElkKSxcbiAgXG4gIHdhcm46IChtZXNzYWdlOiBzdHJpbmcsIGNvbnRleHQ/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiwgcmVxdWVzdElkPzogc3RyaW5nKSA9PiBcbiAgICBsb2dnZXIud2FybihtZXNzYWdlLCBjb250ZXh0LCByZXF1ZXN0SWQpLFxuICBcbiAgZXJyb3I6IChtZXNzYWdlOiBzdHJpbmcsIGVycm9yPzogRXJyb3IsIGNvbnRleHQ/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiwgcmVxdWVzdElkPzogc3RyaW5nKSA9PiBcbiAgICBsb2dnZXIuZXJyb3IobWVzc2FnZSwgZXJyb3IsIGNvbnRleHQsIHJlcXVlc3RJZCksXG4gIFxuICBmYXRhbDogKG1lc3NhZ2U6IHN0cmluZywgZXJyb3I/OiBFcnJvciwgY29udGV4dD86IFJlY29yZDxzdHJpbmcsIHVua25vd24+LCByZXF1ZXN0SWQ/OiBzdHJpbmcpID0+IFxuICAgIGxvZ2dlci5mYXRhbChtZXNzYWdlLCBlcnJvciwgY29udGV4dCwgcmVxdWVzdElkKSxcbiAgXG4gIHBlcmZvcm1hbmNlOiAobmFtZTogc3RyaW5nLCByZXF1ZXN0SWQ/OiBzdHJpbmcpID0+IFxuICAgIG5ldyBQZXJmb3JtYW5jZVRpbWVyKG5hbWUsIHJlcXVlc3RJZCksXG4gIFxuICBhcGk6IChtZXRob2Q6IHN0cmluZywgcGF0aDogc3RyaW5nLCBzdGF0dXNDb2RlOiBudW1iZXIsIGR1cmF0aW9uOiBudW1iZXIsIHJlcXVlc3RJZD86IHN0cmluZykgPT4gXG4gICAgbG9nZ2VyLmFwaVJlcXVlc3QobWV0aG9kLCBwYXRoLCBzdGF0dXNDb2RlLCBkdXJhdGlvbiwgcmVxdWVzdElkKSxcbiAgXG4gIHNlY3VyaXR5OiAoZXZlbnQ6IHN0cmluZywgZGV0YWlsczogUmVjb3JkPHN0cmluZywgdW5rbm93bj4sIHJlcXVlc3RJZD86IHN0cmluZykgPT4gXG4gICAgbG9nZ2VyLnNlY3VyaXR5KGV2ZW50LCBkZXRhaWxzLCByZXF1ZXN0SWQpLFxuICBcbiAgYnVzaW5lc3M6IChldmVudDogc3RyaW5nLCBkZXRhaWxzOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiwgcmVxdWVzdElkPzogc3RyaW5nKSA9PiBcbiAgICBsb2dnZXIuYnVzaW5lc3MoZXZlbnQsIGRldGFpbHMsIHJlcXVlc3RJZCksXG59OyJdLCJuYW1lcyI6WyJMb2dMZXZlbCIsIkxvZ2dlciIsImNvbnN0cnVjdG9yIiwibG9ncyIsIm1heExvZ0hpc3RvcnkiLCJtaW5MZXZlbCIsImdldExvZ0xldmVsIiwibGV2ZWwiLCJwcm9jZXNzIiwiZW52IiwiTE9HX0xFVkVMIiwidG9VcHBlckNhc2UiLCJzaG91bGRMb2ciLCJmb3JtYXRNZXNzYWdlIiwiZW50cnkiLCJ0aW1lc3RhbXAiLCJ0b0lTT1N0cmluZyIsInBhZEVuZCIsImNvbnRleHQiLCJKU09OIiwic3RyaW5naWZ5IiwicmVxdWVzdElkIiwicGVyZm9ybWFuY2UiLCJkdXJhdGlvbiIsIm1lc3NhZ2UiLCJ3cml0ZUxvZyIsImZvcm1hdHRlZE1lc3NhZ2UiLCJjb25zb2xlIiwiZGVidWciLCJpbmZvIiwid2FybiIsImVycm9yIiwic3RhY2siLCJwdXNoIiwibGVuZ3RoIiwic2xpY2UiLCJEYXRlIiwiZmF0YWwiLCJtZW1vcnkiLCJtZW1vcnlVc2FnZSIsImFwaVJlcXVlc3QiLCJtZXRob2QiLCJwYXRoIiwic3RhdHVzQ29kZSIsInR5cGUiLCJzZWN1cml0eSIsImV2ZW50IiwiZGV0YWlscyIsImJ1c2luZXNzIiwiZ2V0UmVjZW50TG9ncyIsImNvdW50IiwiZ2V0TG9nc0J5TGV2ZWwiLCJmaWx0ZXIiLCJsb2ciLCJnZXRMb2dzQnlUaW1lUmFuZ2UiLCJmcm9tIiwidG8iLCJjbGVhckxvZ3MiLCJnZXRTdGF0cyIsImxvZ0NvdW50cyIsImxldmVsTmFtZSIsInRvdGFsTG9ncyIsIm9sZGVzdExvZyIsInVuZGVmaW5lZCIsIm5ld2VzdExvZyIsImxvZ2dlciIsIlBlcmZvcm1hbmNlVGltZXIiLCJuYW1lIiwic3RhcnRUaW1lIiwibm93IiwiZW5kIiwiZ2VuZXJhdGVSZXF1ZXN0SWQiLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJzdWJzdHIiLCJhcGkiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/logger.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/services/RedisService.ts":
/*!******************************************!*\
  !*** ./src/lib/services/RedisService.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   RedisService: () => (/* binding */ RedisService),\n/* harmony export */   getRedisService: () => (/* binding */ getRedisService)\n/* harmony export */ });\n/* harmony import */ var redis__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! redis */ \"(rsc)/./node_modules/redis/dist/index.js\");\n/* harmony import */ var redis__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(redis__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/config */ \"(rsc)/./src/lib/config.ts\");\n/* harmony import */ var _lib_logger__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/logger */ \"(rsc)/./src/lib/logger.ts\");\n\n\n\nclass RedisService {\n    constructor(){\n        this.client = null;\n        this.isConnected = false;\n        this.reconnectAttempts = 0;\n        this.maxReconnectAttempts = 5;\n        // Check if Redis is explicitly disabled\n        if (process.env.DISABLE_REDIS === \"true\") {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.log.info(\"Redis explicitly disabled via DISABLE_REDIS environment variable\");\n            return;\n        }\n        // Only initialize Redis if configured or in production\n        if (_lib_config__WEBPACK_IMPORTED_MODULE_1__.config.redisUrl || !(0,_lib_config__WEBPACK_IMPORTED_MODULE_1__.isDevelopment)()) {\n            this.initializeClient();\n        } else {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.log.info(\"Redis URL not configured in development, using memory storage only\");\n        }\n    }\n    async initializeClient() {\n        try {\n            // Skip initialization if in development and no Redis URL provided\n            if (!_lib_config__WEBPACK_IMPORTED_MODULE_1__.config.redisUrl && (0,_lib_config__WEBPACK_IMPORTED_MODULE_1__.isDevelopment)()) {\n                _lib_logger__WEBPACK_IMPORTED_MODULE_2__.log.info(\"Development mode: Redis URL not configured, skipping Redis initialization\");\n                return;\n            }\n            if (!_lib_config__WEBPACK_IMPORTED_MODULE_1__.config.redisUrl && !(0,_lib_config__WEBPACK_IMPORTED_MODULE_1__.isDevelopment)()) {\n                _lib_logger__WEBPACK_IMPORTED_MODULE_2__.log.warn(\"Production mode: Redis URL not configured, falling back to memory storage\");\n                return;\n            }\n            // Redis client configuration\n            const clientOptions = _lib_config__WEBPACK_IMPORTED_MODULE_1__.config.redisUrl ? {\n                url: _lib_config__WEBPACK_IMPORTED_MODULE_1__.config.redisUrl,\n                socket: {\n                    connectTimeout: 10000,\n                    lazyConnect: true,\n                    reconnectStrategy: (retries)=>{\n                        if (retries >= this.maxReconnectAttempts) {\n                            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.log.error(\"Redis max reconnection attempts reached\");\n                            return false;\n                        }\n                        const delay = Math.min(retries * 50, 500);\n                        _lib_logger__WEBPACK_IMPORTED_MODULE_2__.log.warn(`Redis reconnecting in ${delay}ms (attempt ${retries + 1})`);\n                        return delay;\n                    }\n                }\n            } : {\n                // Local development fallback\n                socket: {\n                    host: \"localhost\",\n                    port: 6379,\n                    connectTimeout: 5000,\n                    lazyConnect: true\n                }\n            };\n            this.client = (0,redis__WEBPACK_IMPORTED_MODULE_0__.createClient)(clientOptions);\n            // Error handling\n            this.client.on(\"error\", (err)=>{\n                _lib_logger__WEBPACK_IMPORTED_MODULE_2__.log.error(\"Redis client error\", err);\n                this.isConnected = false;\n            });\n            this.client.on(\"connect\", ()=>{\n                _lib_logger__WEBPACK_IMPORTED_MODULE_2__.log.info(\"Redis client connected\");\n                this.isConnected = true;\n                this.reconnectAttempts = 0;\n            });\n            this.client.on(\"disconnect\", ()=>{\n                _lib_logger__WEBPACK_IMPORTED_MODULE_2__.log.warn(\"Redis client disconnected\");\n                this.isConnected = false;\n            });\n            this.client.on(\"reconnecting\", ()=>{\n                this.reconnectAttempts++;\n                _lib_logger__WEBPACK_IMPORTED_MODULE_2__.log.info(`Redis client reconnecting (attempt ${this.reconnectAttempts})`);\n            });\n            // Connect to Redis\n            await this.client.connect();\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.log.error(\"Failed to initialize Redis client\", error);\n            this.client = null;\n            this.isConnected = false;\n        }\n    }\n    getKey(prefix, id) {\n        return `tokyo-ai:${prefix}:${id}`;\n    }\n    async isReady() {\n        if (!this.client) return false;\n        try {\n            await this.client.ping();\n            return true;\n        } catch  {\n            return false;\n        }\n    }\n    // Session Management\n    async setSession(sessionId, sessionData, ttl = 3600) {\n        if (!this.client || !this.isConnected) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.log.warn(\"Redis not available for session storage\");\n            return false;\n        }\n        try {\n            const key = this.getKey(\"session\", sessionId);\n            const data = JSON.stringify({\n                ...sessionData,\n                updatedAt: new Date().toISOString()\n            });\n            await this.client.setEx(key, ttl, data);\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.log.debug(\"Session stored in Redis\", {\n                sessionId,\n                ttl\n            });\n            return true;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.log.error(\"Failed to store session in Redis\", error, {\n                sessionId\n            });\n            return false;\n        }\n    }\n    async getSession(sessionId) {\n        if (!this.client || !this.isConnected) {\n            return null;\n        }\n        try {\n            const key = this.getKey(\"session\", sessionId);\n            const data = await this.client.get(key);\n            if (!data) {\n                return null;\n            }\n            const sessionData = JSON.parse(data);\n            // Update last activity\n            sessionData.lastActivity = new Date();\n            await this.setSession(sessionId, sessionData);\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.log.debug(\"Session retrieved from Redis\", {\n                sessionId\n            });\n            return sessionData;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.log.error(\"Failed to retrieve session from Redis\", error, {\n                sessionId\n            });\n            return null;\n        }\n    }\n    async deleteSession(sessionId) {\n        if (!this.client || !this.isConnected) {\n            return false;\n        }\n        try {\n            const sessionKey = this.getKey(\"session\", sessionId);\n            const messagesKey = this.getKey(\"messages\", sessionId);\n            await Promise.all([\n                this.client.del(sessionKey),\n                this.client.del(messagesKey)\n            ]);\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.log.debug(\"Session deleted from Redis\", {\n                sessionId\n            });\n            return true;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.log.error(\"Failed to delete session from Redis\", error, {\n                sessionId\n            });\n            return false;\n        }\n    }\n    // Message Storage\n    async addMessage(sessionId, message) {\n        if (!this.client || !this.isConnected) {\n            return false;\n        }\n        try {\n            const key = this.getKey(\"messages\", sessionId);\n            const messageData = JSON.stringify(message);\n            // Add to list and set expiration\n            await this.client.rPush(key, messageData);\n            await this.client.expire(key, 86400); // 24 hours\n            // Keep only last 100 messages\n            await this.client.lTrim(key, -100, -1);\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.log.debug(\"Message added to Redis\", {\n                sessionId,\n                messageId: message.id\n            });\n            return true;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.log.error(\"Failed to add message to Redis\", error, {\n                sessionId\n            });\n            return false;\n        }\n    }\n    async getMessages(sessionId, limit = 50) {\n        if (!this.client || !this.isConnected) {\n            return [];\n        }\n        try {\n            const key = this.getKey(\"messages\", sessionId);\n            const messages = await this.client.lRange(key, -limit, -1);\n            return messages.map((data)=>JSON.parse(data));\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.log.error(\"Failed to retrieve messages from Redis\", error, {\n                sessionId\n            });\n            return [];\n        }\n    }\n    // Cache Management\n    async setCache(key, value, ttl = 300) {\n        if (!this.client || !this.isConnected) {\n            return false;\n        }\n        try {\n            const cacheKey = this.getKey(\"cache\", key);\n            const data = JSON.stringify({\n                value,\n                timestamp: new Date().toISOString()\n            });\n            await this.client.setEx(cacheKey, ttl, data);\n            return true;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.log.error(\"Failed to set cache in Redis\", error, {\n                key\n            });\n            return false;\n        }\n    }\n    async getCache(key) {\n        if (!this.client || !this.isConnected) {\n            return null;\n        }\n        try {\n            const cacheKey = this.getKey(\"cache\", key);\n            const data = await this.client.get(cacheKey);\n            if (!data) {\n                return null;\n            }\n            const cached = JSON.parse(data);\n            return cached.value;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.log.error(\"Failed to get cache from Redis\", error, {\n                key\n            });\n            return null;\n        }\n    }\n    async deleteCache(key) {\n        if (!this.client || !this.isConnected) {\n            return false;\n        }\n        try {\n            const cacheKey = this.getKey(\"cache\", key);\n            await this.client.del(cacheKey);\n            return true;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.log.error(\"Failed to delete cache from Redis\", error, {\n                key\n            });\n            return false;\n        }\n    }\n    // Rate Limiting\n    async checkRateLimit(identifier, windowSeconds, maxRequests) {\n        if (!this.client || !this.isConnected) {\n            // Fallback to allowing request if Redis is not available\n            return {\n                allowed: true,\n                remaining: maxRequests - 1,\n                resetTime: Date.now() + windowSeconds * 1000\n            };\n        }\n        try {\n            const key = this.getKey(\"ratelimit\", identifier);\n            const now = Date.now();\n            const windowStart = now - windowSeconds * 1000;\n            // Remove old entries and count current requests\n            await this.client.zRemRangeByScore(key, 0, windowStart);\n            const currentCount = await this.client.zCard(key);\n            if (currentCount >= maxRequests) {\n                const oldestEntry = await this.client.zRangeWithScores(key, 0, 0);\n                const resetTime = oldestEntry.length > 0 ? Number(oldestEntry[0].score) + windowSeconds * 1000 : now + windowSeconds * 1000;\n                return {\n                    allowed: false,\n                    remaining: 0,\n                    resetTime\n                };\n            }\n            // Add current request\n            await this.client.zAdd(key, {\n                score: now,\n                value: `${now}-${Math.random()}`\n            });\n            await this.client.expire(key, windowSeconds);\n            return {\n                allowed: true,\n                remaining: maxRequests - currentCount - 1,\n                resetTime: now + windowSeconds * 1000\n            };\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.log.error(\"Rate limit check failed in Redis\", error, {\n                identifier\n            });\n            // Fallback to allowing request\n            return {\n                allowed: true,\n                remaining: maxRequests - 1,\n                resetTime: Date.now() + windowSeconds * 1000\n            };\n        }\n    }\n    // Statistics\n    async getStats() {\n        if (!this.client || !this.isConnected) {\n            return {\n                connected: false\n            };\n        }\n        try {\n            const info = await this.client.info();\n            const keyCount = await this.client.dbSize();\n            // Parse info for relevant stats\n            const memoryMatch = info.match(/used_memory_human:([^\\r\\n]+)/);\n            const clientsMatch = info.match(/connected_clients:(\\d+)/);\n            return {\n                connected: true,\n                memoryUsage: memoryMatch ? memoryMatch[1].trim() : \"unknown\",\n                connectedClients: clientsMatch ? parseInt(clientsMatch[1]) : 0,\n                totalKeys: keyCount\n            };\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_2__.log.error(\"Failed to get Redis stats\", error);\n            return {\n                connected: false\n            };\n        }\n    }\n    // Cleanup\n    async cleanup() {\n        if (this.client) {\n            try {\n                await this.client.quit();\n                _lib_logger__WEBPACK_IMPORTED_MODULE_2__.log.info(\"Redis client disconnected gracefully\");\n            } catch (error) {\n                _lib_logger__WEBPACK_IMPORTED_MODULE_2__.log.error(\"Error during Redis cleanup\", error);\n            }\n            this.client = null;\n            this.isConnected = false;\n        }\n    }\n    // Health check\n    async healthCheck() {\n        try {\n            if (!this.client || !this.isConnected) {\n                return false;\n            }\n            const pong = await this.client.ping();\n            return pong === \"PONG\";\n        } catch  {\n            return false;\n        }\n    }\n}\n// Singleton instance\nlet redisServiceInstance = null;\nconst getRedisService = ()=>{\n    if (!redisServiceInstance) {\n        redisServiceInstance = new RedisService();\n    }\n    return redisServiceInstance;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFNLElBQUksQ0FBQyxJQUFJLENBQUNDLFdBQVcsRUFBRTtnQkFDckMsT0FBTztZQUNUO1lBRUEsTUFBTTJHLE9BQU8sTUFBTSxJQUFJLENBQUM1RyxNQUFNLENBQUMrQixJQUFJO1lBQ25DLE9BQU82RSxTQUFTO1FBQ2xCLEVBQUUsT0FBTTtZQUNOLE9BQU87UUFDVDtJQUNGO0FBQ0Y7QUFFQSxxQkFBcUI7QUFDckIsSUFBSUMsdUJBQTRDO0FBRXpDLE1BQU1DLGtCQUFrQjtJQUM3QixJQUFJLENBQUNELHNCQUFzQjtRQUN6QkEsdUJBQXVCLElBQUkvRztJQUM3QjtJQUNBLE9BQU8rRztBQUNULEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90b2t5by1vcGVuZGF0YS1oYWNrYXRob24vLi9zcmMvbGliL3NlcnZpY2VzL1JlZGlzU2VydmljZS50cz82Yzc1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUNsaWVudCwgUmVkaXNDbGllbnRUeXBlIH0gZnJvbSAncmVkaXMnO1xuaW1wb3J0IHsgY29uZmlnLCBpc0RldmVsb3BtZW50IH0gZnJvbSAnQC9saWIvY29uZmlnJztcbmltcG9ydCB7IGxvZyB9IGZyb20gJ0AvbGliL2xvZ2dlcic7XG5pbXBvcnQgeyBTZXNzaW9uRGF0YSwgTWVzc2FnZSB9IGZyb20gJ0AvdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgUmVkaXNTZXJ2aWNlIHtcbiAgcHJpdmF0ZSBjbGllbnQ6IFJlZGlzQ2xpZW50VHlwZSB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIGlzQ29ubmVjdGVkOiBib29sZWFuID0gZmFsc2U7XG4gIHByaXZhdGUgcmVjb25uZWN0QXR0ZW1wdHM6IG51bWJlciA9IDA7XG4gIHByaXZhdGUgbWF4UmVjb25uZWN0QXR0ZW1wdHM6IG51bWJlciA9IDU7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgLy8gQ2hlY2sgaWYgUmVkaXMgaXMgZXhwbGljaXRseSBkaXNhYmxlZFxuICAgIGlmIChwcm9jZXNzLmVudi5ESVNBQkxFX1JFRElTID09PSAndHJ1ZScpIHtcbiAgICAgIGxvZy5pbmZvKCdSZWRpcyBleHBsaWNpdGx5IGRpc2FibGVkIHZpYSBESVNBQkxFX1JFRElTIGVudmlyb25tZW50IHZhcmlhYmxlJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gT25seSBpbml0aWFsaXplIFJlZGlzIGlmIGNvbmZpZ3VyZWQgb3IgaW4gcHJvZHVjdGlvblxuICAgIGlmIChjb25maWcucmVkaXNVcmwgfHwgIWlzRGV2ZWxvcG1lbnQoKSkge1xuICAgICAgdGhpcy5pbml0aWFsaXplQ2xpZW50KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxvZy5pbmZvKCdSZWRpcyBVUkwgbm90IGNvbmZpZ3VyZWQgaW4gZGV2ZWxvcG1lbnQsIHVzaW5nIG1lbW9yeSBzdG9yYWdlIG9ubHknKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGluaXRpYWxpemVDbGllbnQoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFNraXAgaW5pdGlhbGl6YXRpb24gaWYgaW4gZGV2ZWxvcG1lbnQgYW5kIG5vIFJlZGlzIFVSTCBwcm92aWRlZFxuICAgICAgaWYgKCFjb25maWcucmVkaXNVcmwgJiYgaXNEZXZlbG9wbWVudCgpKSB7XG4gICAgICAgIGxvZy5pbmZvKCdEZXZlbG9wbWVudCBtb2RlOiBSZWRpcyBVUkwgbm90IGNvbmZpZ3VyZWQsIHNraXBwaW5nIFJlZGlzIGluaXRpYWxpemF0aW9uJyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKCFjb25maWcucmVkaXNVcmwgJiYgIWlzRGV2ZWxvcG1lbnQoKSkge1xuICAgICAgICBsb2cud2FybignUHJvZHVjdGlvbiBtb2RlOiBSZWRpcyBVUkwgbm90IGNvbmZpZ3VyZWQsIGZhbGxpbmcgYmFjayB0byBtZW1vcnkgc3RvcmFnZScpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIFJlZGlzIGNsaWVudCBjb25maWd1cmF0aW9uXG4gICAgICBjb25zdCBjbGllbnRPcHRpb25zID0gY29uZmlnLnJlZGlzVXJsID8ge1xuICAgICAgICB1cmw6IGNvbmZpZy5yZWRpc1VybCxcbiAgICAgICAgc29ja2V0OiB7XG4gICAgICAgICAgY29ubmVjdFRpbWVvdXQ6IDEwMDAwLFxuICAgICAgICAgIGxhenlDb25uZWN0OiB0cnVlLFxuICAgICAgICAgIHJlY29ubmVjdFN0cmF0ZWd5OiAocmV0cmllczogbnVtYmVyKSA9PiB7XG4gICAgICAgICAgICBpZiAocmV0cmllcyA+PSB0aGlzLm1heFJlY29ubmVjdEF0dGVtcHRzKSB7XG4gICAgICAgICAgICAgIGxvZy5lcnJvcignUmVkaXMgbWF4IHJlY29ubmVjdGlvbiBhdHRlbXB0cyByZWFjaGVkJyk7XG4gICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGRlbGF5ID0gTWF0aC5taW4ocmV0cmllcyAqIDUwLCA1MDApO1xuICAgICAgICAgICAgbG9nLndhcm4oYFJlZGlzIHJlY29ubmVjdGluZyBpbiAke2RlbGF5fW1zIChhdHRlbXB0ICR7cmV0cmllcyArIDF9KWApO1xuICAgICAgICAgICAgcmV0dXJuIGRlbGF5O1xuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9IDoge1xuICAgICAgICAvLyBMb2NhbCBkZXZlbG9wbWVudCBmYWxsYmFja1xuICAgICAgICBzb2NrZXQ6IHtcbiAgICAgICAgICBob3N0OiAnbG9jYWxob3N0JyxcbiAgICAgICAgICBwb3J0OiA2Mzc5LFxuICAgICAgICAgIGNvbm5lY3RUaW1lb3V0OiA1MDAwLFxuICAgICAgICAgIGxhenlDb25uZWN0OiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgfTtcblxuICAgICAgdGhpcy5jbGllbnQgPSBjcmVhdGVDbGllbnQoY2xpZW50T3B0aW9ucyk7XG5cbiAgICAgIC8vIEVycm9yIGhhbmRsaW5nXG4gICAgICB0aGlzLmNsaWVudC5vbignZXJyb3InLCAoZXJyKSA9PiB7XG4gICAgICAgIGxvZy5lcnJvcignUmVkaXMgY2xpZW50IGVycm9yJywgZXJyKTtcbiAgICAgICAgdGhpcy5pc0Nvbm5lY3RlZCA9IGZhbHNlO1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuY2xpZW50Lm9uKCdjb25uZWN0JywgKCkgPT4ge1xuICAgICAgICBsb2cuaW5mbygnUmVkaXMgY2xpZW50IGNvbm5lY3RlZCcpO1xuICAgICAgICB0aGlzLmlzQ29ubmVjdGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5yZWNvbm5lY3RBdHRlbXB0cyA9IDA7XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5jbGllbnQub24oJ2Rpc2Nvbm5lY3QnLCAoKSA9PiB7XG4gICAgICAgIGxvZy53YXJuKCdSZWRpcyBjbGllbnQgZGlzY29ubmVjdGVkJyk7XG4gICAgICAgIHRoaXMuaXNDb25uZWN0ZWQgPSBmYWxzZTtcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLmNsaWVudC5vbigncmVjb25uZWN0aW5nJywgKCkgPT4ge1xuICAgICAgICB0aGlzLnJlY29ubmVjdEF0dGVtcHRzKys7XG4gICAgICAgIGxvZy5pbmZvKGBSZWRpcyBjbGllbnQgcmVjb25uZWN0aW5nIChhdHRlbXB0ICR7dGhpcy5yZWNvbm5lY3RBdHRlbXB0c30pYCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gQ29ubmVjdCB0byBSZWRpc1xuICAgICAgYXdhaXQgdGhpcy5jbGllbnQuY29ubmVjdCgpO1xuICAgICAgXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZy5lcnJvcignRmFpbGVkIHRvIGluaXRpYWxpemUgUmVkaXMgY2xpZW50JywgZXJyb3IgYXMgRXJyb3IpO1xuICAgICAgdGhpcy5jbGllbnQgPSBudWxsO1xuICAgICAgdGhpcy5pc0Nvbm5lY3RlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2V0S2V5KHByZWZpeDogc3RyaW5nLCBpZDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYHRva3lvLWFpOiR7cHJlZml4fToke2lkfWA7XG4gIH1cblxuICBhc3luYyBpc1JlYWR5KCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGlmICghdGhpcy5jbGllbnQpIHJldHVybiBmYWxzZTtcbiAgICBcbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5jbGllbnQucGluZygpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLy8gU2Vzc2lvbiBNYW5hZ2VtZW50XG4gIGFzeW5jIHNldFNlc3Npb24oc2Vzc2lvbklkOiBzdHJpbmcsIHNlc3Npb25EYXRhOiBTZXNzaW9uRGF0YSwgdHRsOiBudW1iZXIgPSAzNjAwKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgaWYgKCF0aGlzLmNsaWVudCB8fCAhdGhpcy5pc0Nvbm5lY3RlZCkge1xuICAgICAgbG9nLndhcm4oJ1JlZGlzIG5vdCBhdmFpbGFibGUgZm9yIHNlc3Npb24gc3RvcmFnZScpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBrZXkgPSB0aGlzLmdldEtleSgnc2Vzc2lvbicsIHNlc3Npb25JZCk7XG4gICAgICBjb25zdCBkYXRhID0gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAuLi5zZXNzaW9uRGF0YSxcbiAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgYXdhaXQgdGhpcy5jbGllbnQuc2V0RXgoa2V5LCB0dGwsIGRhdGEpO1xuICAgICAgXG4gICAgICBsb2cuZGVidWcoJ1Nlc3Npb24gc3RvcmVkIGluIFJlZGlzJywgeyBzZXNzaW9uSWQsIHR0bCB9KTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoJ0ZhaWxlZCB0byBzdG9yZSBzZXNzaW9uIGluIFJlZGlzJywgZXJyb3IgYXMgRXJyb3IsIHsgc2Vzc2lvbklkIH0pO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGdldFNlc3Npb24oc2Vzc2lvbklkOiBzdHJpbmcpOiBQcm9taXNlPFNlc3Npb25EYXRhIHwgbnVsbD4ge1xuICAgIGlmICghdGhpcy5jbGllbnQgfHwgIXRoaXMuaXNDb25uZWN0ZWQpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBrZXkgPSB0aGlzLmdldEtleSgnc2Vzc2lvbicsIHNlc3Npb25JZCk7XG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5jbGllbnQuZ2V0KGtleSk7XG4gICAgICBcbiAgICAgIGlmICghZGF0YSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cblxuICAgICAgY29uc3Qgc2Vzc2lvbkRhdGEgPSBKU09OLnBhcnNlKGRhdGEpIGFzIFNlc3Npb25EYXRhO1xuICAgICAgXG4gICAgICAvLyBVcGRhdGUgbGFzdCBhY3Rpdml0eVxuICAgICAgc2Vzc2lvbkRhdGEubGFzdEFjdGl2aXR5ID0gbmV3IERhdGUoKTtcbiAgICAgIGF3YWl0IHRoaXMuc2V0U2Vzc2lvbihzZXNzaW9uSWQsIHNlc3Npb25EYXRhKTtcbiAgICAgIFxuICAgICAgbG9nLmRlYnVnKCdTZXNzaW9uIHJldHJpZXZlZCBmcm9tIFJlZGlzJywgeyBzZXNzaW9uSWQgfSk7XG4gICAgICByZXR1cm4gc2Vzc2lvbkRhdGE7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZy5lcnJvcignRmFpbGVkIHRvIHJldHJpZXZlIHNlc3Npb24gZnJvbSBSZWRpcycsIGVycm9yIGFzIEVycm9yLCB7IHNlc3Npb25JZCB9KTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZVNlc3Npb24oc2Vzc2lvbklkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBpZiAoIXRoaXMuY2xpZW50IHx8ICF0aGlzLmlzQ29ubmVjdGVkKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHNlc3Npb25LZXkgPSB0aGlzLmdldEtleSgnc2Vzc2lvbicsIHNlc3Npb25JZCk7XG4gICAgICBjb25zdCBtZXNzYWdlc0tleSA9IHRoaXMuZ2V0S2V5KCdtZXNzYWdlcycsIHNlc3Npb25JZCk7XG4gICAgICBcbiAgICAgIGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgICAgdGhpcy5jbGllbnQuZGVsKHNlc3Npb25LZXkpLFxuICAgICAgICB0aGlzLmNsaWVudC5kZWwobWVzc2FnZXNLZXkpLFxuICAgICAgXSk7XG4gICAgICBcbiAgICAgIGxvZy5kZWJ1ZygnU2Vzc2lvbiBkZWxldGVkIGZyb20gUmVkaXMnLCB7IHNlc3Npb25JZCB9KTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoJ0ZhaWxlZCB0byBkZWxldGUgc2Vzc2lvbiBmcm9tIFJlZGlzJywgZXJyb3IgYXMgRXJyb3IsIHsgc2Vzc2lvbklkIH0pO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIC8vIE1lc3NhZ2UgU3RvcmFnZVxuICBhc3luYyBhZGRNZXNzYWdlKHNlc3Npb25JZDogc3RyaW5nLCBtZXNzYWdlOiBNZXNzYWdlKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgaWYgKCF0aGlzLmNsaWVudCB8fCAhdGhpcy5pc0Nvbm5lY3RlZCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBrZXkgPSB0aGlzLmdldEtleSgnbWVzc2FnZXMnLCBzZXNzaW9uSWQpO1xuICAgICAgY29uc3QgbWVzc2FnZURhdGEgPSBKU09OLnN0cmluZ2lmeShtZXNzYWdlKTtcbiAgICAgIFxuICAgICAgLy8gQWRkIHRvIGxpc3QgYW5kIHNldCBleHBpcmF0aW9uXG4gICAgICBhd2FpdCB0aGlzLmNsaWVudC5yUHVzaChrZXksIG1lc3NhZ2VEYXRhKTtcbiAgICAgIGF3YWl0IHRoaXMuY2xpZW50LmV4cGlyZShrZXksIDg2NDAwKTsgLy8gMjQgaG91cnNcbiAgICAgIFxuICAgICAgLy8gS2VlcCBvbmx5IGxhc3QgMTAwIG1lc3NhZ2VzXG4gICAgICBhd2FpdCB0aGlzLmNsaWVudC5sVHJpbShrZXksIC0xMDAsIC0xKTtcbiAgICAgIFxuICAgICAgbG9nLmRlYnVnKCdNZXNzYWdlIGFkZGVkIHRvIFJlZGlzJywgeyBzZXNzaW9uSWQsIG1lc3NhZ2VJZDogbWVzc2FnZS5pZCB9KTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoJ0ZhaWxlZCB0byBhZGQgbWVzc2FnZSB0byBSZWRpcycsIGVycm9yIGFzIEVycm9yLCB7IHNlc3Npb25JZCB9KTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZXRNZXNzYWdlcyhzZXNzaW9uSWQ6IHN0cmluZywgbGltaXQ6IG51bWJlciA9IDUwKTogUHJvbWlzZTxNZXNzYWdlW10+IHtcbiAgICBpZiAoIXRoaXMuY2xpZW50IHx8ICF0aGlzLmlzQ29ubmVjdGVkKSB7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGtleSA9IHRoaXMuZ2V0S2V5KCdtZXNzYWdlcycsIHNlc3Npb25JZCk7XG4gICAgICBjb25zdCBtZXNzYWdlcyA9IGF3YWl0IHRoaXMuY2xpZW50LmxSYW5nZShrZXksIC1saW1pdCwgLTEpO1xuICAgICAgXG4gICAgICByZXR1cm4gbWVzc2FnZXMubWFwKGRhdGEgPT4gSlNPTi5wYXJzZShkYXRhKSBhcyBNZXNzYWdlKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nLmVycm9yKCdGYWlsZWQgdG8gcmV0cmlldmUgbWVzc2FnZXMgZnJvbSBSZWRpcycsIGVycm9yIGFzIEVycm9yLCB7IHNlc3Npb25JZCB9KTtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gIH1cblxuICAvLyBDYWNoZSBNYW5hZ2VtZW50XG4gIGFzeW5jIHNldENhY2hlKGtleTogc3RyaW5nLCB2YWx1ZTogYW55LCB0dGw6IG51bWJlciA9IDMwMCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGlmICghdGhpcy5jbGllbnQgfHwgIXRoaXMuaXNDb25uZWN0ZWQpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgY2FjaGVLZXkgPSB0aGlzLmdldEtleSgnY2FjaGUnLCBrZXkpO1xuICAgICAgY29uc3QgZGF0YSA9IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgdmFsdWUsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGF3YWl0IHRoaXMuY2xpZW50LnNldEV4KGNhY2hlS2V5LCB0dGwsIGRhdGEpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZy5lcnJvcignRmFpbGVkIHRvIHNldCBjYWNoZSBpbiBSZWRpcycsIGVycm9yIGFzIEVycm9yLCB7IGtleSB9KTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZXRDYWNoZTxUPihrZXk6IHN0cmluZyk6IFByb21pc2U8VCB8IG51bGw+IHtcbiAgICBpZiAoIXRoaXMuY2xpZW50IHx8ICF0aGlzLmlzQ29ubmVjdGVkKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgY2FjaGVLZXkgPSB0aGlzLmdldEtleSgnY2FjaGUnLCBrZXkpO1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMuY2xpZW50LmdldChjYWNoZUtleSk7XG4gICAgICBcbiAgICAgIGlmICghZGF0YSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cblxuICAgICAgY29uc3QgY2FjaGVkID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgICAgIHJldHVybiBjYWNoZWQudmFsdWUgYXMgVDtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nLmVycm9yKCdGYWlsZWQgdG8gZ2V0IGNhY2hlIGZyb20gUmVkaXMnLCBlcnJvciBhcyBFcnJvciwgeyBrZXkgfSk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH1cblxuICBhc3luYyBkZWxldGVDYWNoZShrZXk6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGlmICghdGhpcy5jbGllbnQgfHwgIXRoaXMuaXNDb25uZWN0ZWQpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgY2FjaGVLZXkgPSB0aGlzLmdldEtleSgnY2FjaGUnLCBrZXkpO1xuICAgICAgYXdhaXQgdGhpcy5jbGllbnQuZGVsKGNhY2hlS2V5KTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoJ0ZhaWxlZCB0byBkZWxldGUgY2FjaGUgZnJvbSBSZWRpcycsIGVycm9yIGFzIEVycm9yLCB7IGtleSB9KTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvLyBSYXRlIExpbWl0aW5nXG4gIGFzeW5jIGNoZWNrUmF0ZUxpbWl0KGlkZW50aWZpZXI6IHN0cmluZywgd2luZG93U2Vjb25kczogbnVtYmVyLCBtYXhSZXF1ZXN0czogbnVtYmVyKTogUHJvbWlzZTx7XG4gICAgYWxsb3dlZDogYm9vbGVhbjtcbiAgICByZW1haW5pbmc6IG51bWJlcjtcbiAgICByZXNldFRpbWU6IG51bWJlcjtcbiAgfT4ge1xuICAgIGlmICghdGhpcy5jbGllbnQgfHwgIXRoaXMuaXNDb25uZWN0ZWQpIHtcbiAgICAgIC8vIEZhbGxiYWNrIHRvIGFsbG93aW5nIHJlcXVlc3QgaWYgUmVkaXMgaXMgbm90IGF2YWlsYWJsZVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYWxsb3dlZDogdHJ1ZSxcbiAgICAgICAgcmVtYWluaW5nOiBtYXhSZXF1ZXN0cyAtIDEsXG4gICAgICAgIHJlc2V0VGltZTogRGF0ZS5ub3coKSArIHdpbmRvd1NlY29uZHMgKiAxMDAwLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgY29uc3Qga2V5ID0gdGhpcy5nZXRLZXkoJ3JhdGVsaW1pdCcsIGlkZW50aWZpZXIpO1xuICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICAgIGNvbnN0IHdpbmRvd1N0YXJ0ID0gbm93IC0gd2luZG93U2Vjb25kcyAqIDEwMDA7XG5cbiAgICAgIC8vIFJlbW92ZSBvbGQgZW50cmllcyBhbmQgY291bnQgY3VycmVudCByZXF1ZXN0c1xuICAgICAgYXdhaXQgdGhpcy5jbGllbnQuelJlbVJhbmdlQnlTY29yZShrZXksIDAsIHdpbmRvd1N0YXJ0KTtcbiAgICAgIGNvbnN0IGN1cnJlbnRDb3VudCA9IGF3YWl0IHRoaXMuY2xpZW50LnpDYXJkKGtleSk7XG5cbiAgICAgIGlmIChjdXJyZW50Q291bnQgPj0gbWF4UmVxdWVzdHMpIHtcbiAgICAgICAgY29uc3Qgb2xkZXN0RW50cnkgPSBhd2FpdCB0aGlzLmNsaWVudC56UmFuZ2VXaXRoU2NvcmVzKGtleSwgMCwgMCk7XG4gICAgICAgIGNvbnN0IHJlc2V0VGltZSA9IG9sZGVzdEVudHJ5Lmxlbmd0aCA+IDAgPyBcbiAgICAgICAgICBOdW1iZXIob2xkZXN0RW50cnlbMF0uc2NvcmUpICsgd2luZG93U2Vjb25kcyAqIDEwMDAgOiBcbiAgICAgICAgICBub3cgKyB3aW5kb3dTZWNvbmRzICogMTAwMDtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGFsbG93ZWQ6IGZhbHNlLFxuICAgICAgICAgIHJlbWFpbmluZzogMCxcbiAgICAgICAgICByZXNldFRpbWUsXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIC8vIEFkZCBjdXJyZW50IHJlcXVlc3RcbiAgICAgIGF3YWl0IHRoaXMuY2xpZW50LnpBZGQoa2V5LCB7IHNjb3JlOiBub3csIHZhbHVlOiBgJHtub3d9LSR7TWF0aC5yYW5kb20oKX1gIH0pO1xuICAgICAgYXdhaXQgdGhpcy5jbGllbnQuZXhwaXJlKGtleSwgd2luZG93U2Vjb25kcyk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGFsbG93ZWQ6IHRydWUsXG4gICAgICAgIHJlbWFpbmluZzogbWF4UmVxdWVzdHMgLSBjdXJyZW50Q291bnQgLSAxLFxuICAgICAgICByZXNldFRpbWU6IG5vdyArIHdpbmRvd1NlY29uZHMgKiAxMDAwLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nLmVycm9yKCdSYXRlIGxpbWl0IGNoZWNrIGZhaWxlZCBpbiBSZWRpcycsIGVycm9yIGFzIEVycm9yLCB7IGlkZW50aWZpZXIgfSk7XG4gICAgICAvLyBGYWxsYmFjayB0byBhbGxvd2luZyByZXF1ZXN0XG4gICAgICByZXR1cm4ge1xuICAgICAgICBhbGxvd2VkOiB0cnVlLFxuICAgICAgICByZW1haW5pbmc6IG1heFJlcXVlc3RzIC0gMSxcbiAgICAgICAgcmVzZXRUaW1lOiBEYXRlLm5vdygpICsgd2luZG93U2Vjb25kcyAqIDEwMDAsXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIC8vIFN0YXRpc3RpY3NcbiAgYXN5bmMgZ2V0U3RhdHMoKTogUHJvbWlzZTx7XG4gICAgY29ubmVjdGVkOiBib29sZWFuO1xuICAgIG1lbW9yeVVzYWdlPzogc3RyaW5nO1xuICAgIGNvbm5lY3RlZENsaWVudHM/OiBudW1iZXI7XG4gICAgdG90YWxLZXlzPzogbnVtYmVyO1xuICB9PiB7XG4gICAgaWYgKCF0aGlzLmNsaWVudCB8fCAhdGhpcy5pc0Nvbm5lY3RlZCkge1xuICAgICAgcmV0dXJuIHsgY29ubmVjdGVkOiBmYWxzZSB9O1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBpbmZvID0gYXdhaXQgdGhpcy5jbGllbnQuaW5mbygpO1xuICAgICAgY29uc3Qga2V5Q291bnQgPSBhd2FpdCB0aGlzLmNsaWVudC5kYlNpemUoKTtcbiAgICAgIFxuICAgICAgLy8gUGFyc2UgaW5mbyBmb3IgcmVsZXZhbnQgc3RhdHNcbiAgICAgIGNvbnN0IG1lbW9yeU1hdGNoID0gaW5mby5tYXRjaCgvdXNlZF9tZW1vcnlfaHVtYW46KFteXFxyXFxuXSspLyk7XG4gICAgICBjb25zdCBjbGllbnRzTWF0Y2ggPSBpbmZvLm1hdGNoKC9jb25uZWN0ZWRfY2xpZW50czooXFxkKykvKTtcbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgY29ubmVjdGVkOiB0cnVlLFxuICAgICAgICBtZW1vcnlVc2FnZTogbWVtb3J5TWF0Y2ggPyBtZW1vcnlNYXRjaFsxXS50cmltKCkgOiAndW5rbm93bicsXG4gICAgICAgIGNvbm5lY3RlZENsaWVudHM6IGNsaWVudHNNYXRjaCA/IHBhcnNlSW50KGNsaWVudHNNYXRjaFsxXSkgOiAwLFxuICAgICAgICB0b3RhbEtleXM6IGtleUNvdW50LFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nLmVycm9yKCdGYWlsZWQgdG8gZ2V0IFJlZGlzIHN0YXRzJywgZXJyb3IgYXMgRXJyb3IpO1xuICAgICAgcmV0dXJuIHsgY29ubmVjdGVkOiBmYWxzZSB9O1xuICAgIH1cbiAgfVxuXG4gIC8vIENsZWFudXBcbiAgYXN5bmMgY2xlYW51cCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAodGhpcy5jbGllbnQpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHRoaXMuY2xpZW50LnF1aXQoKTtcbiAgICAgICAgbG9nLmluZm8oJ1JlZGlzIGNsaWVudCBkaXNjb25uZWN0ZWQgZ3JhY2VmdWxseScpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgbG9nLmVycm9yKCdFcnJvciBkdXJpbmcgUmVkaXMgY2xlYW51cCcsIGVycm9yIGFzIEVycm9yKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuY2xpZW50ID0gbnVsbDtcbiAgICAgIHRoaXMuaXNDb25uZWN0ZWQgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvLyBIZWFsdGggY2hlY2tcbiAgYXN5bmMgaGVhbHRoQ2hlY2soKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgdHJ5IHtcbiAgICAgIGlmICghdGhpcy5jbGllbnQgfHwgIXRoaXMuaXNDb25uZWN0ZWQpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCBwb25nID0gYXdhaXQgdGhpcy5jbGllbnQucGluZygpO1xuICAgICAgcmV0dXJuIHBvbmcgPT09ICdQT05HJztcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbn1cblxuLy8gU2luZ2xldG9uIGluc3RhbmNlXG5sZXQgcmVkaXNTZXJ2aWNlSW5zdGFuY2U6IFJlZGlzU2VydmljZSB8IG51bGwgPSBudWxsO1xuXG5leHBvcnQgY29uc3QgZ2V0UmVkaXNTZXJ2aWNlID0gKCk6IFJlZGlzU2VydmljZSA9PiB7XG4gIGlmICghcmVkaXNTZXJ2aWNlSW5zdGFuY2UpIHtcbiAgICByZWRpc1NlcnZpY2VJbnN0YW5jZSA9IG5ldyBSZWRpc1NlcnZpY2UoKTtcbiAgfVxuICByZXR1cm4gcmVkaXNTZXJ2aWNlSW5zdGFuY2U7XG59OyJdLCJuYW1lcyI6WyJjcmVhdGVDbGllbnQiLCJjb25maWciLCJpc0RldmVsb3BtZW50IiwibG9nIiwiUmVkaXNTZXJ2aWNlIiwiY29uc3RydWN0b3IiLCJjbGllbnQiLCJpc0Nvbm5lY3RlZCIsInJlY29ubmVjdEF0dGVtcHRzIiwibWF4UmVjb25uZWN0QXR0ZW1wdHMiLCJwcm9jZXNzIiwiZW52IiwiRElTQUJMRV9SRURJUyIsImluZm8iLCJyZWRpc1VybCIsImluaXRpYWxpemVDbGllbnQiLCJ3YXJuIiwiY2xpZW50T3B0aW9ucyIsInVybCIsInNvY2tldCIsImNvbm5lY3RUaW1lb3V0IiwibGF6eUNvbm5lY3QiLCJyZWNvbm5lY3RTdHJhdGVneSIsInJldHJpZXMiLCJlcnJvciIsImRlbGF5IiwiTWF0aCIsIm1pbiIsImhvc3QiLCJwb3J0Iiwib24iLCJlcnIiLCJjb25uZWN0IiwiZ2V0S2V5IiwicHJlZml4IiwiaWQiLCJpc1JlYWR5IiwicGluZyIsInNldFNlc3Npb24iLCJzZXNzaW9uSWQiLCJzZXNzaW9uRGF0YSIsInR0bCIsImtleSIsImRhdGEiLCJKU09OIiwic3RyaW5naWZ5IiwidXBkYXRlZEF0IiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwic2V0RXgiLCJkZWJ1ZyIsImdldFNlc3Npb24iLCJnZXQiLCJwYXJzZSIsImxhc3RBY3Rpdml0eSIsImRlbGV0ZVNlc3Npb24iLCJzZXNzaW9uS2V5IiwibWVzc2FnZXNLZXkiLCJQcm9taXNlIiwiYWxsIiwiZGVsIiwiYWRkTWVzc2FnZSIsIm1lc3NhZ2UiLCJtZXNzYWdlRGF0YSIsInJQdXNoIiwiZXhwaXJlIiwibFRyaW0iLCJtZXNzYWdlSWQiLCJnZXRNZXNzYWdlcyIsImxpbWl0IiwibWVzc2FnZXMiLCJsUmFuZ2UiLCJtYXAiLCJzZXRDYWNoZSIsInZhbHVlIiwiY2FjaGVLZXkiLCJ0aW1lc3RhbXAiLCJnZXRDYWNoZSIsImNhY2hlZCIsImRlbGV0ZUNhY2hlIiwiY2hlY2tSYXRlTGltaXQiLCJpZGVudGlmaWVyIiwid2luZG93U2Vjb25kcyIsIm1heFJlcXVlc3RzIiwiYWxsb3dlZCIsInJlbWFpbmluZyIsInJlc2V0VGltZSIsIm5vdyIsIndpbmRvd1N0YXJ0IiwielJlbVJhbmdlQnlTY29yZSIsImN1cnJlbnRDb3VudCIsInpDYXJkIiwib2xkZXN0RW50cnkiLCJ6UmFuZ2VXaXRoU2NvcmVzIiwibGVuZ3RoIiwiTnVtYmVyIiwic2NvcmUiLCJ6QWRkIiwicmFuZG9tIiwiZ2V0U3RhdHMiLCJjb25uZWN0ZWQiLCJrZXlDb3VudCIsImRiU2l6ZSIsIm1lbW9yeU1hdGNoIiwibWF0Y2giLCJjbGllbnRzTWF0Y2giLCJtZW1vcnlVc2FnZSIsInRyaW0iLCJjb25uZWN0ZWRDbGllbnRzIiwicGFyc2VJbnQiLCJ0b3RhbEtleXMiLCJjbGVhbnVwIiwicXVpdCIsImhlYWx0aENoZWNrIiwicG9uZyIsInJlZGlzU2VydmljZUluc3RhbmNlIiwiZ2V0UmVkaXNTZXJ2aWNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/services/RedisService.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/services/SessionManager.ts":
/*!********************************************!*\
  !*** ./src/lib/services/SessionManager.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SessionManager: () => (/* binding */ SessionManager)\n/* harmony export */ });\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist/esm-node/v4.js\");\n/* harmony import */ var _RedisService__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./RedisService */ \"(rsc)/./src/lib/services/RedisService.ts\");\n/* harmony import */ var _lib_logger__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/logger */ \"(rsc)/./src/lib/logger.ts\");\n/* harmony import */ var _lib_config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/config */ \"(rsc)/./src/lib/config.ts\");\n\n\n\n\n// Global storage that persists across hot reloads in development\nconst globalForSessions = globalThis;\nclass SessionManager {\n    constructor(){\n        this.redisService = (0,_RedisService__WEBPACK_IMPORTED_MODULE_0__.getRedisService)();\n        this.cleanupInterval = null;\n        this.gcInterval = null;\n        this.MAX_MEMORY_SESSIONS = 10000 // メモリ内セッション数の上限\n        ;\n        this.MAX_MESSAGES_PER_SESSION = 100 // セッションごとのメッセージ数上限\n        ;\n        // Use global storage in development to persist across hot reloads\n        if (true) {\n            if (!globalForSessions.memorySessions) {\n                globalForSessions.memorySessions = new Map();\n                globalForSessions.memoryMessages = new Map();\n                _lib_logger__WEBPACK_IMPORTED_MODULE_1__.log.info(\"Initialized global session storage for development\");\n            }\n            this.memorySessions = globalForSessions.memorySessions;\n            this.memoryMessages = globalForSessions.memoryMessages;\n            // Only start cleanup if not already started\n            if (!globalForSessions.cleanupInterval) {\n                this.startCleanupProcess();\n            }\n        } else {}\n    }\n    static getInstance() {\n        if (!SessionManager.instance) {\n            SessionManager.instance = new SessionManager();\n        }\n        return SessionManager.instance;\n    }\n    startCleanupProcess() {\n        // Clean up expired sessions more frequently (every 10 minutes)\n        const interval = setInterval(()=>{\n            this.cleanupExpiredSessions();\n        }, 10 * 60 * 1000);\n        // Store interval reference globally in development\n        if (true) {\n            globalForSessions.cleanupInterval = interval;\n        } else {}\n        // Force garbage collection periodically in production\n        if (false) {}\n    }\n    async cleanupExpiredSessions() {\n        const now = new Date();\n        const expiredSessions = [];\n        const oldSessions = [];\n        // Check memory sessions\n        for (const [sessionId, session] of this.memorySessions.entries()){\n            const timeSinceActivity = now.getTime() - session.lastActivity.getTime();\n            if (timeSinceActivity > _lib_config__WEBPACK_IMPORTED_MODULE_2__.config.maxSessionDuration) {\n                expiredSessions.push(sessionId);\n            } else {\n                oldSessions.push({\n                    sessionId,\n                    lastActivity: timeSinceActivity\n                });\n            }\n        }\n        // Memory pressure management: remove oldest sessions if over limit\n        if (this.memorySessions.size > this.MAX_MEMORY_SESSIONS) {\n            oldSessions.sort((a, b)=>b.lastActivity - a.lastActivity);\n            const sessionsToRemove = oldSessions.slice(this.MAX_MEMORY_SESSIONS - expiredSessions.length);\n            for (const { sessionId } of sessionsToRemove){\n                expiredSessions.push(sessionId);\n                _lib_logger__WEBPACK_IMPORTED_MODULE_1__.log.warn(`Removing session due to memory pressure: ${sessionId.substring(0, 8)}...`);\n            }\n        }\n        // Clean up expired sessions in batches to avoid blocking\n        const batchSize = 50;\n        for(let i = 0; i < expiredSessions.length; i += batchSize){\n            const batch = expiredSessions.slice(i, i + batchSize);\n            await Promise.all(batch.map((sessionId)=>this.deleteSession(sessionId)));\n            // Allow event loop to process other tasks\n            if (i + batchSize < expiredSessions.length) {\n                await new Promise((resolve)=>setImmediate(resolve));\n            }\n        }\n        // Clean up orphaned messages (messages without corresponding sessions)\n        const orphanedMessageSessions = [];\n        for (const sessionId of this.memoryMessages.keys()){\n            if (!this.memorySessions.has(sessionId)) {\n                orphanedMessageSessions.push(sessionId);\n            }\n        }\n        for (const sessionId of orphanedMessageSessions){\n            this.memoryMessages.delete(sessionId);\n        }\n        if (expiredSessions.length > 0 || orphanedMessageSessions.length > 0) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_1__.log.info(`Cleaned up ${expiredSessions.length} expired sessions and ${orphanedMessageSessions.length} orphaned message sets. Memory usage: ${this.memorySessions.size} sessions, ${this.memoryMessages.size} message sets`);\n        }\n    }\n    async createSession(language = \"ja\", metadata) {\n        const sessionId = (0,uuid__WEBPACK_IMPORTED_MODULE_3__[\"default\"])();\n        const now = new Date();\n        const sessionData = {\n            id: sessionId,\n            language,\n            createdAt: now,\n            lastActivity: now,\n            messageCount: 0,\n            isActive: true,\n            metadata: metadata || {}\n        };\n        try {\n            // Try to store in Redis first\n            const redisStored = await this.redisService.setSession(sessionId, sessionData, Math.floor(_lib_config__WEBPACK_IMPORTED_MODULE_2__.config.maxSessionDuration / 1000));\n            if (!redisStored) {\n                // Fallback to memory storage\n                this.memorySessions.set(sessionId, sessionData);\n                this.memoryMessages.set(sessionId, []);\n                _lib_logger__WEBPACK_IMPORTED_MODULE_1__.log.warn(\"Session stored in memory (Redis unavailable)\", {\n                    sessionId\n                });\n                // Verify storage\n                const stored = this.memorySessions.get(sessionId);\n                _lib_logger__WEBPACK_IMPORTED_MODULE_1__.log.info(\"Session memory storage verified\", {\n                    sessionId: sessionId.substring(0, 8) + \"...\",\n                    stored: !!stored,\n                    totalSessions: this.memorySessions.size,\n                    isDevelopment: \"development\" === \"development\",\n                    usingGlobalStorage:  true && this.memorySessions === globalForSessions.memorySessions\n                });\n            }\n            _lib_logger__WEBPACK_IMPORTED_MODULE_1__.log.info(\"Session created\", {\n                sessionId: sessionId.substring(0, 8) + \"...\",\n                language,\n                storage: redisStored ? \"redis\" : \"memory\"\n            });\n            return sessionId;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_1__.log.error(\"Failed to create session\", error, {\n                sessionId\n            });\n            throw new Error(\"Failed to create session\");\n        }\n    }\n    async getSession(sessionId) {\n        if (!sessionId) {\n            return null;\n        }\n        try {\n            // Try Redis first\n            let sessionData = await this.redisService.getSession(sessionId);\n            if (!sessionData) {\n                // Fallback to memory storage\n                sessionData = this.memorySessions.get(sessionId) || null;\n                if (sessionData) {\n                    // Update last activity\n                    sessionData.lastActivity = new Date();\n                    this.memorySessions.set(sessionId, sessionData);\n                } else {\n                    _lib_logger__WEBPACK_IMPORTED_MODULE_1__.log.warn(\"Session not found in memory storage\", {\n                        sessionId: sessionId.substring(0, 8) + \"...\",\n                        totalSessionsInMemory: this.memorySessions.size,\n                        availableSessionIds: Array.from(this.memorySessions.keys()).map((id)=>id.substring(0, 8) + \"...\"),\n                        isDevelopment: \"development\" === \"development\",\n                        usingGlobalStorage:  true && this.memorySessions === globalForSessions.memorySessions,\n                        globalSessionCount:  true ? globalForSessions.memorySessions?.size : 0\n                    });\n                }\n            }\n            if (!sessionData) {\n                return null;\n            }\n            // Check if session is expired\n            const now = new Date();\n            const lastActivity = new Date(sessionData.lastActivity);\n            const timeSinceActivity = now.getTime() - lastActivity.getTime();\n            if (timeSinceActivity > _lib_config__WEBPACK_IMPORTED_MODULE_2__.config.maxSessionDuration) {\n                _lib_logger__WEBPACK_IMPORTED_MODULE_1__.log.warn(\"Session expired\", {\n                    sessionId: sessionId.substring(0, 8) + \"...\",\n                    timeSinceActivity,\n                    maxDuration: _lib_config__WEBPACK_IMPORTED_MODULE_2__.config.maxSessionDuration\n                });\n                await this.deleteSession(sessionId);\n                return null;\n            }\n            return sessionData;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_1__.log.error(\"Failed to retrieve session\", error, {\n                sessionId\n            });\n            return null;\n        }\n    }\n    async updateSession(sessionId, updates) {\n        try {\n            const existingSession = await this.getSession(sessionId);\n            if (!existingSession) {\n                return false;\n            }\n            const updatedSession = {\n                ...existingSession,\n                ...updates,\n                lastActivity: new Date()\n            };\n            // Try Redis first\n            const redisUpdated = await this.redisService.setSession(sessionId, updatedSession, Math.floor(_lib_config__WEBPACK_IMPORTED_MODULE_2__.config.maxSessionDuration / 1000));\n            if (!redisUpdated) {\n                // Fallback to memory storage\n                this.memorySessions.set(sessionId, updatedSession);\n            }\n            return true;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_1__.log.error(\"Failed to update session\", error, {\n                sessionId\n            });\n            return false;\n        }\n    }\n    async deleteSession(sessionId) {\n        try {\n            // Delete from Redis\n            const redisDeleted = await this.redisService.deleteSession(sessionId);\n            // Delete from memory\n            const memoryDeleted = this.memorySessions.delete(sessionId);\n            this.memoryMessages.delete(sessionId);\n            if (redisDeleted || memoryDeleted) {\n                _lib_logger__WEBPACK_IMPORTED_MODULE_1__.log.info(\"Session deleted\", {\n                    sessionId: sessionId.substring(0, 8) + \"...\"\n                });\n                return true;\n            }\n            return false;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_1__.log.error(\"Failed to delete session\", error, {\n                sessionId\n            });\n            return false;\n        }\n    }\n    async addMessage(sessionId, message) {\n        try {\n            // Try Redis first\n            const redisAdded = await this.redisService.addMessage(sessionId, message);\n            if (!redisAdded) {\n                // Fallback to memory storage\n                if (!this.memoryMessages.has(sessionId)) {\n                    this.memoryMessages.set(sessionId, []);\n                }\n                const messages = this.memoryMessages.get(sessionId);\n                messages.push(message);\n                // Keep only last MAX_MESSAGES_PER_SESSION messages\n                if (messages.length > this.MAX_MESSAGES_PER_SESSION) {\n                    messages.splice(0, messages.length - this.MAX_MESSAGES_PER_SESSION);\n                }\n            }\n            // Update session message count and last activity\n            await this.updateSession(sessionId, {\n                messageCount: (await this.getMessages(sessionId)).length\n            });\n            return true;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_1__.log.error(\"Failed to add message to session\", error, {\n                sessionId\n            });\n            return false;\n        }\n    }\n    async getMessages(sessionId, limit = 50) {\n        try {\n            // Try Redis first\n            let messages = await this.redisService.getMessages(sessionId, limit);\n            if (messages.length === 0) {\n                // Fallback to memory storage\n                const memoryMessages = this.memoryMessages.get(sessionId) || [];\n                messages = memoryMessages.slice(-limit);\n            }\n            // Convert timestamp strings back to Date objects if needed\n            return messages.map((message)=>({\n                    ...message,\n                    timestamp: new Date(message.timestamp)\n                }));\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_1__.log.error(\"Failed to retrieve messages\", error, {\n                sessionId\n            });\n            return [];\n        }\n    }\n    async clearMessages(sessionId) {\n        try {\n            const session = await this.getSession(sessionId);\n            if (!session) {\n                return false;\n            }\n            // Clear from Redis\n            await this.redisService.deleteCache(`messages:${sessionId}`);\n            // Clear from memory\n            this.memoryMessages.set(sessionId, []);\n            // Update session\n            await this.updateSession(sessionId, {\n                messageCount: 0\n            });\n            return true;\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_1__.log.error(\"Failed to clear messages\", error, {\n                sessionId\n            });\n            return false;\n        }\n    }\n    async getSessionStats() {\n        try {\n            const memorySessionCount = this.memorySessions.size;\n            const redisStats = await this.redisService.getStats();\n            const redisSessionCount = redisStats.totalKeys ? Math.floor(redisStats.totalKeys / 2) : 0;\n            // Language distribution from memory sessions\n            const languageDistribution = {\n                ja: 0,\n                en: 0,\n                zh: 0,\n                ko: 0\n            };\n            let totalMessages = 0;\n            for (const [sessionId, session] of this.memorySessions.entries()){\n                languageDistribution[session.language]++;\n                totalMessages += this.memoryMessages.get(sessionId)?.length || 0;\n            }\n            const totalSessions = memorySessionCount + redisSessionCount;\n            const averageMessagesPerSession = totalSessions > 0 ? totalMessages / totalSessions : 0;\n            return {\n                totalActiveSessions: totalSessions,\n                memorySessionCount,\n                redisSessionCount,\n                averageMessagesPerSession: Number(averageMessagesPerSession.toFixed(2)),\n                languageDistribution\n            };\n        } catch (error) {\n            _lib_logger__WEBPACK_IMPORTED_MODULE_1__.log.error(\"Failed to get session stats\", error);\n            return {\n                totalActiveSessions: 0,\n                memorySessionCount: 0,\n                redisSessionCount: 0,\n                averageMessagesPerSession: 0,\n                languageDistribution: {\n                    ja: 0,\n                    en: 0,\n                    zh: 0,\n                    ko: 0\n                }\n            };\n        }\n    }\n    async isSessionActive(sessionId) {\n        const session = await this.getSession(sessionId);\n        return session !== null && session.isActive;\n    }\n    async setSessionLanguage(sessionId, language) {\n        return this.updateSession(sessionId, {\n            language\n        });\n    }\n    // Legacy methods for backwards compatibility\n    getSessionCount() {\n        return this.memorySessions.size;\n    }\n    getAllSessions() {\n        return Array.from(this.memorySessions.values());\n    }\n    async cleanup() {\n        // Clear cleanup intervals\n        if (this.cleanupInterval) {\n            clearInterval(this.cleanupInterval);\n            this.cleanupInterval = null;\n        }\n        if (this.gcInterval) {\n            clearInterval(this.gcInterval);\n            this.gcInterval = null;\n        }\n        // Clear global cleanup interval in development\n        if ( true && globalForSessions.cleanupInterval) {\n            clearInterval(globalForSessions.cleanupInterval);\n            globalForSessions.cleanupInterval = null;\n        }\n        // Clear memory storage\n        this.memorySessions.clear();\n        this.memoryMessages.clear();\n        // Clear global storage in development\n        if (true) {\n            globalForSessions.memorySessions?.clear();\n            globalForSessions.memoryMessages?.clear();\n        }\n        // Cleanup Redis service\n        await this.redisService.cleanup();\n        _lib_logger__WEBPACK_IMPORTED_MODULE_1__.log.info(\"SessionManager cleanup completed\");\n    }\n    // Memory usage monitoring\n    getMemoryUsage() {\n        const sessionCount = this.memorySessions.size;\n        const messageSetCount = this.memoryMessages.size;\n        // Rough estimation: each session ~1KB, each message ~0.5KB\n        let totalMessages = 0;\n        for (const messages of this.memoryMessages.values()){\n            totalMessages += messages.length;\n        }\n        const estimatedMemoryMB = Math.round((sessionCount * 1 + totalMessages * 0.5) / 1024);\n        const isNearLimit = sessionCount > this.MAX_MEMORY_SESSIONS * 0.8;\n        return {\n            sessionCount,\n            messageSetCount,\n            estimatedMemoryMB,\n            isNearLimit\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3NlcnZpY2VzL1Nlc3Npb25NYW5hZ2VyLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQW9DO0FBRWE7QUFDZDtBQUNHO0FBRXRDLGlFQUFpRTtBQUNqRSxNQUFNSyxvQkFBb0JDO0FBTW5CLE1BQU1DO0lBVVgsYUFBc0I7YUFSZEMsZUFBZU4sOERBQWVBO2FBRzlCTyxrQkFBeUM7YUFDekNDLGFBQW9DO2FBQzNCQyxzQkFBc0IsTUFBTyxnQkFBZ0I7O2FBQzdDQywyQkFBMkIsSUFBSyxtQkFBbUI7O1FBR2xFLGtFQUFrRTtRQUNsRSxJQUFJQyxJQUF5QixFQUFlO1lBQzFDLElBQUksQ0FBQ1Isa0JBQWtCUyxjQUFjLEVBQUU7Z0JBQ3JDVCxrQkFBa0JTLGNBQWMsR0FBRyxJQUFJQztnQkFDdkNWLGtCQUFrQlcsY0FBYyxHQUFHLElBQUlEO2dCQUN2Q1osNENBQUdBLENBQUNjLElBQUksQ0FBQztZQUNYO1lBQ0EsSUFBSSxDQUFDSCxjQUFjLEdBQUdULGtCQUFrQlMsY0FBYztZQUN0RCxJQUFJLENBQUNFLGNBQWMsR0FBR1gsa0JBQWtCVyxjQUFjO1lBRXRELDRDQUE0QztZQUM1QyxJQUFJLENBQUNYLGtCQUFrQkksZUFBZSxFQUFFO2dCQUN0QyxJQUFJLENBQUNTLG1CQUFtQjtZQUMxQjtRQUNGLE9BQU8sRUFJTjtJQUNIO0lBRUEsT0FBT0MsY0FBOEI7UUFDbkMsSUFBSSxDQUFDWixlQUFlYSxRQUFRLEVBQUU7WUFDNUJiLGVBQWVhLFFBQVEsR0FBRyxJQUFJYjtRQUNoQztRQUNBLE9BQU9BLGVBQWVhLFFBQVE7SUFDaEM7SUFFUUYsc0JBQTRCO1FBQ2xDLCtEQUErRDtRQUMvRCxNQUFNRyxXQUFXQyxZQUFZO1lBQzNCLElBQUksQ0FBQ0Msc0JBQXNCO1FBQzdCLEdBQUcsS0FBSyxLQUFLO1FBRWIsbURBQW1EO1FBQ25ELElBQUlWLElBQXlCLEVBQWU7WUFDMUNSLGtCQUFrQkksZUFBZSxHQUFHWTtRQUN0QyxPQUFPLEVBR047UUFF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ZUFBZSxJQUFJLENBQUN4SCxtQkFBbUIsR0FBRztRQUU5RCxPQUFPO1lBQ0x3SDtZQUNBQztZQUNBQztZQUNBRTtRQUNGO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3Rva3lvLW9wZW5kYXRhLWhhY2thdGhvbi8uL3NyYy9saWIvc2VydmljZXMvU2Vzc2lvbk1hbmFnZXIudHM/OTkxYSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB2NCBhcyB1dWlkdjQgfSBmcm9tICd1dWlkJztcbmltcG9ydCB7IFNlc3Npb25EYXRhLCBNZXNzYWdlLCBTdXBwb3J0ZWRMYW5ndWFnZSB9IGZyb20gJ0AvdHlwZXMnO1xuaW1wb3J0IHsgZ2V0UmVkaXNTZXJ2aWNlIH0gZnJvbSAnLi9SZWRpc1NlcnZpY2UnO1xuaW1wb3J0IHsgbG9nIH0gZnJvbSAnQC9saWIvbG9nZ2VyJztcbmltcG9ydCB7IGNvbmZpZyB9IGZyb20gJ0AvbGliL2NvbmZpZyc7XG5cbi8vIEdsb2JhbCBzdG9yYWdlIHRoYXQgcGVyc2lzdHMgYWNyb3NzIGhvdCByZWxvYWRzIGluIGRldmVsb3BtZW50XG5jb25zdCBnbG9iYWxGb3JTZXNzaW9ucyA9IGdsb2JhbFRoaXMgYXMgdW5rbm93biBhcyB7XG4gIG1lbW9yeVNlc3Npb25zOiBNYXA8c3RyaW5nLCBTZXNzaW9uRGF0YT47XG4gIG1lbW9yeU1lc3NhZ2VzOiBNYXA8c3RyaW5nLCBNZXNzYWdlW10+O1xuICBjbGVhbnVwSW50ZXJ2YWw6IE5vZGVKUy5UaW1lb3V0IHwgbnVsbDtcbn07XG5cbmV4cG9ydCBjbGFzcyBTZXNzaW9uTWFuYWdlciB7XG4gIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBTZXNzaW9uTWFuYWdlcjtcbiAgcHJpdmF0ZSByZWRpc1NlcnZpY2UgPSBnZXRSZWRpc1NlcnZpY2UoKTtcbiAgcHJpdmF0ZSBtZW1vcnlTZXNzaW9uczogTWFwPHN0cmluZywgU2Vzc2lvbkRhdGE+O1xuICBwcml2YXRlIG1lbW9yeU1lc3NhZ2VzOiBNYXA8c3RyaW5nLCBNZXNzYWdlW10+O1xuICBwcml2YXRlIGNsZWFudXBJbnRlcnZhbDogTm9kZUpTLlRpbWVvdXQgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBnY0ludGVydmFsOiBOb2RlSlMuVGltZW91dCB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIHJlYWRvbmx5IE1BWF9NRU1PUllfU0VTU0lPTlMgPSAxMDAwMDsgLy8g44Oh44Oi44Oq5YaF44K744OD44K344On44Oz5pWw44Gu5LiK6ZmQXG4gIHByaXZhdGUgcmVhZG9ubHkgTUFYX01FU1NBR0VTX1BFUl9TRVNTSU9OID0gMTAwOyAvLyDjgrvjg4Pjgrfjg6fjg7PjgZTjgajjga7jg6Hjg4Pjgrvjg7zjgrjmlbDkuIrpmZBcblxuICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge1xuICAgIC8vIFVzZSBnbG9iYWwgc3RvcmFnZSBpbiBkZXZlbG9wbWVudCB0byBwZXJzaXN0IGFjcm9zcyBob3QgcmVsb2Fkc1xuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50Jykge1xuICAgICAgaWYgKCFnbG9iYWxGb3JTZXNzaW9ucy5tZW1vcnlTZXNzaW9ucykge1xuICAgICAgICBnbG9iYWxGb3JTZXNzaW9ucy5tZW1vcnlTZXNzaW9ucyA9IG5ldyBNYXAoKTtcbiAgICAgICAgZ2xvYmFsRm9yU2Vzc2lvbnMubWVtb3J5TWVzc2FnZXMgPSBuZXcgTWFwKCk7XG4gICAgICAgIGxvZy5pbmZvKCdJbml0aWFsaXplZCBnbG9iYWwgc2Vzc2lvbiBzdG9yYWdlIGZvciBkZXZlbG9wbWVudCcpO1xuICAgICAgfVxuICAgICAgdGhpcy5tZW1vcnlTZXNzaW9ucyA9IGdsb2JhbEZvclNlc3Npb25zLm1lbW9yeVNlc3Npb25zO1xuICAgICAgdGhpcy5tZW1vcnlNZXNzYWdlcyA9IGdsb2JhbEZvclNlc3Npb25zLm1lbW9yeU1lc3NhZ2VzO1xuICAgICAgXG4gICAgICAvLyBPbmx5IHN0YXJ0IGNsZWFudXAgaWYgbm90IGFscmVhZHkgc3RhcnRlZFxuICAgICAgaWYgKCFnbG9iYWxGb3JTZXNzaW9ucy5jbGVhbnVwSW50ZXJ2YWwpIHtcbiAgICAgICAgdGhpcy5zdGFydENsZWFudXBQcm9jZXNzKCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMubWVtb3J5U2Vzc2lvbnMgPSBuZXcgTWFwKCk7XG4gICAgICB0aGlzLm1lbW9yeU1lc3NhZ2VzID0gbmV3IE1hcCgpO1xuICAgICAgdGhpcy5zdGFydENsZWFudXBQcm9jZXNzKCk7XG4gICAgfVxuICB9XG5cbiAgc3RhdGljIGdldEluc3RhbmNlKCk6IFNlc3Npb25NYW5hZ2VyIHtcbiAgICBpZiAoIVNlc3Npb25NYW5hZ2VyLmluc3RhbmNlKSB7XG4gICAgICBTZXNzaW9uTWFuYWdlci5pbnN0YW5jZSA9IG5ldyBTZXNzaW9uTWFuYWdlcigpO1xuICAgIH1cbiAgICByZXR1cm4gU2Vzc2lvbk1hbmFnZXIuaW5zdGFuY2U7XG4gIH1cblxuICBwcml2YXRlIHN0YXJ0Q2xlYW51cFByb2Nlc3MoKTogdm9pZCB7XG4gICAgLy8gQ2xlYW4gdXAgZXhwaXJlZCBzZXNzaW9ucyBtb3JlIGZyZXF1ZW50bHkgKGV2ZXJ5IDEwIG1pbnV0ZXMpXG4gICAgY29uc3QgaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICB0aGlzLmNsZWFudXBFeHBpcmVkU2Vzc2lvbnMoKTtcbiAgICB9LCAxMCAqIDYwICogMTAwMCk7XG4gICAgXG4gICAgLy8gU3RvcmUgaW50ZXJ2YWwgcmVmZXJlbmNlIGdsb2JhbGx5IGluIGRldmVsb3BtZW50XG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnKSB7XG4gICAgICBnbG9iYWxGb3JTZXNzaW9ucy5jbGVhbnVwSW50ZXJ2YWwgPSBpbnRlcnZhbDtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gU3RvcmUgcmVmZXJlbmNlIGZvciBwcm9kdWN0aW9uIGNsZWFudXBcbiAgICAgIHRoaXMuY2xlYW51cEludGVydmFsID0gaW50ZXJ2YWw7XG4gICAgfVxuICAgIFxuICAgIC8vIEZvcmNlIGdhcmJhZ2UgY29sbGVjdGlvbiBwZXJpb2RpY2FsbHkgaW4gcHJvZHVjdGlvblxuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nICYmIGdsb2JhbC5nYykge1xuICAgICAgc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGdsb2JhbC5nYygpO1xuICAgICAgICAgIGxvZy5kZWJ1ZygnTWFudWFsIGdhcmJhZ2UgY29sbGVjdGlvbiB0cmlnZ2VyZWQnKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAvLyBJZ25vcmUgR0MgZXJyb3JzXG4gICAgICAgIH1cbiAgICAgIH0sIDMwICogNjAgKiAxMDAwKTsgLy8gRXZlcnkgMzAgbWludXRlc1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgY2xlYW51cEV4cGlyZWRTZXNzaW9ucygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IGV4cGlyZWRTZXNzaW9uczogc3RyaW5nW10gPSBbXTtcbiAgICBjb25zdCBvbGRTZXNzaW9uczogQXJyYXk8eyBzZXNzaW9uSWQ6IHN0cmluZzsgbGFzdEFjdGl2aXR5OiBudW1iZXIgfT4gPSBbXTtcblxuICAgIC8vIENoZWNrIG1lbW9yeSBzZXNzaW9uc1xuICAgIGZvciAoY29uc3QgW3Nlc3Npb25JZCwgc2Vzc2lvbl0gb2YgdGhpcy5tZW1vcnlTZXNzaW9ucy5lbnRyaWVzKCkpIHtcbiAgICAgIGNvbnN0IHRpbWVTaW5jZUFjdGl2aXR5ID0gbm93LmdldFRpbWUoKSAtIHNlc3Npb24ubGFzdEFjdGl2aXR5LmdldFRpbWUoKTtcbiAgICAgIGlmICh0aW1lU2luY2VBY3Rpdml0eSA+IGNvbmZpZy5tYXhTZXNzaW9uRHVyYXRpb24pIHtcbiAgICAgICAgZXhwaXJlZFNlc3Npb25zLnB1c2goc2Vzc2lvbklkKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG9sZFNlc3Npb25zLnB1c2goeyBzZXNzaW9uSWQsIGxhc3RBY3Rpdml0eTogdGltZVNpbmNlQWN0aXZpdHkgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gTWVtb3J5IHByZXNzdXJlIG1hbmFnZW1lbnQ6IHJlbW92ZSBvbGRlc3Qgc2Vzc2lvbnMgaWYgb3ZlciBsaW1pdFxuICAgIGlmICh0aGlzLm1lbW9yeVNlc3Npb25zLnNpemUgPiB0aGlzLk1BWF9NRU1PUllfU0VTU0lPTlMpIHtcbiAgICAgIG9sZFNlc3Npb25zLnNvcnQoKGEsIGIpID0+IGIubGFzdEFjdGl2aXR5IC0gYS5sYXN0QWN0aXZpdHkpO1xuICAgICAgY29uc3Qgc2Vzc2lvbnNUb1JlbW92ZSA9IG9sZFNlc3Npb25zLnNsaWNlKHRoaXMuTUFYX01FTU9SWV9TRVNTSU9OUyAtIGV4cGlyZWRTZXNzaW9ucy5sZW5ndGgpO1xuICAgICAgZm9yIChjb25zdCB7IHNlc3Npb25JZCB9IG9mIHNlc3Npb25zVG9SZW1vdmUpIHtcbiAgICAgICAgZXhwaXJlZFNlc3Npb25zLnB1c2goc2Vzc2lvbklkKTtcbiAgICAgICAgbG9nLndhcm4oYFJlbW92aW5nIHNlc3Npb24gZHVlIHRvIG1lbW9yeSBwcmVzc3VyZTogJHtzZXNzaW9uSWQuc3Vic3RyaW5nKDAsIDgpfS4uLmApO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIENsZWFuIHVwIGV4cGlyZWQgc2Vzc2lvbnMgaW4gYmF0Y2hlcyB0byBhdm9pZCBibG9ja2luZ1xuICAgIGNvbnN0IGJhdGNoU2l6ZSA9IDUwO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZXhwaXJlZFNlc3Npb25zLmxlbmd0aDsgaSArPSBiYXRjaFNpemUpIHtcbiAgICAgIGNvbnN0IGJhdGNoID0gZXhwaXJlZFNlc3Npb25zLnNsaWNlKGksIGkgKyBiYXRjaFNpemUpO1xuICAgICAgYXdhaXQgUHJvbWlzZS5hbGwoYmF0Y2gubWFwKHNlc3Npb25JZCA9PiB0aGlzLmRlbGV0ZVNlc3Npb24oc2Vzc2lvbklkKSkpO1xuICAgICAgXG4gICAgICAvLyBBbGxvdyBldmVudCBsb29wIHRvIHByb2Nlc3Mgb3RoZXIgdGFza3NcbiAgICAgIGlmIChpICsgYmF0Y2hTaXplIDwgZXhwaXJlZFNlc3Npb25zLmxlbmd0aCkge1xuICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldEltbWVkaWF0ZShyZXNvbHZlKSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQ2xlYW4gdXAgb3JwaGFuZWQgbWVzc2FnZXMgKG1lc3NhZ2VzIHdpdGhvdXQgY29ycmVzcG9uZGluZyBzZXNzaW9ucylcbiAgICBjb25zdCBvcnBoYW5lZE1lc3NhZ2VTZXNzaW9uczogc3RyaW5nW10gPSBbXTtcbiAgICBmb3IgKGNvbnN0IHNlc3Npb25JZCBvZiB0aGlzLm1lbW9yeU1lc3NhZ2VzLmtleXMoKSkge1xuICAgICAgaWYgKCF0aGlzLm1lbW9yeVNlc3Npb25zLmhhcyhzZXNzaW9uSWQpKSB7XG4gICAgICAgIG9ycGhhbmVkTWVzc2FnZVNlc3Npb25zLnB1c2goc2Vzc2lvbklkKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgZm9yIChjb25zdCBzZXNzaW9uSWQgb2Ygb3JwaGFuZWRNZXNzYWdlU2Vzc2lvbnMpIHtcbiAgICAgIHRoaXMubWVtb3J5TWVzc2FnZXMuZGVsZXRlKHNlc3Npb25JZCk7XG4gICAgfVxuXG4gICAgaWYgKGV4cGlyZWRTZXNzaW9ucy5sZW5ndGggPiAwIHx8IG9ycGhhbmVkTWVzc2FnZVNlc3Npb25zLmxlbmd0aCA+IDApIHtcbiAgICAgIGxvZy5pbmZvKGBDbGVhbmVkIHVwICR7ZXhwaXJlZFNlc3Npb25zLmxlbmd0aH0gZXhwaXJlZCBzZXNzaW9ucyBhbmQgJHtvcnBoYW5lZE1lc3NhZ2VTZXNzaW9ucy5sZW5ndGh9IG9ycGhhbmVkIG1lc3NhZ2Ugc2V0cy4gTWVtb3J5IHVzYWdlOiAke3RoaXMubWVtb3J5U2Vzc2lvbnMuc2l6ZX0gc2Vzc2lvbnMsICR7dGhpcy5tZW1vcnlNZXNzYWdlcy5zaXplfSBtZXNzYWdlIHNldHNgKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBjcmVhdGVTZXNzaW9uKGxhbmd1YWdlOiBTdXBwb3J0ZWRMYW5ndWFnZSA9ICdqYScsIG1ldGFkYXRhPzoge1xuICAgIHVzZXJBZ2VudD86IHN0cmluZztcbiAgICBpcEFkZHJlc3M/OiBzdHJpbmc7XG4gICAgZGV2aWNlVHlwZT86ICdtb2JpbGUnIHwgJ2Rlc2t0b3AnIHwgJ3RhYmxldCc7XG4gIH0pOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IHNlc3Npb25JZCA9IHV1aWR2NCgpO1xuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG5cbiAgICBjb25zdCBzZXNzaW9uRGF0YTogU2Vzc2lvbkRhdGEgPSB7XG4gICAgICBpZDogc2Vzc2lvbklkLFxuICAgICAgbGFuZ3VhZ2UsXG4gICAgICBjcmVhdGVkQXQ6IG5vdyxcbiAgICAgIGxhc3RBY3Rpdml0eTogbm93LFxuICAgICAgbWVzc2FnZUNvdW50OiAwLFxuICAgICAgaXNBY3RpdmU6IHRydWUsXG4gICAgICBtZXRhZGF0YTogbWV0YWRhdGEgfHwge30sXG4gICAgfTtcblxuICAgIHRyeSB7XG4gICAgICAvLyBUcnkgdG8gc3RvcmUgaW4gUmVkaXMgZmlyc3RcbiAgICAgIGNvbnN0IHJlZGlzU3RvcmVkID0gYXdhaXQgdGhpcy5yZWRpc1NlcnZpY2Uuc2V0U2Vzc2lvbihcbiAgICAgICAgc2Vzc2lvbklkLCBcbiAgICAgICAgc2Vzc2lvbkRhdGEsIFxuICAgICAgICBNYXRoLmZsb29yKGNvbmZpZy5tYXhTZXNzaW9uRHVyYXRpb24gLyAxMDAwKVxuICAgICAgKTtcblxuICAgICAgaWYgKCFyZWRpc1N0b3JlZCkge1xuICAgICAgICAvLyBGYWxsYmFjayB0byBtZW1vcnkgc3RvcmFnZVxuICAgICAgICB0aGlzLm1lbW9yeVNlc3Npb25zLnNldChzZXNzaW9uSWQsIHNlc3Npb25EYXRhKTtcbiAgICAgICAgdGhpcy5tZW1vcnlNZXNzYWdlcy5zZXQoc2Vzc2lvbklkLCBbXSk7XG4gICAgICAgIGxvZy53YXJuKCdTZXNzaW9uIHN0b3JlZCBpbiBtZW1vcnkgKFJlZGlzIHVuYXZhaWxhYmxlKScsIHsgc2Vzc2lvbklkIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gVmVyaWZ5IHN0b3JhZ2VcbiAgICAgICAgY29uc3Qgc3RvcmVkID0gdGhpcy5tZW1vcnlTZXNzaW9ucy5nZXQoc2Vzc2lvbklkKTtcbiAgICAgICAgbG9nLmluZm8oJ1Nlc3Npb24gbWVtb3J5IHN0b3JhZ2UgdmVyaWZpZWQnLCB7XG4gICAgICAgICAgc2Vzc2lvbklkOiBzZXNzaW9uSWQuc3Vic3RyaW5nKDAsIDgpICsgJy4uLicsXG4gICAgICAgICAgc3RvcmVkOiAhIXN0b3JlZCxcbiAgICAgICAgICB0b3RhbFNlc3Npb25zOiB0aGlzLm1lbW9yeVNlc3Npb25zLnNpemUsXG4gICAgICAgICAgaXNEZXZlbG9wbWVudDogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcsXG4gICAgICAgICAgdXNpbmdHbG9iYWxTdG9yYWdlOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JyAmJiB0aGlzLm1lbW9yeVNlc3Npb25zID09PSBnbG9iYWxGb3JTZXNzaW9ucy5tZW1vcnlTZXNzaW9uc1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgbG9nLmluZm8oJ1Nlc3Npb24gY3JlYXRlZCcsIHsgXG4gICAgICAgIHNlc3Npb25JZDogc2Vzc2lvbklkLnN1YnN0cmluZygwLCA4KSArICcuLi4nLFxuICAgICAgICBsYW5ndWFnZSxcbiAgICAgICAgc3RvcmFnZTogcmVkaXNTdG9yZWQgPyAncmVkaXMnIDogJ21lbW9yeSdcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gc2Vzc2lvbklkO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoJ0ZhaWxlZCB0byBjcmVhdGUgc2Vzc2lvbicsIGVycm9yIGFzIEVycm9yLCB7IHNlc3Npb25JZCB9KTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGNyZWF0ZSBzZXNzaW9uJyk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZ2V0U2Vzc2lvbihzZXNzaW9uSWQ6IHN0cmluZyk6IFByb21pc2U8U2Vzc2lvbkRhdGEgfCBudWxsPiB7XG4gICAgaWYgKCFzZXNzaW9uSWQpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAvLyBUcnkgUmVkaXMgZmlyc3RcbiAgICAgIGxldCBzZXNzaW9uRGF0YSA9IGF3YWl0IHRoaXMucmVkaXNTZXJ2aWNlLmdldFNlc3Npb24oc2Vzc2lvbklkKTtcbiAgICAgIFxuICAgICAgaWYgKCFzZXNzaW9uRGF0YSkge1xuICAgICAgICAvLyBGYWxsYmFjayB0byBtZW1vcnkgc3RvcmFnZVxuICAgICAgICBzZXNzaW9uRGF0YSA9IHRoaXMubWVtb3J5U2Vzc2lvbnMuZ2V0KHNlc3Npb25JZCkgfHwgbnVsbDtcbiAgICAgICAgaWYgKHNlc3Npb25EYXRhKSB7XG4gICAgICAgICAgLy8gVXBkYXRlIGxhc3QgYWN0aXZpdHlcbiAgICAgICAgICBzZXNzaW9uRGF0YS5sYXN0QWN0aXZpdHkgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgIHRoaXMubWVtb3J5U2Vzc2lvbnMuc2V0KHNlc3Npb25JZCwgc2Vzc2lvbkRhdGEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGxvZy53YXJuKCdTZXNzaW9uIG5vdCBmb3VuZCBpbiBtZW1vcnkgc3RvcmFnZScsIHsgXG4gICAgICAgICAgICBzZXNzaW9uSWQ6IHNlc3Npb25JZC5zdWJzdHJpbmcoMCwgOCkgKyAnLi4uJyxcbiAgICAgICAgICAgIHRvdGFsU2Vzc2lvbnNJbk1lbW9yeTogdGhpcy5tZW1vcnlTZXNzaW9ucy5zaXplLFxuICAgICAgICAgICAgYXZhaWxhYmxlU2Vzc2lvbklkczogQXJyYXkuZnJvbSh0aGlzLm1lbW9yeVNlc3Npb25zLmtleXMoKSkubWFwKGlkID0+IGlkLnN1YnN0cmluZygwLCA4KSArICcuLi4nKSxcbiAgICAgICAgICAgIGlzRGV2ZWxvcG1lbnQ6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnLFxuICAgICAgICAgICAgdXNpbmdHbG9iYWxTdG9yYWdlOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JyAmJiB0aGlzLm1lbW9yeVNlc3Npb25zID09PSBnbG9iYWxGb3JTZXNzaW9ucy5tZW1vcnlTZXNzaW9ucyxcbiAgICAgICAgICAgIGdsb2JhbFNlc3Npb25Db3VudDogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgPyBnbG9iYWxGb3JTZXNzaW9ucy5tZW1vcnlTZXNzaW9ucz8uc2l6ZSA6ICdOL0EnXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKCFzZXNzaW9uRGF0YSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgaWYgc2Vzc2lvbiBpcyBleHBpcmVkXG4gICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgICAgY29uc3QgbGFzdEFjdGl2aXR5ID0gbmV3IERhdGUoc2Vzc2lvbkRhdGEubGFzdEFjdGl2aXR5KTtcbiAgICAgIGNvbnN0IHRpbWVTaW5jZUFjdGl2aXR5ID0gbm93LmdldFRpbWUoKSAtIGxhc3RBY3Rpdml0eS5nZXRUaW1lKCk7XG4gICAgICBcbiAgICAgIGlmICh0aW1lU2luY2VBY3Rpdml0eSA+IGNvbmZpZy5tYXhTZXNzaW9uRHVyYXRpb24pIHtcbiAgICAgICAgbG9nLndhcm4oJ1Nlc3Npb24gZXhwaXJlZCcsIHsgXG4gICAgICAgICAgc2Vzc2lvbklkOiBzZXNzaW9uSWQuc3Vic3RyaW5nKDAsIDgpICsgJy4uLicsXG4gICAgICAgICAgdGltZVNpbmNlQWN0aXZpdHksXG4gICAgICAgICAgbWF4RHVyYXRpb246IGNvbmZpZy5tYXhTZXNzaW9uRHVyYXRpb25cbiAgICAgICAgfSk7XG4gICAgICAgIGF3YWl0IHRoaXMuZGVsZXRlU2Vzc2lvbihzZXNzaW9uSWQpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHNlc3Npb25EYXRhO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoJ0ZhaWxlZCB0byByZXRyaWV2ZSBzZXNzaW9uJywgZXJyb3IgYXMgRXJyb3IsIHsgc2Vzc2lvbklkIH0pO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgdXBkYXRlU2Vzc2lvbihzZXNzaW9uSWQ6IHN0cmluZywgdXBkYXRlczogUGFydGlhbDxTZXNzaW9uRGF0YT4pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgZXhpc3RpbmdTZXNzaW9uID0gYXdhaXQgdGhpcy5nZXRTZXNzaW9uKHNlc3Npb25JZCk7XG4gICAgICBpZiAoIWV4aXN0aW5nU2Vzc2lvbikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHVwZGF0ZWRTZXNzaW9uOiBTZXNzaW9uRGF0YSA9IHtcbiAgICAgICAgLi4uZXhpc3RpbmdTZXNzaW9uLFxuICAgICAgICAuLi51cGRhdGVzLFxuICAgICAgICBsYXN0QWN0aXZpdHk6IG5ldyBEYXRlKCksXG4gICAgICB9O1xuXG4gICAgICAvLyBUcnkgUmVkaXMgZmlyc3RcbiAgICAgIGNvbnN0IHJlZGlzVXBkYXRlZCA9IGF3YWl0IHRoaXMucmVkaXNTZXJ2aWNlLnNldFNlc3Npb24oXG4gICAgICAgIHNlc3Npb25JZCxcbiAgICAgICAgdXBkYXRlZFNlc3Npb24sXG4gICAgICAgIE1hdGguZmxvb3IoY29uZmlnLm1heFNlc3Npb25EdXJhdGlvbiAvIDEwMDApXG4gICAgICApO1xuXG4gICAgICBpZiAoIXJlZGlzVXBkYXRlZCkge1xuICAgICAgICAvLyBGYWxsYmFjayB0byBtZW1vcnkgc3RvcmFnZVxuICAgICAgICB0aGlzLm1lbW9yeVNlc3Npb25zLnNldChzZXNzaW9uSWQsIHVwZGF0ZWRTZXNzaW9uKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZy5lcnJvcignRmFpbGVkIHRvIHVwZGF0ZSBzZXNzaW9uJywgZXJyb3IgYXMgRXJyb3IsIHsgc2Vzc2lvbklkIH0pO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZVNlc3Npb24oc2Vzc2lvbklkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICB0cnkge1xuICAgICAgLy8gRGVsZXRlIGZyb20gUmVkaXNcbiAgICAgIGNvbnN0IHJlZGlzRGVsZXRlZCA9IGF3YWl0IHRoaXMucmVkaXNTZXJ2aWNlLmRlbGV0ZVNlc3Npb24oc2Vzc2lvbklkKTtcbiAgICAgIFxuICAgICAgLy8gRGVsZXRlIGZyb20gbWVtb3J5XG4gICAgICBjb25zdCBtZW1vcnlEZWxldGVkID0gdGhpcy5tZW1vcnlTZXNzaW9ucy5kZWxldGUoc2Vzc2lvbklkKTtcbiAgICAgIHRoaXMubWVtb3J5TWVzc2FnZXMuZGVsZXRlKHNlc3Npb25JZCk7XG5cbiAgICAgIGlmIChyZWRpc0RlbGV0ZWQgfHwgbWVtb3J5RGVsZXRlZCkge1xuICAgICAgICBsb2cuaW5mbygnU2Vzc2lvbiBkZWxldGVkJywgeyBzZXNzaW9uSWQ6IHNlc3Npb25JZC5zdWJzdHJpbmcoMCwgOCkgKyAnLi4uJyB9KTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nLmVycm9yKCdGYWlsZWQgdG8gZGVsZXRlIHNlc3Npb24nLCBlcnJvciBhcyBFcnJvciwgeyBzZXNzaW9uSWQgfSk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgYWRkTWVzc2FnZShzZXNzaW9uSWQ6IHN0cmluZywgbWVzc2FnZTogTWVzc2FnZSk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBUcnkgUmVkaXMgZmlyc3RcbiAgICAgIGNvbnN0IHJlZGlzQWRkZWQgPSBhd2FpdCB0aGlzLnJlZGlzU2VydmljZS5hZGRNZXNzYWdlKHNlc3Npb25JZCwgbWVzc2FnZSk7XG4gICAgICBcbiAgICAgIGlmICghcmVkaXNBZGRlZCkge1xuICAgICAgICAvLyBGYWxsYmFjayB0byBtZW1vcnkgc3RvcmFnZVxuICAgICAgICBpZiAoIXRoaXMubWVtb3J5TWVzc2FnZXMuaGFzKHNlc3Npb25JZCkpIHtcbiAgICAgICAgICB0aGlzLm1lbW9yeU1lc3NhZ2VzLnNldChzZXNzaW9uSWQsIFtdKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBtZXNzYWdlcyA9IHRoaXMubWVtb3J5TWVzc2FnZXMuZ2V0KHNlc3Npb25JZCkhO1xuICAgICAgICBtZXNzYWdlcy5wdXNoKG1lc3NhZ2UpO1xuICAgICAgICBcbiAgICAgICAgLy8gS2VlcCBvbmx5IGxhc3QgTUFYX01FU1NBR0VTX1BFUl9TRVNTSU9OIG1lc3NhZ2VzXG4gICAgICAgIGlmIChtZXNzYWdlcy5sZW5ndGggPiB0aGlzLk1BWF9NRVNTQUdFU19QRVJfU0VTU0lPTikge1xuICAgICAgICAgIG1lc3NhZ2VzLnNwbGljZSgwLCBtZXNzYWdlcy5sZW5ndGggLSB0aGlzLk1BWF9NRVNTQUdFU19QRVJfU0VTU0lPTik7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gVXBkYXRlIHNlc3Npb24gbWVzc2FnZSBjb3VudCBhbmQgbGFzdCBhY3Rpdml0eVxuICAgICAgYXdhaXQgdGhpcy51cGRhdGVTZXNzaW9uKHNlc3Npb25JZCwge1xuICAgICAgICBtZXNzYWdlQ291bnQ6IChhd2FpdCB0aGlzLmdldE1lc3NhZ2VzKHNlc3Npb25JZCkpLmxlbmd0aCxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nLmVycm9yKCdGYWlsZWQgdG8gYWRkIG1lc3NhZ2UgdG8gc2Vzc2lvbicsIGVycm9yIGFzIEVycm9yLCB7IHNlc3Npb25JZCB9KTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZXRNZXNzYWdlcyhzZXNzaW9uSWQ6IHN0cmluZywgbGltaXQ6IG51bWJlciA9IDUwKTogUHJvbWlzZTxNZXNzYWdlW10+IHtcbiAgICB0cnkge1xuICAgICAgLy8gVHJ5IFJlZGlzIGZpcnN0XG4gICAgICBsZXQgbWVzc2FnZXMgPSBhd2FpdCB0aGlzLnJlZGlzU2VydmljZS5nZXRNZXNzYWdlcyhzZXNzaW9uSWQsIGxpbWl0KTtcbiAgICAgIFxuICAgICAgaWYgKG1lc3NhZ2VzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAvLyBGYWxsYmFjayB0byBtZW1vcnkgc3RvcmFnZVxuICAgICAgICBjb25zdCBtZW1vcnlNZXNzYWdlcyA9IHRoaXMubWVtb3J5TWVzc2FnZXMuZ2V0KHNlc3Npb25JZCkgfHwgW107XG4gICAgICAgIG1lc3NhZ2VzID0gbWVtb3J5TWVzc2FnZXMuc2xpY2UoLWxpbWl0KTtcbiAgICAgIH1cblxuICAgICAgLy8gQ29udmVydCB0aW1lc3RhbXAgc3RyaW5ncyBiYWNrIHRvIERhdGUgb2JqZWN0cyBpZiBuZWVkZWRcbiAgICAgIHJldHVybiBtZXNzYWdlcy5tYXAobWVzc2FnZSA9PiAoe1xuICAgICAgICAuLi5tZXNzYWdlLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKG1lc3NhZ2UudGltZXN0YW1wKSxcbiAgICAgIH0pKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nLmVycm9yKCdGYWlsZWQgdG8gcmV0cmlldmUgbWVzc2FnZXMnLCBlcnJvciBhcyBFcnJvciwgeyBzZXNzaW9uSWQgfSk7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgY2xlYXJNZXNzYWdlcyhzZXNzaW9uSWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgdGhpcy5nZXRTZXNzaW9uKHNlc3Npb25JZCk7XG4gICAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuXG4gICAgICAvLyBDbGVhciBmcm9tIFJlZGlzXG4gICAgICBhd2FpdCB0aGlzLnJlZGlzU2VydmljZS5kZWxldGVDYWNoZShgbWVzc2FnZXM6JHtzZXNzaW9uSWR9YCk7XG4gICAgICBcbiAgICAgIC8vIENsZWFyIGZyb20gbWVtb3J5XG4gICAgICB0aGlzLm1lbW9yeU1lc3NhZ2VzLnNldChzZXNzaW9uSWQsIFtdKTtcblxuICAgICAgLy8gVXBkYXRlIHNlc3Npb25cbiAgICAgIGF3YWl0IHRoaXMudXBkYXRlU2Vzc2lvbihzZXNzaW9uSWQsIHsgbWVzc2FnZUNvdW50OiAwIH0pO1xuXG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nLmVycm9yKCdGYWlsZWQgdG8gY2xlYXIgbWVzc2FnZXMnLCBlcnJvciBhcyBFcnJvciwgeyBzZXNzaW9uSWQgfSk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZ2V0U2Vzc2lvblN0YXRzKCk6IFByb21pc2U8e1xuICAgIHRvdGFsQWN0aXZlU2Vzc2lvbnM6IG51bWJlcjtcbiAgICBtZW1vcnlTZXNzaW9uQ291bnQ6IG51bWJlcjtcbiAgICByZWRpc1Nlc3Npb25Db3VudDogbnVtYmVyO1xuICAgIGF2ZXJhZ2VNZXNzYWdlc1BlclNlc3Npb246IG51bWJlcjtcbiAgICBsYW5ndWFnZURpc3RyaWJ1dGlvbjogUmVjb3JkPFN1cHBvcnRlZExhbmd1YWdlLCBudW1iZXI+O1xuICB9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IG1lbW9yeVNlc3Npb25Db3VudCA9IHRoaXMubWVtb3J5U2Vzc2lvbnMuc2l6ZTtcbiAgICAgIGNvbnN0IHJlZGlzU3RhdHMgPSBhd2FpdCB0aGlzLnJlZGlzU2VydmljZS5nZXRTdGF0cygpO1xuICAgICAgY29uc3QgcmVkaXNTZXNzaW9uQ291bnQgPSByZWRpc1N0YXRzLnRvdGFsS2V5cyA/IFxuICAgICAgICBNYXRoLmZsb29yKHJlZGlzU3RhdHMudG90YWxLZXlzIC8gMikgOiAwO1xuICAgICAgXG4gICAgICAvLyBMYW5ndWFnZSBkaXN0cmlidXRpb24gZnJvbSBtZW1vcnkgc2Vzc2lvbnNcbiAgICAgIGNvbnN0IGxhbmd1YWdlRGlzdHJpYnV0aW9uOiBSZWNvcmQ8U3VwcG9ydGVkTGFuZ3VhZ2UsIG51bWJlcj4gPSB7XG4gICAgICAgIGphOiAwLFxuICAgICAgICBlbjogMCxcbiAgICAgICAgemg6IDAsXG4gICAgICAgIGtvOiAwLFxuICAgICAgfTtcblxuICAgICAgbGV0IHRvdGFsTWVzc2FnZXMgPSAwO1xuICAgICAgZm9yIChjb25zdCBbc2Vzc2lvbklkLCBzZXNzaW9uXSBvZiB0aGlzLm1lbW9yeVNlc3Npb25zLmVudHJpZXMoKSkge1xuICAgICAgICBsYW5ndWFnZURpc3RyaWJ1dGlvbltzZXNzaW9uLmxhbmd1YWdlXSsrO1xuICAgICAgICB0b3RhbE1lc3NhZ2VzICs9IHRoaXMubWVtb3J5TWVzc2FnZXMuZ2V0KHNlc3Npb25JZCk/Lmxlbmd0aCB8fCAwO1xuICAgICAgfVxuXG4gICAgICBjb25zdCB0b3RhbFNlc3Npb25zID0gbWVtb3J5U2Vzc2lvbkNvdW50ICsgcmVkaXNTZXNzaW9uQ291bnQ7XG4gICAgICBjb25zdCBhdmVyYWdlTWVzc2FnZXNQZXJTZXNzaW9uID0gdG90YWxTZXNzaW9ucyA+IDAgPyBcbiAgICAgICAgdG90YWxNZXNzYWdlcyAvIHRvdGFsU2Vzc2lvbnMgOiAwO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICB0b3RhbEFjdGl2ZVNlc3Npb25zOiB0b3RhbFNlc3Npb25zLFxuICAgICAgICBtZW1vcnlTZXNzaW9uQ291bnQsXG4gICAgICAgIHJlZGlzU2Vzc2lvbkNvdW50LFxuICAgICAgICBhdmVyYWdlTWVzc2FnZXNQZXJTZXNzaW9uOiBOdW1iZXIoYXZlcmFnZU1lc3NhZ2VzUGVyU2Vzc2lvbi50b0ZpeGVkKDIpKSxcbiAgICAgICAgbGFuZ3VhZ2VEaXN0cmlidXRpb24sXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2cuZXJyb3IoJ0ZhaWxlZCB0byBnZXQgc2Vzc2lvbiBzdGF0cycsIGVycm9yIGFzIEVycm9yKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRvdGFsQWN0aXZlU2Vzc2lvbnM6IDAsXG4gICAgICAgIG1lbW9yeVNlc3Npb25Db3VudDogMCxcbiAgICAgICAgcmVkaXNTZXNzaW9uQ291bnQ6IDAsXG4gICAgICAgIGF2ZXJhZ2VNZXNzYWdlc1BlclNlc3Npb246IDAsXG4gICAgICAgIGxhbmd1YWdlRGlzdHJpYnV0aW9uOiB7IGphOiAwLCBlbjogMCwgemg6IDAsIGtvOiAwIH0sXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGlzU2Vzc2lvbkFjdGl2ZShzZXNzaW9uSWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCB0aGlzLmdldFNlc3Npb24oc2Vzc2lvbklkKTtcbiAgICByZXR1cm4gc2Vzc2lvbiAhPT0gbnVsbCAmJiBzZXNzaW9uLmlzQWN0aXZlO1xuICB9XG5cbiAgYXN5bmMgc2V0U2Vzc2lvbkxhbmd1YWdlKHNlc3Npb25JZDogc3RyaW5nLCBsYW5ndWFnZTogU3VwcG9ydGVkTGFuZ3VhZ2UpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICByZXR1cm4gdGhpcy51cGRhdGVTZXNzaW9uKHNlc3Npb25JZCwgeyBsYW5ndWFnZSB9KTtcbiAgfVxuXG4gIC8vIExlZ2FjeSBtZXRob2RzIGZvciBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eVxuICBnZXRTZXNzaW9uQ291bnQoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5tZW1vcnlTZXNzaW9ucy5zaXplO1xuICB9XG5cbiAgZ2V0QWxsU2Vzc2lvbnMoKTogU2Vzc2lvbkRhdGFbXSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5tZW1vcnlTZXNzaW9ucy52YWx1ZXMoKSk7XG4gIH1cblxuICBhc3luYyBjbGVhbnVwKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIC8vIENsZWFyIGNsZWFudXAgaW50ZXJ2YWxzXG4gICAgaWYgKHRoaXMuY2xlYW51cEludGVydmFsKSB7XG4gICAgICBjbGVhckludGVydmFsKHRoaXMuY2xlYW51cEludGVydmFsKTtcbiAgICAgIHRoaXMuY2xlYW51cEludGVydmFsID0gbnVsbDtcbiAgICB9XG4gICAgXG4gICAgaWYgKHRoaXMuZ2NJbnRlcnZhbCkge1xuICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmdjSW50ZXJ2YWwpO1xuICAgICAgdGhpcy5nY0ludGVydmFsID0gbnVsbDtcbiAgICB9XG4gICAgXG4gICAgLy8gQ2xlYXIgZ2xvYmFsIGNsZWFudXAgaW50ZXJ2YWwgaW4gZGV2ZWxvcG1lbnRcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgJiYgZ2xvYmFsRm9yU2Vzc2lvbnMuY2xlYW51cEludGVydmFsKSB7XG4gICAgICBjbGVhckludGVydmFsKGdsb2JhbEZvclNlc3Npb25zLmNsZWFudXBJbnRlcnZhbCk7XG4gICAgICBnbG9iYWxGb3JTZXNzaW9ucy5jbGVhbnVwSW50ZXJ2YWwgPSBudWxsO1xuICAgIH1cbiAgICBcbiAgICAvLyBDbGVhciBtZW1vcnkgc3RvcmFnZVxuICAgIHRoaXMubWVtb3J5U2Vzc2lvbnMuY2xlYXIoKTtcbiAgICB0aGlzLm1lbW9yeU1lc3NhZ2VzLmNsZWFyKCk7XG4gICAgXG4gICAgLy8gQ2xlYXIgZ2xvYmFsIHN0b3JhZ2UgaW4gZGV2ZWxvcG1lbnRcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcpIHtcbiAgICAgIGdsb2JhbEZvclNlc3Npb25zLm1lbW9yeVNlc3Npb25zPy5jbGVhcigpO1xuICAgICAgZ2xvYmFsRm9yU2Vzc2lvbnMubWVtb3J5TWVzc2FnZXM/LmNsZWFyKCk7XG4gICAgfVxuICAgIFxuICAgIC8vIENsZWFudXAgUmVkaXMgc2VydmljZVxuICAgIGF3YWl0IHRoaXMucmVkaXNTZXJ2aWNlLmNsZWFudXAoKTtcbiAgICBcbiAgICBsb2cuaW5mbygnU2Vzc2lvbk1hbmFnZXIgY2xlYW51cCBjb21wbGV0ZWQnKTtcbiAgfVxuXG4gIC8vIE1lbW9yeSB1c2FnZSBtb25pdG9yaW5nXG4gIGdldE1lbW9yeVVzYWdlKCk6IHtcbiAgICBzZXNzaW9uQ291bnQ6IG51bWJlcjtcbiAgICBtZXNzYWdlU2V0Q291bnQ6IG51bWJlcjtcbiAgICBlc3RpbWF0ZWRNZW1vcnlNQjogbnVtYmVyO1xuICAgIGlzTmVhckxpbWl0OiBib29sZWFuO1xuICB9IHtcbiAgICBjb25zdCBzZXNzaW9uQ291bnQgPSB0aGlzLm1lbW9yeVNlc3Npb25zLnNpemU7XG4gICAgY29uc3QgbWVzc2FnZVNldENvdW50ID0gdGhpcy5tZW1vcnlNZXNzYWdlcy5zaXplO1xuICAgIFxuICAgIC8vIFJvdWdoIGVzdGltYXRpb246IGVhY2ggc2Vzc2lvbiB+MUtCLCBlYWNoIG1lc3NhZ2UgfjAuNUtCXG4gICAgbGV0IHRvdGFsTWVzc2FnZXMgPSAwO1xuICAgIGZvciAoY29uc3QgbWVzc2FnZXMgb2YgdGhpcy5tZW1vcnlNZXNzYWdlcy52YWx1ZXMoKSkge1xuICAgICAgdG90YWxNZXNzYWdlcyArPSBtZXNzYWdlcy5sZW5ndGg7XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IGVzdGltYXRlZE1lbW9yeU1CID0gTWF0aC5yb3VuZChcbiAgICAgIChzZXNzaW9uQ291bnQgKiAxICsgdG90YWxNZXNzYWdlcyAqIDAuNSkgLyAxMDI0XG4gICAgKTtcbiAgICBcbiAgICBjb25zdCBpc05lYXJMaW1pdCA9IHNlc3Npb25Db3VudCA+IHRoaXMuTUFYX01FTU9SWV9TRVNTSU9OUyAqIDAuODtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgc2Vzc2lvbkNvdW50LFxuICAgICAgbWVzc2FnZVNldENvdW50LFxuICAgICAgZXN0aW1hdGVkTWVtb3J5TUIsXG4gICAgICBpc05lYXJMaW1pdCxcbiAgICB9O1xuICB9XG59Il0sIm5hbWVzIjpbInY0IiwidXVpZHY0IiwiZ2V0UmVkaXNTZXJ2aWNlIiwibG9nIiwiY29uZmlnIiwiZ2xvYmFsRm9yU2Vzc2lvbnMiLCJnbG9iYWxUaGlzIiwiU2Vzc2lvbk1hbmFnZXIiLCJyZWRpc1NlcnZpY2UiLCJjbGVhbnVwSW50ZXJ2YWwiLCJnY0ludGVydmFsIiwiTUFYX01FTU9SWV9TRVNTSU9OUyIsIk1BWF9NRVNTQUdFU19QRVJfU0VTU0lPTiIsInByb2Nlc3MiLCJtZW1vcnlTZXNzaW9ucyIsIk1hcCIsIm1lbW9yeU1lc3NhZ2VzIiwiaW5mbyIsInN0YXJ0Q2xlYW51cFByb2Nlc3MiLCJnZXRJbnN0YW5jZSIsImluc3RhbmNlIiwiaW50ZXJ2YWwiLCJzZXRJbnRlcnZhbCIsImNsZWFudXBFeHBpcmVkU2Vzc2lvbnMiLCJnbG9iYWwiLCJnYyIsImRlYnVnIiwiZXJyb3IiLCJub3ciLCJEYXRlIiwiZXhwaXJlZFNlc3Npb25zIiwib2xkU2Vzc2lvbnMiLCJzZXNzaW9uSWQiLCJzZXNzaW9uIiwiZW50cmllcyIsInRpbWVTaW5jZUFjdGl2aXR5IiwiZ2V0VGltZSIsImxhc3RBY3Rpdml0eSIsIm1heFNlc3Npb25EdXJhdGlvbiIsInB1c2giLCJzaXplIiwic29ydCIsImEiLCJiIiwic2Vzc2lvbnNUb1JlbW92ZSIsInNsaWNlIiwibGVuZ3RoIiwid2FybiIsInN1YnN0cmluZyIsImJhdGNoU2l6ZSIsImkiLCJiYXRjaCIsIlByb21pc2UiLCJhbGwiLCJtYXAiLCJkZWxldGVTZXNzaW9uIiwicmVzb2x2ZSIsInNldEltbWVkaWF0ZSIsIm9ycGhhbmVkTWVzc2FnZVNlc3Npb25zIiwia2V5cyIsImhhcyIsImRlbGV0ZSIsImNyZWF0ZVNlc3Npb24iLCJsYW5ndWFnZSIsIm1ldGFkYXRhIiwic2Vzc2lvbkRhdGEiLCJpZCIsImNyZWF0ZWRBdCIsIm1lc3NhZ2VDb3VudCIsImlzQWN0aXZlIiwicmVkaXNTdG9yZWQiLCJzZXRTZXNzaW9uIiwiTWF0aCIsImZsb29yIiwic2V0Iiwic3RvcmVkIiwiZ2V0IiwidG90YWxTZXNzaW9ucyIsImlzRGV2ZWxvcG1lbnQiLCJ1c2luZ0dsb2JhbFN0b3JhZ2UiLCJzdG9yYWdlIiwiRXJyb3IiLCJnZXRTZXNzaW9uIiwidG90YWxTZXNzaW9uc0luTWVtb3J5IiwiYXZhaWxhYmxlU2Vzc2lvbklkcyIsIkFycmF5IiwiZnJvbSIsImdsb2JhbFNlc3Npb25Db3VudCIsIm1heER1cmF0aW9uIiwidXBkYXRlU2Vzc2lvbiIsInVwZGF0ZXMiLCJleGlzdGluZ1Nlc3Npb24iLCJ1cGRhdGVkU2Vzc2lvbiIsInJlZGlzVXBkYXRlZCIsInJlZGlzRGVsZXRlZCIsIm1lbW9yeURlbGV0ZWQiLCJhZGRNZXNzYWdlIiwibWVzc2FnZSIsInJlZGlzQWRkZWQiLCJtZXNzYWdlcyIsInNwbGljZSIsImdldE1lc3NhZ2VzIiwibGltaXQiLCJ0aW1lc3RhbXAiLCJjbGVhck1lc3NhZ2VzIiwiZGVsZXRlQ2FjaGUiLCJnZXRTZXNzaW9uU3RhdHMiLCJtZW1vcnlTZXNzaW9uQ291bnQiLCJyZWRpc1N0YXRzIiwiZ2V0U3RhdHMiLCJyZWRpc1Nlc3Npb25Db3VudCIsInRvdGFsS2V5cyIsImxhbmd1YWdlRGlzdHJpYnV0aW9uIiwiamEiLCJlbiIsInpoIiwia28iLCJ0b3RhbE1lc3NhZ2VzIiwiYXZlcmFnZU1lc3NhZ2VzUGVyU2Vzc2lvbiIsInRvdGFsQWN0aXZlU2Vzc2lvbnMiLCJOdW1iZXIiLCJ0b0ZpeGVkIiwiaXNTZXNzaW9uQWN0aXZlIiwic2V0U2Vzc2lvbkxhbmd1YWdlIiwiZ2V0U2Vzc2lvbkNvdW50IiwiZ2V0QWxsU2Vzc2lvbnMiLCJ2YWx1ZXMiLCJjbGVhbnVwIiwiY2xlYXJJbnRlcnZhbCIsImNsZWFyIiwiZ2V0TWVtb3J5VXNhZ2UiLCJzZXNzaW9uQ291bnQiLCJtZXNzYWdlU2V0Q291bnQiLCJlc3RpbWF0ZWRNZW1vcnlNQiIsInJvdW5kIiwiaXNOZWFyTGltaXQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/services/SessionManager.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/validation.ts":
/*!*******************************!*\
  !*** ./src/lib/validation.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   checkRateLimit: () => (/* binding */ checkRateLimit),\n/* harmony export */   cleanupRateLimit: () => (/* binding */ cleanupRateLimit),\n/* harmony export */   sanitizeHtmlContent: () => (/* binding */ sanitizeHtmlContent),\n/* harmony export */   validateAndSanitizeText: () => (/* binding */ validateAndSanitizeText),\n/* harmony export */   validateAudioFile: () => (/* binding */ validateAudioFile),\n/* harmony export */   validateChatRequest: () => (/* binding */ validateChatRequest),\n/* harmony export */   validateLanguage: () => (/* binding */ validateLanguage),\n/* harmony export */   validateLocation: () => (/* binding */ validateLocation),\n/* harmony export */   validateRequestedScope: () => (/* binding */ validateRequestedScope),\n/* harmony export */   validateSessionId: () => (/* binding */ validateSessionId)\n/* harmony export */ });\n/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./config */ \"(rsc)/./src/lib/config.ts\");\n\n// Text sanitization and validation\nconst validateAndSanitizeText = (input, fieldName = \"text\")=>{\n    const errors = [];\n    // Check if input exists\n    if (!input || typeof input !== \"string\") {\n        return {\n            isValid: false,\n            errors: [\n                `${fieldName} is required and must be a string`\n            ]\n        };\n    }\n    // Trim whitespace\n    let sanitized = input.trim();\n    // Check length\n    if (sanitized.length === 0) {\n        errors.push(`${fieldName} cannot be empty`);\n    }\n    if (sanitized.length > _config__WEBPACK_IMPORTED_MODULE_0__.securityConfig.validation.maxMessageLength) {\n        errors.push(`${fieldName} exceeds maximum length of ${_config__WEBPACK_IMPORTED_MODULE_0__.securityConfig.validation.maxMessageLength} characters`);\n    }\n    // Remove dangerous characters and patterns\n    // Remove control characters except newline, tab, and carriage return\n    sanitized = sanitized.replace(/[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7F]/g, \"\");\n    // Enhanced XSS protection\n    const xssPatterns = [\n        // Script tags (various forms)\n        /<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi,\n        /<\\/script>/gi,\n        /<script[^>]*>/gi,\n        // Javascript protocols\n        /javascript:/gi,\n        /vbscript:/gi,\n        /data:text\\/html/gi,\n        // Event handlers\n        /on\\w+\\s*=/gi,\n        // HTML tags that can execute JavaScript\n        /<iframe\\b[^>]*>/gi,\n        /<object\\b[^>]*>/gi,\n        /<embed\\b[^>]*>/gi,\n        /<link\\b[^>]*>/gi,\n        /<meta\\b[^>]*>/gi,\n        /<form\\b[^>]*>/gi,\n        // Style with expression\n        /style\\s*=.*expression\\s*\\(/gi,\n        // HTML entities that might be used for XSS\n        /&\\#x?[0-9a-f]+;?/gi\n    ];\n    let hadXssContent = false;\n    xssPatterns.forEach((pattern)=>{\n        if (pattern.test(sanitized)) {\n            hadXssContent = true;\n            sanitized = sanitized.replace(pattern, \"\");\n        }\n    });\n    if (hadXssContent) {\n        errors.push(`${fieldName} contained potentially malicious content that was removed`);\n    }\n    // Enhanced SQL injection protection\n    const sqlPatterns = [\n        // SQL keywords\n        /(\\b(SELECT|INSERT|UPDATE|DELETE|DROP|CREATE|ALTER|EXEC|EXECUTE|UNION|TRUNCATE|GRANT|REVOKE)\\b)/gi,\n        // SQL comments and terminators\n        /(--|\\/\\*|\\*\\/|;)/g,\n        // SQL injection patterns\n        /(\\b(OR|AND)\\s+\\w+\\s*=\\s*\\w+)/gi,\n        /(\\b(OR|AND)\\s+1\\s*=\\s*1)/gi,\n        /(\\b(OR|AND)\\s+\\w+\\s*(LIKE|IN|IS))/gi,\n        // Union-based injection\n        /UNION\\s+SELECT/gi,\n        // Information schema access\n        /information_schema/gi,\n        // System functions\n        /(LOAD_FILE|INTO\\s+OUTFILE|INTO\\s+DUMPFILE)/gi,\n        // Hex encoding patterns\n        /0x[0-9a-f]+/gi\n    ];\n    let hadSqlContent = false;\n    sqlPatterns.forEach((pattern)=>{\n        if (pattern.test(sanitized)) {\n            hadSqlContent = true;\n        }\n    });\n    if (hadSqlContent) {\n        errors.push(`${fieldName} contains potentially dangerous SQL patterns`);\n    }\n    // Path traversal protection\n    const pathTraversalPatterns = [\n        /\\.\\.\\//g,\n        /\\.\\.\\\\/g,\n        /%2e%2e%2f/gi,\n        /%2e%2e%5c/gi,\n        /\\.\\.%2f/gi,\n        /\\.\\.%5c/gi\n    ];\n    let hadPathTraversal = false;\n    pathTraversalPatterns.forEach((pattern)=>{\n        if (pattern.test(sanitized)) {\n            hadPathTraversal = true;\n        }\n    });\n    if (hadPathTraversal) {\n        errors.push(`${fieldName} contains path traversal patterns`);\n    }\n    // LDAP injection protection\n    const ldapPatterns = [\n        /[()\\\\*\\x00]/g\n    ];\n    let hadLdapContent = false;\n    ldapPatterns.forEach((pattern)=>{\n        if (pattern.test(sanitized)) {\n            hadLdapContent = true;\n        }\n    });\n    if (hadLdapContent) {\n        errors.push(`${fieldName} contains LDAP injection patterns`);\n    }\n    // Check for excessive repetition (potential spam)\n    const repeatedPattern = /(.)\\1{20,}/;\n    if (repeatedPattern.test(sanitized)) {\n        errors.push(`${fieldName} contains excessive character repetition`);\n    }\n    // Final safety check: ensure no null bytes or excessive whitespace\n    sanitized = sanitized.replace(/\\0/g, \"\");\n    sanitized = sanitized.replace(/\\s{10,}/g, \" \"); // Replace excessive whitespace\n    // Check for encoded attacks\n    const encodedPatterns = [\n        /%3c/gi,\n        /%3e/gi,\n        /%22/gi,\n        /%27/gi,\n        /%28/gi,\n        /%29/gi,\n        /%3b/gi\n    ];\n    let hadEncodedAttack = false;\n    encodedPatterns.forEach((pattern)=>{\n        if (pattern.test(sanitized)) {\n            hadEncodedAttack = true;\n        }\n    });\n    if (hadEncodedAttack) {\n        errors.push(`${fieldName} contains URL-encoded potentially dangerous content`);\n    }\n    return {\n        isValid: errors.length === 0,\n        errors,\n        sanitized: errors.length === 0 ? sanitized : undefined\n    };\n};\n// Additional sanitization for HTML content (if needed)\nconst sanitizeHtmlContent = (input)=>{\n    if (!input) return \"\";\n    // Basic HTML entity encoding for dangerous characters\n    const htmlEntities = {\n        \"&\": \"&amp;\",\n        \"<\": \"&lt;\",\n        \">\": \"&gt;\",\n        '\"': \"&quot;\",\n        \"'\": \"&#x27;\",\n        \"/\": \"&#x2F;\"\n    };\n    return input.replace(/[&<>\"'/]/g, (char)=>htmlEntities[char] || char);\n};\n// Session ID validation\nconst validateSessionId = (sessionId)=>{\n    const errors = [];\n    if (!sessionId || typeof sessionId !== \"string\") {\n        return {\n            isValid: false,\n            errors: [\n                \"Session ID is required\"\n            ]\n        };\n    }\n    // Check format (UUID v4 format)\n    const uuidPattern = /^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;\n    if (!uuidPattern.test(sessionId)) {\n        errors.push(\"Invalid session ID format\");\n    }\n    return {\n        isValid: errors.length === 0,\n        errors,\n        sanitized: sessionId\n    };\n};\n// Language validation\nconst validateLanguage = (language)=>{\n    const supportedLanguages = [\n        \"ja\",\n        \"en\",\n        \"zh\",\n        \"ko\"\n    ];\n    const errors = [];\n    if (!language || typeof language !== \"string\") {\n        return {\n            isValid: false,\n            errors: [\n                \"Language is required\"\n            ]\n        };\n    }\n    const sanitized = language.toLowerCase().trim();\n    if (!supportedLanguages.includes(sanitized)) {\n        errors.push(`Unsupported language: ${language}. Supported languages: ${supportedLanguages.join(\", \")}`);\n    }\n    return {\n        isValid: errors.length === 0,\n        errors,\n        sanitized: errors.length === 0 ? sanitized : undefined\n    };\n};\n// Audio file validation\nconst validateAudioFile = (file)=>{\n    const errors = [];\n    // Check file size\n    if (file.size > _config__WEBPACK_IMPORTED_MODULE_0__.securityConfig.validation.maxFileSize) {\n        errors.push(`File size exceeds maximum limit of ${_config__WEBPACK_IMPORTED_MODULE_0__.securityConfig.validation.maxFileSize / 1024 / 1024}MB`);\n    }\n    // Check MIME type\n    if (!_config__WEBPACK_IMPORTED_MODULE_0__.securityConfig.validation.allowedAudioTypes.includes(file.type)) {\n        errors.push(`Unsupported audio format: ${file.type}. Allowed formats: ${_config__WEBPACK_IMPORTED_MODULE_0__.securityConfig.validation.allowedAudioTypes.join(\", \")}`);\n    }\n    // Validate base64 data\n    try {\n        const base64Pattern = /^[A-Za-z0-9+/]*={0,2}$/;\n        if (!base64Pattern.test(file.data)) {\n            errors.push(\"Invalid audio data format\");\n        }\n    } catch  {\n        errors.push(\"Invalid audio data\");\n    }\n    return {\n        isValid: errors.length === 0,\n        errors\n    };\n};\n// Request body validation for chat endpoint\nconst validateChatRequest = (body)=>{\n    const errors = [];\n    if (!body || typeof body !== \"object\") {\n        return {\n            isValid: false,\n            errors: [\n                \"Request body is required\"\n            ]\n        };\n    }\n    // Validate message\n    const messageValidation = validateAndSanitizeText(body.message, \"message\");\n    if (!messageValidation.isValid) {\n        errors.push(...messageValidation.errors);\n    }\n    // Validate session ID\n    const sessionValidation = validateSessionId(body.sessionId);\n    if (!sessionValidation.isValid) {\n        errors.push(...sessionValidation.errors);\n    }\n    // Validate language (optional)\n    let languageValidation;\n    if (body.language) {\n        languageValidation = validateLanguage(body.language);\n        if (!languageValidation.isValid) {\n            errors.push(...languageValidation.errors);\n        }\n    }\n    // Validate boolean fields\n    if (body.useVoice !== undefined && typeof body.useVoice !== \"boolean\") {\n        errors.push(\"useVoice must be a boolean\");\n    }\n    // Validate inputType (optional)\n    if (body.inputType !== undefined && ![\n        \"text\",\n        \"voice\"\n    ].includes(body.inputType)) {\n        errors.push('inputType must be either \"text\" or \"voice\"');\n    }\n    // Validate location (optional)\n    let locationValidation;\n    if (body.location) {\n        locationValidation = validateLocation(body.location);\n        if (!locationValidation.isValid) {\n            errors.push(...locationValidation.errors);\n        }\n    }\n    // Validate requestedScope (optional)\n    let scopeValidation;\n    if (body.requestedScope) {\n        scopeValidation = validateRequestedScope(body.requestedScope);\n        if (!scopeValidation.isValid) {\n            errors.push(...scopeValidation.errors);\n        }\n    }\n    return {\n        isValid: errors.length === 0,\n        errors,\n        sanitized: errors.length === 0 && messageValidation.sanitized && sessionValidation.sanitized ? {\n            message: messageValidation.sanitized,\n            sessionId: sessionValidation.sanitized,\n            language: body.language ? languageValidation?.sanitized || \"ja\" : \"ja\",\n            useVoice: Boolean(body.useVoice),\n            inputType: body.inputType || \"text\",\n            location: locationValidation?.sanitized,\n            requestedScope: scopeValidation?.sanitized\n        } : undefined\n    };\n};\n// Rate limiting check (simple in-memory implementation)\nconst rateLimitStore = new Map();\nconst checkRateLimit = (identifier)=>{\n    const now = Date.now();\n    const windowMs = _config__WEBPACK_IMPORTED_MODULE_0__.securityConfig.rateLimiting.windowMs;\n    const maxRequests = _config__WEBPACK_IMPORTED_MODULE_0__.securityConfig.rateLimiting.maxRequests;\n    const current = rateLimitStore.get(identifier);\n    if (!current || now > current.resetTime) {\n        // First request or window expired\n        rateLimitStore.set(identifier, {\n            count: 1,\n            resetTime: now + windowMs\n        });\n        return {\n            allowed: true\n        };\n    }\n    if (current.count >= maxRequests) {\n        return {\n            allowed: false,\n            retryAfter: Math.ceil((current.resetTime - now) / 1000)\n        };\n    }\n    // Increment counter\n    current.count++;\n    rateLimitStore.set(identifier, current);\n    return {\n        allowed: true\n    };\n};\n// Location validation\nconst validateLocation = (location)=>{\n    const errors = [];\n    if (!location || typeof location !== \"object\") {\n        return {\n            isValid: false,\n            errors: [\n                \"Location must be an object\"\n            ]\n        };\n    }\n    // Validate latitude\n    if (typeof location.latitude !== \"number\") {\n        errors.push(\"Latitude must be a number\");\n    } else if (location.latitude < -90 || location.latitude > 90) {\n        errors.push(\"Latitude must be between -90 and 90 degrees\");\n    }\n    // Validate longitude\n    if (typeof location.longitude !== \"number\") {\n        errors.push(\"Longitude must be a number\");\n    } else if (location.longitude < -180 || location.longitude > 180) {\n        errors.push(\"Longitude must be between -180 and 180 degrees\");\n    }\n    // Validate accuracy (optional)\n    if (location.accuracy !== undefined && (typeof location.accuracy !== \"number\" || location.accuracy < 0)) {\n        errors.push(\"Accuracy must be a positive number\");\n    }\n    // Validate timestamp (optional)\n    if (location.timestamp !== undefined) {\n        try {\n            new Date(location.timestamp);\n        } catch  {\n            errors.push(\"Invalid timestamp format\");\n        }\n    }\n    return {\n        isValid: errors.length === 0,\n        errors,\n        sanitized: errors.length === 0 ? {\n            latitude: location.latitude,\n            longitude: location.longitude,\n            accuracy: location.accuracy,\n            timestamp: location.timestamp ? new Date(location.timestamp) : undefined\n        } : undefined\n    };\n};\n// Requested scope validation\nconst validateRequestedScope = (scope)=>{\n    const errors = [];\n    if (!scope || typeof scope !== \"object\") {\n        return {\n            isValid: true,\n            errors: []\n        }; // Optional field\n    }\n    const validTimeRanges = [\n        \"today\",\n        \"this_week\",\n        \"this_month\",\n        \"next_month\",\n        \"any\"\n    ];\n    const validLocationRanges = [\n        \"nearby\",\n        \"walking_distance\",\n        \"cycling_distance\",\n        \"city_wide\",\n        \"any\"\n    ];\n    // Validate timeRange (optional)\n    if (scope.timeRange !== undefined && !validTimeRanges.includes(scope.timeRange)) {\n        errors.push(`Invalid timeRange. Must be one of: ${validTimeRanges.join(\", \")}`);\n    }\n    // Validate locationRange (optional)\n    if (scope.locationRange !== undefined && !validLocationRanges.includes(scope.locationRange)) {\n        errors.push(`Invalid locationRange. Must be one of: ${validLocationRanges.join(\", \")}`);\n    }\n    return {\n        isValid: errors.length === 0,\n        errors,\n        sanitized: errors.length === 0 ? {\n            timeRange: scope.timeRange,\n            locationRange: scope.locationRange\n        } : undefined\n    };\n};\n// Cleanup expired rate limit entries (should be called periodically)\nconst cleanupRateLimit = ()=>{\n    const now = Date.now();\n    for (const [key, value] of rateLimitStore.entries()){\n        if (now > value.resetTime) {\n            rateLimitStore.delete(key);\n        }\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFNRyxTQUFTO1lBQzFCQyxlQUFlSixNQUFNSSxhQUFhO1FBQ3BDLElBQUk5RDtJQUNOO0FBQ0YsRUFBRTtBQUVGLHFFQUFxRTtBQUM5RCxNQUFNK0QsbUJBQW1CO0lBQzlCLE1BQU12QixNQUFNQyxLQUFLRCxHQUFHO0lBQ3BCLEtBQUssTUFBTSxDQUFDd0IsS0FBS0MsTUFBTSxJQUFJN0IsZUFBZThCLE9BQU8sR0FBSTtRQUNuRCxJQUFJMUIsTUFBTXlCLE1BQU1sQixTQUFTLEVBQUU7WUFDekJYLGVBQWUrQixNQUFNLENBQUNIO1FBQ3hCO0lBQ0Y7QUFDRixFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdG9reW8tb3BlbmRhdGEtaGFja2F0aG9uLy4vc3JjL2xpYi92YWxpZGF0aW9uLnRzPzQ2MGYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc2VjdXJpdHlDb25maWcgfSBmcm9tICcuL2NvbmZpZyc7XG5cbi8vIElucHV0IHZhbGlkYXRpb24gdXRpbGl0aWVzXG5leHBvcnQgaW50ZXJmYWNlIFZhbGlkYXRpb25SZXN1bHQge1xuICBpc1ZhbGlkOiBib29sZWFuO1xuICBlcnJvcnM6IHN0cmluZ1tdO1xuICBzYW5pdGl6ZWQ/OiBhbnk7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2hhdFJlcXVlc3RWYWxpZGF0aW9uUmVzdWx0IHtcbiAgaXNWYWxpZDogYm9vbGVhbjtcbiAgZXJyb3JzOiBzdHJpbmdbXTtcbiAgc2FuaXRpemVkPzoge1xuICAgIG1lc3NhZ2U6IHN0cmluZztcbiAgICBzZXNzaW9uSWQ6IHN0cmluZztcbiAgICBsYW5ndWFnZTogc3RyaW5nO1xuICAgIHVzZVZvaWNlOiBib29sZWFuO1xuICAgIGlucHV0VHlwZT86ICd0ZXh0JyB8ICd2b2ljZSc7XG4gICAgbG9jYXRpb24/OiB7XG4gICAgICBsYXRpdHVkZTogbnVtYmVyO1xuICAgICAgbG9uZ2l0dWRlOiBudW1iZXI7XG4gICAgICBhY2N1cmFjeT86IG51bWJlcjtcbiAgICAgIHRpbWVzdGFtcD86IERhdGU7XG4gICAgfTtcbiAgICByZXF1ZXN0ZWRTY29wZT86IHtcbiAgICAgIHRpbWVSYW5nZT86ICd0b2RheScgfCAndGhpc193ZWVrJyB8ICd0aGlzX21vbnRoJyB8ICduZXh0X21vbnRoJyB8ICdhbnknO1xuICAgICAgbG9jYXRpb25SYW5nZT86ICduZWFyYnknIHwgJ3dhbGtpbmdfZGlzdGFuY2UnIHwgJ2N5Y2xpbmdfZGlzdGFuY2UnIHwgJ2NpdHlfd2lkZScgfCAnYW55JztcbiAgICB9O1xuICB9O1xufVxuXG4vLyBUZXh0IHNhbml0aXphdGlvbiBhbmQgdmFsaWRhdGlvblxuZXhwb3J0IGNvbnN0IHZhbGlkYXRlQW5kU2FuaXRpemVUZXh0ID0gKGlucHV0OiBzdHJpbmcsIGZpZWxkTmFtZTogc3RyaW5nID0gJ3RleHQnKTogVmFsaWRhdGlvblJlc3VsdCA9PiB7XG4gIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXTtcbiAgXG4gIC8vIENoZWNrIGlmIGlucHV0IGV4aXN0c1xuICBpZiAoIWlucHV0IHx8IHR5cGVvZiBpbnB1dCAhPT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4geyBpc1ZhbGlkOiBmYWxzZSwgZXJyb3JzOiBbYCR7ZmllbGROYW1lfSBpcyByZXF1aXJlZCBhbmQgbXVzdCBiZSBhIHN0cmluZ2BdIH07XG4gIH1cbiAgXG4gIC8vIFRyaW0gd2hpdGVzcGFjZVxuICBsZXQgc2FuaXRpemVkID0gaW5wdXQudHJpbSgpO1xuICBcbiAgLy8gQ2hlY2sgbGVuZ3RoXG4gIGlmIChzYW5pdGl6ZWQubGVuZ3RoID09PSAwKSB7XG4gICAgZXJyb3JzLnB1c2goYCR7ZmllbGROYW1lfSBjYW5ub3QgYmUgZW1wdHlgKTtcbiAgfVxuICBcbiAgaWYgKHNhbml0aXplZC5sZW5ndGggPiBzZWN1cml0eUNvbmZpZy52YWxpZGF0aW9uLm1heE1lc3NhZ2VMZW5ndGgpIHtcbiAgICBlcnJvcnMucHVzaChgJHtmaWVsZE5hbWV9IGV4Y2VlZHMgbWF4aW11bSBsZW5ndGggb2YgJHtzZWN1cml0eUNvbmZpZy52YWxpZGF0aW9uLm1heE1lc3NhZ2VMZW5ndGh9IGNoYXJhY3RlcnNgKTtcbiAgfVxuICBcbiAgLy8gUmVtb3ZlIGRhbmdlcm91cyBjaGFyYWN0ZXJzIGFuZCBwYXR0ZXJuc1xuICAvLyBSZW1vdmUgY29udHJvbCBjaGFyYWN0ZXJzIGV4Y2VwdCBuZXdsaW5lLCB0YWIsIGFuZCBjYXJyaWFnZSByZXR1cm5cbiAgc2FuaXRpemVkID0gc2FuaXRpemVkLnJlcGxhY2UoL1tcXHgwMC1cXHgwOFxceDBCXFx4MENcXHgwRS1cXHgxRlxceDdGXS9nLCAnJyk7XG4gIFxuICAvLyBFbmhhbmNlZCBYU1MgcHJvdGVjdGlvblxuICBjb25zdCB4c3NQYXR0ZXJucyA9IFtcbiAgICAvLyBTY3JpcHQgdGFncyAodmFyaW91cyBmb3JtcylcbiAgICAvPHNjcmlwdFxcYltePF0qKD86KD8hPFxcL3NjcmlwdD4pPFtePF0qKSo8XFwvc2NyaXB0Pi9naSxcbiAgICAvPFxcL3NjcmlwdD4vZ2ksXG4gICAgLzxzY3JpcHRbXj5dKj4vZ2ksXG4gICAgXG4gICAgLy8gSmF2YXNjcmlwdCBwcm90b2NvbHNcbiAgICAvamF2YXNjcmlwdDovZ2ksXG4gICAgL3Zic2NyaXB0Oi9naSxcbiAgICAvZGF0YTp0ZXh0XFwvaHRtbC9naSxcbiAgICBcbiAgICAvLyBFdmVudCBoYW5kbGVyc1xuICAgIC9vblxcdytcXHMqPS9naSxcbiAgICBcbiAgICAvLyBIVE1MIHRhZ3MgdGhhdCBjYW4gZXhlY3V0ZSBKYXZhU2NyaXB0XG4gICAgLzxpZnJhbWVcXGJbXj5dKj4vZ2ksXG4gICAgLzxvYmplY3RcXGJbXj5dKj4vZ2ksXG4gICAgLzxlbWJlZFxcYltePl0qPi9naSxcbiAgICAvPGxpbmtcXGJbXj5dKj4vZ2ksXG4gICAgLzxtZXRhXFxiW14+XSo+L2dpLFxuICAgIC88Zm9ybVxcYltePl0qPi9naSxcbiAgICBcbiAgICAvLyBTdHlsZSB3aXRoIGV4cHJlc3Npb25cbiAgICAvc3R5bGVcXHMqPS4qZXhwcmVzc2lvblxccypcXCgvZ2ksXG4gICAgXG4gICAgLy8gSFRNTCBlbnRpdGllcyB0aGF0IG1pZ2h0IGJlIHVzZWQgZm9yIFhTU1xuICAgIC8mXFwjeD9bMC05YS1mXSs7Py9naSxcbiAgXTtcbiAgXG4gIGxldCBoYWRYc3NDb250ZW50ID0gZmFsc2U7XG4gIHhzc1BhdHRlcm5zLmZvckVhY2gocGF0dGVybiA9PiB7XG4gICAgaWYgKHBhdHRlcm4udGVzdChzYW5pdGl6ZWQpKSB7XG4gICAgICBoYWRYc3NDb250ZW50ID0gdHJ1ZTtcbiAgICAgIHNhbml0aXplZCA9IHNhbml0aXplZC5yZXBsYWNlKHBhdHRlcm4sICcnKTtcbiAgICB9XG4gIH0pO1xuICBcbiAgaWYgKGhhZFhzc0NvbnRlbnQpIHtcbiAgICBlcnJvcnMucHVzaChgJHtmaWVsZE5hbWV9IGNvbnRhaW5lZCBwb3RlbnRpYWxseSBtYWxpY2lvdXMgY29udGVudCB0aGF0IHdhcyByZW1vdmVkYCk7XG4gIH1cbiAgXG4gIC8vIEVuaGFuY2VkIFNRTCBpbmplY3Rpb24gcHJvdGVjdGlvblxuICBjb25zdCBzcWxQYXR0ZXJucyA9IFtcbiAgICAvLyBTUUwga2V5d29yZHNcbiAgICAvKFxcYihTRUxFQ1R8SU5TRVJUfFVQREFURXxERUxFVEV8RFJPUHxDUkVBVEV8QUxURVJ8RVhFQ3xFWEVDVVRFfFVOSU9OfFRSVU5DQVRFfEdSQU5UfFJFVk9LRSlcXGIpL2dpLFxuICAgIFxuICAgIC8vIFNRTCBjb21tZW50cyBhbmQgdGVybWluYXRvcnNcbiAgICAvKC0tfFxcL1xcKnxcXCpcXC98OykvZyxcbiAgICBcbiAgICAvLyBTUUwgaW5qZWN0aW9uIHBhdHRlcm5zXG4gICAgLyhcXGIoT1J8QU5EKVxccytcXHcrXFxzKj1cXHMqXFx3KykvZ2ksXG4gICAgLyhcXGIoT1J8QU5EKVxccysxXFxzKj1cXHMqMSkvZ2ksXG4gICAgLyhcXGIoT1J8QU5EKVxccytcXHcrXFxzKihMSUtFfElOfElTKSkvZ2ksXG4gICAgXG4gICAgLy8gVW5pb24tYmFzZWQgaW5qZWN0aW9uXG4gICAgL1VOSU9OXFxzK1NFTEVDVC9naSxcbiAgICBcbiAgICAvLyBJbmZvcm1hdGlvbiBzY2hlbWEgYWNjZXNzXG4gICAgL2luZm9ybWF0aW9uX3NjaGVtYS9naSxcbiAgICBcbiAgICAvLyBTeXN0ZW0gZnVuY3Rpb25zXG4gICAgLyhMT0FEX0ZJTEV8SU5UT1xccytPVVRGSUxFfElOVE9cXHMrRFVNUEZJTEUpL2dpLFxuICAgIFxuICAgIC8vIEhleCBlbmNvZGluZyBwYXR0ZXJuc1xuICAgIC8weFswLTlhLWZdKy9naSxcbiAgXTtcbiAgXG4gIGxldCBoYWRTcWxDb250ZW50ID0gZmFsc2U7XG4gIHNxbFBhdHRlcm5zLmZvckVhY2gocGF0dGVybiA9PiB7XG4gICAgaWYgKHBhdHRlcm4udGVzdChzYW5pdGl6ZWQpKSB7XG4gICAgICBoYWRTcWxDb250ZW50ID0gdHJ1ZTtcbiAgICB9XG4gIH0pO1xuICBcbiAgaWYgKGhhZFNxbENvbnRlbnQpIHtcbiAgICBlcnJvcnMucHVzaChgJHtmaWVsZE5hbWV9IGNvbnRhaW5zIHBvdGVudGlhbGx5IGRhbmdlcm91cyBTUUwgcGF0dGVybnNgKTtcbiAgfVxuICBcbiAgLy8gUGF0aCB0cmF2ZXJzYWwgcHJvdGVjdGlvblxuICBjb25zdCBwYXRoVHJhdmVyc2FsUGF0dGVybnMgPSBbXG4gICAgL1xcLlxcLlxcLy9nLFxuICAgIC9cXC5cXC5cXFxcL2csXG4gICAgLyUyZSUyZSUyZi9naSxcbiAgICAvJTJlJTJlJTVjL2dpLFxuICAgIC9cXC5cXC4lMmYvZ2ksXG4gICAgL1xcLlxcLiU1Yy9naSxcbiAgXTtcbiAgXG4gIGxldCBoYWRQYXRoVHJhdmVyc2FsID0gZmFsc2U7XG4gIHBhdGhUcmF2ZXJzYWxQYXR0ZXJucy5mb3JFYWNoKHBhdHRlcm4gPT4ge1xuICAgIGlmIChwYXR0ZXJuLnRlc3Qoc2FuaXRpemVkKSkge1xuICAgICAgaGFkUGF0aFRyYXZlcnNhbCA9IHRydWU7XG4gICAgfVxuICB9KTtcbiAgXG4gIGlmIChoYWRQYXRoVHJhdmVyc2FsKSB7XG4gICAgZXJyb3JzLnB1c2goYCR7ZmllbGROYW1lfSBjb250YWlucyBwYXRoIHRyYXZlcnNhbCBwYXR0ZXJuc2ApO1xuICB9XG4gIFxuICAvLyBMREFQIGluamVjdGlvbiBwcm90ZWN0aW9uXG4gIGNvbnN0IGxkYXBQYXR0ZXJucyA9IFtcbiAgICAvWygpXFxcXCpcXHgwMF0vZyxcbiAgXTtcbiAgXG4gIGxldCBoYWRMZGFwQ29udGVudCA9IGZhbHNlO1xuICBsZGFwUGF0dGVybnMuZm9yRWFjaChwYXR0ZXJuID0+IHtcbiAgICBpZiAocGF0dGVybi50ZXN0KHNhbml0aXplZCkpIHtcbiAgICAgIGhhZExkYXBDb250ZW50ID0gdHJ1ZTtcbiAgICB9XG4gIH0pO1xuICBcbiAgaWYgKGhhZExkYXBDb250ZW50KSB7XG4gICAgZXJyb3JzLnB1c2goYCR7ZmllbGROYW1lfSBjb250YWlucyBMREFQIGluamVjdGlvbiBwYXR0ZXJuc2ApO1xuICB9XG4gIFxuICAvLyBDaGVjayBmb3IgZXhjZXNzaXZlIHJlcGV0aXRpb24gKHBvdGVudGlhbCBzcGFtKVxuICBjb25zdCByZXBlYXRlZFBhdHRlcm4gPSAvKC4pXFwxezIwLH0vO1xuICBpZiAocmVwZWF0ZWRQYXR0ZXJuLnRlc3Qoc2FuaXRpemVkKSkge1xuICAgIGVycm9ycy5wdXNoKGAke2ZpZWxkTmFtZX0gY29udGFpbnMgZXhjZXNzaXZlIGNoYXJhY3RlciByZXBldGl0aW9uYCk7XG4gIH1cbiAgXG4gIC8vIEZpbmFsIHNhZmV0eSBjaGVjazogZW5zdXJlIG5vIG51bGwgYnl0ZXMgb3IgZXhjZXNzaXZlIHdoaXRlc3BhY2VcbiAgc2FuaXRpemVkID0gc2FuaXRpemVkLnJlcGxhY2UoL1xcMC9nLCAnJyk7XG4gIHNhbml0aXplZCA9IHNhbml0aXplZC5yZXBsYWNlKC9cXHN7MTAsfS9nLCAnICcpOyAvLyBSZXBsYWNlIGV4Y2Vzc2l2ZSB3aGl0ZXNwYWNlXG4gIFxuICAvLyBDaGVjayBmb3IgZW5jb2RlZCBhdHRhY2tzXG4gIGNvbnN0IGVuY29kZWRQYXR0ZXJucyA9IFtcbiAgICAvJTNjL2dpLCAvLyA8XG4gICAgLyUzZS9naSwgLy8gPlxuICAgIC8lMjIvZ2ksIC8vIFwiXG4gICAgLyUyNy9naSwgLy8gJ1xuICAgIC8lMjgvZ2ksIC8vIChcbiAgICAvJTI5L2dpLCAvLyApXG4gICAgLyUzYi9naSwgLy8gO1xuICBdO1xuICBcbiAgbGV0IGhhZEVuY29kZWRBdHRhY2sgPSBmYWxzZTtcbiAgZW5jb2RlZFBhdHRlcm5zLmZvckVhY2gocGF0dGVybiA9PiB7XG4gICAgaWYgKHBhdHRlcm4udGVzdChzYW5pdGl6ZWQpKSB7XG4gICAgICBoYWRFbmNvZGVkQXR0YWNrID0gdHJ1ZTtcbiAgICB9XG4gIH0pO1xuICBcbiAgaWYgKGhhZEVuY29kZWRBdHRhY2spIHtcbiAgICBlcnJvcnMucHVzaChgJHtmaWVsZE5hbWV9IGNvbnRhaW5zIFVSTC1lbmNvZGVkIHBvdGVudGlhbGx5IGRhbmdlcm91cyBjb250ZW50YCk7XG4gIH1cbiAgXG4gIHJldHVybiB7XG4gICAgaXNWYWxpZDogZXJyb3JzLmxlbmd0aCA9PT0gMCxcbiAgICBlcnJvcnMsXG4gICAgc2FuaXRpemVkOiBlcnJvcnMubGVuZ3RoID09PSAwID8gc2FuaXRpemVkIDogdW5kZWZpbmVkLFxuICB9O1xufTtcblxuLy8gQWRkaXRpb25hbCBzYW5pdGl6YXRpb24gZm9yIEhUTUwgY29udGVudCAoaWYgbmVlZGVkKVxuZXhwb3J0IGNvbnN0IHNhbml0aXplSHRtbENvbnRlbnQgPSAoaW5wdXQ6IHN0cmluZyk6IHN0cmluZyA9PiB7XG4gIGlmICghaW5wdXQpIHJldHVybiAnJztcbiAgXG4gIC8vIEJhc2ljIEhUTUwgZW50aXR5IGVuY29kaW5nIGZvciBkYW5nZXJvdXMgY2hhcmFjdGVyc1xuICBjb25zdCBodG1sRW50aXRpZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gICAgJyYnOiAnJmFtcDsnLFxuICAgICc8JzogJyZsdDsnLFxuICAgICc+JzogJyZndDsnLFxuICAgICdcIic6ICcmcXVvdDsnLFxuICAgIFwiJ1wiOiAnJiN4Mjc7JyxcbiAgICAnLyc6ICcmI3gyRjsnLFxuICB9O1xuICBcbiAgcmV0dXJuIGlucHV0LnJlcGxhY2UoL1smPD5cIicvXS9nLCAoY2hhcikgPT4gaHRtbEVudGl0aWVzW2NoYXJdIHx8IGNoYXIpO1xufTtcblxuLy8gU2Vzc2lvbiBJRCB2YWxpZGF0aW9uXG5leHBvcnQgY29uc3QgdmFsaWRhdGVTZXNzaW9uSWQgPSAoc2Vzc2lvbklkOiBzdHJpbmcpOiBWYWxpZGF0aW9uUmVzdWx0ID0+IHtcbiAgY29uc3QgZXJyb3JzOiBzdHJpbmdbXSA9IFtdO1xuICBcbiAgaWYgKCFzZXNzaW9uSWQgfHwgdHlwZW9mIHNlc3Npb25JZCAhPT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4geyBpc1ZhbGlkOiBmYWxzZSwgZXJyb3JzOiBbJ1Nlc3Npb24gSUQgaXMgcmVxdWlyZWQnXSB9O1xuICB9XG4gIFxuICAvLyBDaGVjayBmb3JtYXQgKFVVSUQgdjQgZm9ybWF0KVxuICBjb25zdCB1dWlkUGF0dGVybiA9IC9eWzAtOWEtZl17OH0tWzAtOWEtZl17NH0tNFswLTlhLWZdezN9LVs4OWFiXVswLTlhLWZdezN9LVswLTlhLWZdezEyfSQvaTtcbiAgaWYgKCF1dWlkUGF0dGVybi50ZXN0KHNlc3Npb25JZCkpIHtcbiAgICBlcnJvcnMucHVzaCgnSW52YWxpZCBzZXNzaW9uIElEIGZvcm1hdCcpO1xuICB9XG4gIFxuICByZXR1cm4ge1xuICAgIGlzVmFsaWQ6IGVycm9ycy5sZW5ndGggPT09IDAsXG4gICAgZXJyb3JzLFxuICAgIHNhbml0aXplZDogc2Vzc2lvbklkLFxuICB9O1xufTtcblxuLy8gTGFuZ3VhZ2UgdmFsaWRhdGlvblxuZXhwb3J0IGNvbnN0IHZhbGlkYXRlTGFuZ3VhZ2UgPSAobGFuZ3VhZ2U6IHN0cmluZyk6IFZhbGlkYXRpb25SZXN1bHQgPT4ge1xuICBjb25zdCBzdXBwb3J0ZWRMYW5ndWFnZXMgPSBbJ2phJywgJ2VuJywgJ3poJywgJ2tvJ107XG4gIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXTtcbiAgXG4gIGlmICghbGFuZ3VhZ2UgfHwgdHlwZW9mIGxhbmd1YWdlICE9PSAnc3RyaW5nJykge1xuICAgIHJldHVybiB7IGlzVmFsaWQ6IGZhbHNlLCBlcnJvcnM6IFsnTGFuZ3VhZ2UgaXMgcmVxdWlyZWQnXSB9O1xuICB9XG4gIFxuICBjb25zdCBzYW5pdGl6ZWQgPSBsYW5ndWFnZS50b0xvd2VyQ2FzZSgpLnRyaW0oKTtcbiAgXG4gIGlmICghc3VwcG9ydGVkTGFuZ3VhZ2VzLmluY2x1ZGVzKHNhbml0aXplZCkpIHtcbiAgICBlcnJvcnMucHVzaChgVW5zdXBwb3J0ZWQgbGFuZ3VhZ2U6ICR7bGFuZ3VhZ2V9LiBTdXBwb3J0ZWQgbGFuZ3VhZ2VzOiAke3N1cHBvcnRlZExhbmd1YWdlcy5qb2luKCcsICcpfWApO1xuICB9XG4gIFxuICByZXR1cm4ge1xuICAgIGlzVmFsaWQ6IGVycm9ycy5sZW5ndGggPT09IDAsXG4gICAgZXJyb3JzLFxuICAgIHNhbml0aXplZDogZXJyb3JzLmxlbmd0aCA9PT0gMCA/IHNhbml0aXplZCA6IHVuZGVmaW5lZCxcbiAgfTtcbn07XG5cbi8vIEF1ZGlvIGZpbGUgdmFsaWRhdGlvblxuZXhwb3J0IGNvbnN0IHZhbGlkYXRlQXVkaW9GaWxlID0gKGZpbGU6IHsgc2l6ZTogbnVtYmVyOyB0eXBlOiBzdHJpbmc7IGRhdGE6IHN0cmluZyB9KTogVmFsaWRhdGlvblJlc3VsdCA9PiB7XG4gIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXTtcbiAgXG4gIC8vIENoZWNrIGZpbGUgc2l6ZVxuICBpZiAoZmlsZS5zaXplID4gc2VjdXJpdHlDb25maWcudmFsaWRhdGlvbi5tYXhGaWxlU2l6ZSkge1xuICAgIGVycm9ycy5wdXNoKGBGaWxlIHNpemUgZXhjZWVkcyBtYXhpbXVtIGxpbWl0IG9mICR7c2VjdXJpdHlDb25maWcudmFsaWRhdGlvbi5tYXhGaWxlU2l6ZSAvIDEwMjQgLyAxMDI0fU1CYCk7XG4gIH1cbiAgXG4gIC8vIENoZWNrIE1JTUUgdHlwZVxuICBpZiAoIXNlY3VyaXR5Q29uZmlnLnZhbGlkYXRpb24uYWxsb3dlZEF1ZGlvVHlwZXMuaW5jbHVkZXMoZmlsZS50eXBlKSkge1xuICAgIGVycm9ycy5wdXNoKGBVbnN1cHBvcnRlZCBhdWRpbyBmb3JtYXQ6ICR7ZmlsZS50eXBlfS4gQWxsb3dlZCBmb3JtYXRzOiAke3NlY3VyaXR5Q29uZmlnLnZhbGlkYXRpb24uYWxsb3dlZEF1ZGlvVHlwZXMuam9pbignLCAnKX1gKTtcbiAgfVxuICBcbiAgLy8gVmFsaWRhdGUgYmFzZTY0IGRhdGFcbiAgdHJ5IHtcbiAgICBjb25zdCBiYXNlNjRQYXR0ZXJuID0gL15bQS1aYS16MC05Ky9dKj17MCwyfSQvO1xuICAgIGlmICghYmFzZTY0UGF0dGVybi50ZXN0KGZpbGUuZGF0YSkpIHtcbiAgICAgIGVycm9ycy5wdXNoKCdJbnZhbGlkIGF1ZGlvIGRhdGEgZm9ybWF0Jyk7XG4gICAgfVxuICB9IGNhdGNoIHtcbiAgICBlcnJvcnMucHVzaCgnSW52YWxpZCBhdWRpbyBkYXRhJyk7XG4gIH1cbiAgXG4gIHJldHVybiB7XG4gICAgaXNWYWxpZDogZXJyb3JzLmxlbmd0aCA9PT0gMCxcbiAgICBlcnJvcnMsXG4gIH07XG59O1xuXG4vLyBSZXF1ZXN0IGJvZHkgdmFsaWRhdGlvbiBmb3IgY2hhdCBlbmRwb2ludFxuZXhwb3J0IGNvbnN0IHZhbGlkYXRlQ2hhdFJlcXVlc3QgPSAoYm9keTogYW55KTogQ2hhdFJlcXVlc3RWYWxpZGF0aW9uUmVzdWx0ID0+IHtcbiAgY29uc3QgZXJyb3JzOiBzdHJpbmdbXSA9IFtdO1xuICBcbiAgaWYgKCFib2R5IHx8IHR5cGVvZiBib2R5ICE9PSAnb2JqZWN0Jykge1xuICAgIHJldHVybiB7IGlzVmFsaWQ6IGZhbHNlLCBlcnJvcnM6IFsnUmVxdWVzdCBib2R5IGlzIHJlcXVpcmVkJ10gfTtcbiAgfVxuICBcbiAgLy8gVmFsaWRhdGUgbWVzc2FnZVxuICBjb25zdCBtZXNzYWdlVmFsaWRhdGlvbiA9IHZhbGlkYXRlQW5kU2FuaXRpemVUZXh0KGJvZHkubWVzc2FnZSwgJ21lc3NhZ2UnKTtcbiAgaWYgKCFtZXNzYWdlVmFsaWRhdGlvbi5pc1ZhbGlkKSB7XG4gICAgZXJyb3JzLnB1c2goLi4ubWVzc2FnZVZhbGlkYXRpb24uZXJyb3JzKTtcbiAgfVxuICBcbiAgLy8gVmFsaWRhdGUgc2Vzc2lvbiBJRFxuICBjb25zdCBzZXNzaW9uVmFsaWRhdGlvbiA9IHZhbGlkYXRlU2Vzc2lvbklkKGJvZHkuc2Vzc2lvbklkKTtcbiAgaWYgKCFzZXNzaW9uVmFsaWRhdGlvbi5pc1ZhbGlkKSB7XG4gICAgZXJyb3JzLnB1c2goLi4uc2Vzc2lvblZhbGlkYXRpb24uZXJyb3JzKTtcbiAgfVxuICBcbiAgLy8gVmFsaWRhdGUgbGFuZ3VhZ2UgKG9wdGlvbmFsKVxuICBsZXQgbGFuZ3VhZ2VWYWxpZGF0aW9uO1xuICBpZiAoYm9keS5sYW5ndWFnZSkge1xuICAgIGxhbmd1YWdlVmFsaWRhdGlvbiA9IHZhbGlkYXRlTGFuZ3VhZ2UoYm9keS5sYW5ndWFnZSk7XG4gICAgaWYgKCFsYW5ndWFnZVZhbGlkYXRpb24uaXNWYWxpZCkge1xuICAgICAgZXJyb3JzLnB1c2goLi4ubGFuZ3VhZ2VWYWxpZGF0aW9uLmVycm9ycyk7XG4gICAgfVxuICB9XG4gIFxuICAvLyBWYWxpZGF0ZSBib29sZWFuIGZpZWxkc1xuICBpZiAoYm9keS51c2VWb2ljZSAhPT0gdW5kZWZpbmVkICYmIHR5cGVvZiBib2R5LnVzZVZvaWNlICE9PSAnYm9vbGVhbicpIHtcbiAgICBlcnJvcnMucHVzaCgndXNlVm9pY2UgbXVzdCBiZSBhIGJvb2xlYW4nKTtcbiAgfVxuICBcbiAgLy8gVmFsaWRhdGUgaW5wdXRUeXBlIChvcHRpb25hbClcbiAgaWYgKGJvZHkuaW5wdXRUeXBlICE9PSB1bmRlZmluZWQgJiYgIVsndGV4dCcsICd2b2ljZSddLmluY2x1ZGVzKGJvZHkuaW5wdXRUeXBlKSkge1xuICAgIGVycm9ycy5wdXNoKCdpbnB1dFR5cGUgbXVzdCBiZSBlaXRoZXIgXCJ0ZXh0XCIgb3IgXCJ2b2ljZVwiJyk7XG4gIH1cbiAgXG4gIC8vIFZhbGlkYXRlIGxvY2F0aW9uIChvcHRpb25hbClcbiAgbGV0IGxvY2F0aW9uVmFsaWRhdGlvbjtcbiAgaWYgKGJvZHkubG9jYXRpb24pIHtcbiAgICBsb2NhdGlvblZhbGlkYXRpb24gPSB2YWxpZGF0ZUxvY2F0aW9uKGJvZHkubG9jYXRpb24pO1xuICAgIGlmICghbG9jYXRpb25WYWxpZGF0aW9uLmlzVmFsaWQpIHtcbiAgICAgIGVycm9ycy5wdXNoKC4uLmxvY2F0aW9uVmFsaWRhdGlvbi5lcnJvcnMpO1xuICAgIH1cbiAgfVxuICBcbiAgLy8gVmFsaWRhdGUgcmVxdWVzdGVkU2NvcGUgKG9wdGlvbmFsKVxuICBsZXQgc2NvcGVWYWxpZGF0aW9uO1xuICBpZiAoYm9keS5yZXF1ZXN0ZWRTY29wZSkge1xuICAgIHNjb3BlVmFsaWRhdGlvbiA9IHZhbGlkYXRlUmVxdWVzdGVkU2NvcGUoYm9keS5yZXF1ZXN0ZWRTY29wZSk7XG4gICAgaWYgKCFzY29wZVZhbGlkYXRpb24uaXNWYWxpZCkge1xuICAgICAgZXJyb3JzLnB1c2goLi4uc2NvcGVWYWxpZGF0aW9uLmVycm9ycyk7XG4gICAgfVxuICB9XG4gIFxuICByZXR1cm4ge1xuICAgIGlzVmFsaWQ6IGVycm9ycy5sZW5ndGggPT09IDAsXG4gICAgZXJyb3JzLFxuICAgIHNhbml0aXplZDogZXJyb3JzLmxlbmd0aCA9PT0gMCAmJiBtZXNzYWdlVmFsaWRhdGlvbi5zYW5pdGl6ZWQgJiYgc2Vzc2lvblZhbGlkYXRpb24uc2FuaXRpemVkID8ge1xuICAgICAgbWVzc2FnZTogbWVzc2FnZVZhbGlkYXRpb24uc2FuaXRpemVkLFxuICAgICAgc2Vzc2lvbklkOiBzZXNzaW9uVmFsaWRhdGlvbi5zYW5pdGl6ZWQsXG4gICAgICBsYW5ndWFnZTogYm9keS5sYW5ndWFnZSA/IChsYW5ndWFnZVZhbGlkYXRpb24/LnNhbml0aXplZCB8fCAnamEnKSA6ICdqYScsXG4gICAgICB1c2VWb2ljZTogQm9vbGVhbihib2R5LnVzZVZvaWNlKSxcbiAgICAgIGlucHV0VHlwZTogKGJvZHkuaW5wdXRUeXBlIGFzICd0ZXh0JyB8ICd2b2ljZScpIHx8ICd0ZXh0JyxcbiAgICAgIGxvY2F0aW9uOiBsb2NhdGlvblZhbGlkYXRpb24/LnNhbml0aXplZCBhcyB7XG4gICAgICAgIGxhdGl0dWRlOiBudW1iZXI7XG4gICAgICAgIGxvbmdpdHVkZTogbnVtYmVyO1xuICAgICAgICBhY2N1cmFjeT86IG51bWJlcjtcbiAgICAgICAgdGltZXN0YW1wPzogRGF0ZTtcbiAgICAgIH0gfCB1bmRlZmluZWQsXG4gICAgICByZXF1ZXN0ZWRTY29wZTogc2NvcGVWYWxpZGF0aW9uPy5zYW5pdGl6ZWQgYXMge1xuICAgICAgICB0aW1lUmFuZ2U/OiAndG9kYXknIHwgJ3RoaXNfd2VlaycgfCAndGhpc19tb250aCcgfCAnbmV4dF9tb250aCcgfCAnYW55JztcbiAgICAgICAgbG9jYXRpb25SYW5nZT86ICduZWFyYnknIHwgJ3dhbGtpbmdfZGlzdGFuY2UnIHwgJ2N5Y2xpbmdfZGlzdGFuY2UnIHwgJ2NpdHlfd2lkZScgfCAnYW55JztcbiAgICAgIH0gfCB1bmRlZmluZWQsXG4gICAgfSA6IHVuZGVmaW5lZCxcbiAgfTtcbn07XG5cbi8vIFJhdGUgbGltaXRpbmcgY2hlY2sgKHNpbXBsZSBpbi1tZW1vcnkgaW1wbGVtZW50YXRpb24pXG5jb25zdCByYXRlTGltaXRTdG9yZSA9IG5ldyBNYXA8c3RyaW5nLCB7IGNvdW50OiBudW1iZXI7IHJlc2V0VGltZTogbnVtYmVyIH0+KCk7XG5cbmV4cG9ydCBjb25zdCBjaGVja1JhdGVMaW1pdCA9IChpZGVudGlmaWVyOiBzdHJpbmcpOiB7IGFsbG93ZWQ6IGJvb2xlYW47IHJldHJ5QWZ0ZXI/OiBudW1iZXIgfSA9PiB7XG4gIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gIGNvbnN0IHdpbmRvd01zID0gc2VjdXJpdHlDb25maWcucmF0ZUxpbWl0aW5nLndpbmRvd01zO1xuICBjb25zdCBtYXhSZXF1ZXN0cyA9IHNlY3VyaXR5Q29uZmlnLnJhdGVMaW1pdGluZy5tYXhSZXF1ZXN0cztcbiAgXG4gIGNvbnN0IGN1cnJlbnQgPSByYXRlTGltaXRTdG9yZS5nZXQoaWRlbnRpZmllcik7XG4gIFxuICBpZiAoIWN1cnJlbnQgfHwgbm93ID4gY3VycmVudC5yZXNldFRpbWUpIHtcbiAgICAvLyBGaXJzdCByZXF1ZXN0IG9yIHdpbmRvdyBleHBpcmVkXG4gICAgcmF0ZUxpbWl0U3RvcmUuc2V0KGlkZW50aWZpZXIsIHtcbiAgICAgIGNvdW50OiAxLFxuICAgICAgcmVzZXRUaW1lOiBub3cgKyB3aW5kb3dNcyxcbiAgICB9KTtcbiAgICByZXR1cm4geyBhbGxvd2VkOiB0cnVlIH07XG4gIH1cbiAgXG4gIGlmIChjdXJyZW50LmNvdW50ID49IG1heFJlcXVlc3RzKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGFsbG93ZWQ6IGZhbHNlLFxuICAgICAgcmV0cnlBZnRlcjogTWF0aC5jZWlsKChjdXJyZW50LnJlc2V0VGltZSAtIG5vdykgLyAxMDAwKSxcbiAgICB9O1xuICB9XG4gIFxuICAvLyBJbmNyZW1lbnQgY291bnRlclxuICBjdXJyZW50LmNvdW50Kys7XG4gIHJhdGVMaW1pdFN0b3JlLnNldChpZGVudGlmaWVyLCBjdXJyZW50KTtcbiAgXG4gIHJldHVybiB7IGFsbG93ZWQ6IHRydWUgfTtcbn07XG5cbi8vIExvY2F0aW9uIHZhbGlkYXRpb25cbmV4cG9ydCBjb25zdCB2YWxpZGF0ZUxvY2F0aW9uID0gKGxvY2F0aW9uOiBhbnkpOiBWYWxpZGF0aW9uUmVzdWx0ID0+IHtcbiAgY29uc3QgZXJyb3JzOiBzdHJpbmdbXSA9IFtdO1xuICBcbiAgaWYgKCFsb2NhdGlvbiB8fCB0eXBlb2YgbG9jYXRpb24gIT09ICdvYmplY3QnKSB7XG4gICAgcmV0dXJuIHsgaXNWYWxpZDogZmFsc2UsIGVycm9yczogWydMb2NhdGlvbiBtdXN0IGJlIGFuIG9iamVjdCddIH07XG4gIH1cbiAgXG4gIC8vIFZhbGlkYXRlIGxhdGl0dWRlXG4gIGlmICh0eXBlb2YgbG9jYXRpb24ubGF0aXR1ZGUgIT09ICdudW1iZXInKSB7XG4gICAgZXJyb3JzLnB1c2goJ0xhdGl0dWRlIG11c3QgYmUgYSBudW1iZXInKTtcbiAgfSBlbHNlIGlmIChsb2NhdGlvbi5sYXRpdHVkZSA8IC05MCB8fCBsb2NhdGlvbi5sYXRpdHVkZSA+IDkwKSB7XG4gICAgZXJyb3JzLnB1c2goJ0xhdGl0dWRlIG11c3QgYmUgYmV0d2VlbiAtOTAgYW5kIDkwIGRlZ3JlZXMnKTtcbiAgfVxuICBcbiAgLy8gVmFsaWRhdGUgbG9uZ2l0dWRlXG4gIGlmICh0eXBlb2YgbG9jYXRpb24ubG9uZ2l0dWRlICE9PSAnbnVtYmVyJykge1xuICAgIGVycm9ycy5wdXNoKCdMb25naXR1ZGUgbXVzdCBiZSBhIG51bWJlcicpO1xuICB9IGVsc2UgaWYgKGxvY2F0aW9uLmxvbmdpdHVkZSA8IC0xODAgfHwgbG9jYXRpb24ubG9uZ2l0dWRlID4gMTgwKSB7XG4gICAgZXJyb3JzLnB1c2goJ0xvbmdpdHVkZSBtdXN0IGJlIGJldHdlZW4gLTE4MCBhbmQgMTgwIGRlZ3JlZXMnKTtcbiAgfVxuICBcbiAgLy8gVmFsaWRhdGUgYWNjdXJhY3kgKG9wdGlvbmFsKVxuICBpZiAobG9jYXRpb24uYWNjdXJhY3kgIT09IHVuZGVmaW5lZCAmJiAodHlwZW9mIGxvY2F0aW9uLmFjY3VyYWN5ICE9PSAnbnVtYmVyJyB8fCBsb2NhdGlvbi5hY2N1cmFjeSA8IDApKSB7XG4gICAgZXJyb3JzLnB1c2goJ0FjY3VyYWN5IG11c3QgYmUgYSBwb3NpdGl2ZSBudW1iZXInKTtcbiAgfVxuICBcbiAgLy8gVmFsaWRhdGUgdGltZXN0YW1wIChvcHRpb25hbClcbiAgaWYgKGxvY2F0aW9uLnRpbWVzdGFtcCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgdHJ5IHtcbiAgICAgIG5ldyBEYXRlKGxvY2F0aW9uLnRpbWVzdGFtcCk7XG4gICAgfSBjYXRjaCB7XG4gICAgICBlcnJvcnMucHVzaCgnSW52YWxpZCB0aW1lc3RhbXAgZm9ybWF0Jyk7XG4gICAgfVxuICB9XG4gIFxuICByZXR1cm4ge1xuICAgIGlzVmFsaWQ6IGVycm9ycy5sZW5ndGggPT09IDAsXG4gICAgZXJyb3JzLFxuICAgIHNhbml0aXplZDogZXJyb3JzLmxlbmd0aCA9PT0gMCA/IHtcbiAgICAgIGxhdGl0dWRlOiBsb2NhdGlvbi5sYXRpdHVkZSxcbiAgICAgIGxvbmdpdHVkZTogbG9jYXRpb24ubG9uZ2l0dWRlLFxuICAgICAgYWNjdXJhY3k6IGxvY2F0aW9uLmFjY3VyYWN5LFxuICAgICAgdGltZXN0YW1wOiBsb2NhdGlvbi50aW1lc3RhbXAgPyBuZXcgRGF0ZShsb2NhdGlvbi50aW1lc3RhbXApIDogdW5kZWZpbmVkXG4gICAgfSA6IHVuZGVmaW5lZCxcbiAgfTtcbn07XG5cbi8vIFJlcXVlc3RlZCBzY29wZSB2YWxpZGF0aW9uXG5leHBvcnQgY29uc3QgdmFsaWRhdGVSZXF1ZXN0ZWRTY29wZSA9IChzY29wZTogYW55KTogVmFsaWRhdGlvblJlc3VsdCA9PiB7XG4gIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXTtcbiAgXG4gIGlmICghc2NvcGUgfHwgdHlwZW9mIHNjb3BlICE9PSAnb2JqZWN0Jykge1xuICAgIHJldHVybiB7IGlzVmFsaWQ6IHRydWUsIGVycm9yczogW10gfTsgLy8gT3B0aW9uYWwgZmllbGRcbiAgfVxuICBcbiAgY29uc3QgdmFsaWRUaW1lUmFuZ2VzID0gWyd0b2RheScsICd0aGlzX3dlZWsnLCAndGhpc19tb250aCcsICduZXh0X21vbnRoJywgJ2FueSddO1xuICBjb25zdCB2YWxpZExvY2F0aW9uUmFuZ2VzID0gWyduZWFyYnknLCAnd2Fsa2luZ19kaXN0YW5jZScsICdjeWNsaW5nX2Rpc3RhbmNlJywgJ2NpdHlfd2lkZScsICdhbnknXTtcbiAgXG4gIC8vIFZhbGlkYXRlIHRpbWVSYW5nZSAob3B0aW9uYWwpXG4gIGlmIChzY29wZS50aW1lUmFuZ2UgIT09IHVuZGVmaW5lZCAmJiAhdmFsaWRUaW1lUmFuZ2VzLmluY2x1ZGVzKHNjb3BlLnRpbWVSYW5nZSkpIHtcbiAgICBlcnJvcnMucHVzaChgSW52YWxpZCB0aW1lUmFuZ2UuIE11c3QgYmUgb25lIG9mOiAke3ZhbGlkVGltZVJhbmdlcy5qb2luKCcsICcpfWApO1xuICB9XG4gIFxuICAvLyBWYWxpZGF0ZSBsb2NhdGlvblJhbmdlIChvcHRpb25hbClcbiAgaWYgKHNjb3BlLmxvY2F0aW9uUmFuZ2UgIT09IHVuZGVmaW5lZCAmJiAhdmFsaWRMb2NhdGlvblJhbmdlcy5pbmNsdWRlcyhzY29wZS5sb2NhdGlvblJhbmdlKSkge1xuICAgIGVycm9ycy5wdXNoKGBJbnZhbGlkIGxvY2F0aW9uUmFuZ2UuIE11c3QgYmUgb25lIG9mOiAke3ZhbGlkTG9jYXRpb25SYW5nZXMuam9pbignLCAnKX1gKTtcbiAgfVxuICBcbiAgcmV0dXJuIHtcbiAgICBpc1ZhbGlkOiBlcnJvcnMubGVuZ3RoID09PSAwLFxuICAgIGVycm9ycyxcbiAgICBzYW5pdGl6ZWQ6IGVycm9ycy5sZW5ndGggPT09IDAgPyB7XG4gICAgICB0aW1lUmFuZ2U6IHNjb3BlLnRpbWVSYW5nZSxcbiAgICAgIGxvY2F0aW9uUmFuZ2U6IHNjb3BlLmxvY2F0aW9uUmFuZ2VcbiAgICB9IDogdW5kZWZpbmVkLFxuICB9O1xufTtcblxuLy8gQ2xlYW51cCBleHBpcmVkIHJhdGUgbGltaXQgZW50cmllcyAoc2hvdWxkIGJlIGNhbGxlZCBwZXJpb2RpY2FsbHkpXG5leHBvcnQgY29uc3QgY2xlYW51cFJhdGVMaW1pdCA9ICgpOiB2b2lkID0+IHtcbiAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgcmF0ZUxpbWl0U3RvcmUuZW50cmllcygpKSB7XG4gICAgaWYgKG5vdyA+IHZhbHVlLnJlc2V0VGltZSkge1xuICAgICAgcmF0ZUxpbWl0U3RvcmUuZGVsZXRlKGtleSk7XG4gICAgfVxuICB9XG59OyJdLCJuYW1lcyI6WyJzZWN1cml0eUNvbmZpZyIsInZhbGlkYXRlQW5kU2FuaXRpemVUZXh0IiwiaW5wdXQiLCJmaWVsZE5hbWUiLCJlcnJvcnMiLCJpc1ZhbGlkIiwic2FuaXRpemVkIiwidHJpbSIsImxlbmd0aCIsInB1c2giLCJ2YWxpZGF0aW9uIiwibWF4TWVzc2FnZUxlbmd0aCIsInJlcGxhY2UiLCJ4c3NQYXR0ZXJucyIsImhhZFhzc0NvbnRlbnQiLCJmb3JFYWNoIiwicGF0dGVybiIsInRlc3QiLCJzcWxQYXR0ZXJucyIsImhhZFNxbENvbnRlbnQiLCJwYXRoVHJhdmVyc2FsUGF0dGVybnMiLCJoYWRQYXRoVHJhdmVyc2FsIiwibGRhcFBhdHRlcm5zIiwiaGFkTGRhcENvbnRlbnQiLCJyZXBlYXRlZFBhdHRlcm4iLCJlbmNvZGVkUGF0dGVybnMiLCJoYWRFbmNvZGVkQXR0YWNrIiwidW5kZWZpbmVkIiwic2FuaXRpemVIdG1sQ29udGVudCIsImh0bWxFbnRpdGllcyIsImNoYXIiLCJ2YWxpZGF0ZVNlc3Npb25JZCIsInNlc3Npb25JZCIsInV1aWRQYXR0ZXJuIiwidmFsaWRhdGVMYW5ndWFnZSIsImxhbmd1YWdlIiwic3VwcG9ydGVkTGFuZ3VhZ2VzIiwidG9Mb3dlckNhc2UiLCJpbmNsdWRlcyIsImpvaW4iLCJ2YWxpZGF0ZUF1ZGlvRmlsZSIsImZpbGUiLCJzaXplIiwibWF4RmlsZVNpemUiLCJhbGxvd2VkQXVkaW9UeXBlcyIsInR5cGUiLCJiYXNlNjRQYXR0ZXJuIiwiZGF0YSIsInZhbGlkYXRlQ2hhdFJlcXVlc3QiLCJib2R5IiwibWVzc2FnZVZhbGlkYXRpb24iLCJtZXNzYWdlIiwic2Vzc2lvblZhbGlkYXRpb24iLCJsYW5ndWFnZVZhbGlkYXRpb24iLCJ1c2VWb2ljZSIsImlucHV0VHlwZSIsImxvY2F0aW9uVmFsaWRhdGlvbiIsImxvY2F0aW9uIiwidmFsaWRhdGVMb2NhdGlvbiIsInNjb3BlVmFsaWRhdGlvbiIsInJlcXVlc3RlZFNjb3BlIiwidmFsaWRhdGVSZXF1ZXN0ZWRTY29wZSIsIkJvb2xlYW4iLCJyYXRlTGltaXRTdG9yZSIsIk1hcCIsImNoZWNrUmF0ZUxpbWl0IiwiaWRlbnRpZmllciIsIm5vdyIsIkRhdGUiLCJ3aW5kb3dNcyIsInJhdGVMaW1pdGluZyIsIm1heFJlcXVlc3RzIiwiY3VycmVudCIsImdldCIsInJlc2V0VGltZSIsInNldCIsImNvdW50IiwiYWxsb3dlZCIsInJldHJ5QWZ0ZXIiLCJNYXRoIiwiY2VpbCIsImxhdGl0dWRlIiwibG9uZ2l0dWRlIiwiYWNjdXJhY3kiLCJ0aW1lc3RhbXAiLCJzY29wZSIsInZhbGlkVGltZVJhbmdlcyIsInZhbGlkTG9jYXRpb25SYW5nZXMiLCJ0aW1lUmFuZ2UiLCJsb2NhdGlvblJhbmdlIiwiY2xlYW51cFJhdGVMaW1pdCIsImtleSIsInZhbHVlIiwiZW50cmllcyIsImRlbGV0ZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/validation.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/uuid","vendor-chunks/@redis","vendor-chunks/generic-pool","vendor-chunks/yallist","vendor-chunks/cluster-key-slot","vendor-chunks/redis"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsession%2Froute&page=%2Fapi%2Fsession%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsession%2Froute.ts&appDir=%2FUsers%2Fnegishi%2FDocuments%2Fdevelop%2FHackathon%2FTokyoOpenDataHackathon%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fnegishi%2FDocuments%2Fdevelop%2FHackathon%2FTokyoOpenDataHackathon&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();